/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmory imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmory exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		Object.defineProperty(exports, name, {
/******/ 			configurable: false,
/******/ 			enumerable: true,
/******/ 			get: getter
/******/ 		});
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 3);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_laravel_echo__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_laravel_echo___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_laravel_echo__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_pusher_js__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_pusher_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_pusher_js__);\n\r\n//window._ = require('lodash');\r\n\r\n/**\r\n * We'll load jQuery and the Bootstrap jQuery plugin which provides support\r\n * for JavaScript based Bootstrap features such as modals and tabs. This\r\n * code may be modified to fit the specific needs of your application.\r\n */\r\n\r\n//window.$ = window.jQuery = require('jquery');\r\n//require('bootstrap-sass');\r\n\r\n/**\r\n * Vue is a modern JavaScript library for building interactive web interfaces\r\n * using reactive data binding and reusable components. Vue's API is clean\r\n * and simple, leaving you to focus on building your next great project.\r\n */\r\n\r\n//window.Vue = require('vue');\r\n//require('vue-resource');\r\n\r\n/**\r\n * We'll register a HTTP interceptor to attach the \"CSRF\" header to each of\r\n * the outgoing requests issued by this application. The CSRF middleware\r\n * included with Laravel will automatically verify the header's value.\r\n */\r\n\r\n//Vue.http.interceptors.push((request, next) => {\r\n//    request.headers['X-CSRF-TOKEN'] = Laravel.csrfToken;\r\n//\r\n//    next();\r\n//});\r\n\r\n/**\r\n * Echo exposes an expressive API for subscribing to channels and listening\r\n * for events that are broadcast by Laravel. Echo and event broadcasting\r\n * allows your team to easily build robust real-time web applications.\r\n */\r\n\r\n\r\n\r\n\r\n\r\nvar user = JSON.parse(localStorage.getItem('user'));\r\nvar token = localStorage.getItem('satellizer_token');\r\nconsole.log(token);\r\nwindow.Echo = new __WEBPACK_IMPORTED_MODULE_0_laravel_echo___default.a({\r\n    broadcaster: 'pusher',\r\n    key: 'd1e5009554a0bcd357a4',\r\n    cluster: 'eu',\r\n    encrypted: true,\r\n//    host: window.location.hostname,\r\n    auth:\r\n            {\r\n                headers:\r\n                        {\r\n                            'Authorization': 'Bearer ' + token\r\n                        }\r\n            }\r\n});\r\n\r\nwindow.Echo.private('users.' + user.id + '.bookmarks')\r\n        .listen('.App.Events.Bookmarks.Stored', function (e) {\r\n            console.log('hi');\r\n            console.log(e);\r\n        });\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2Jvb3RzdHJhcC5qcz81ZTYzIl0sInNvdXJjZXNDb250ZW50IjpbIlxyXG4vL3dpbmRvdy5fID0gcmVxdWlyZSgnbG9kYXNoJyk7XHJcblxyXG4vKipcclxuICogV2UnbGwgbG9hZCBqUXVlcnkgYW5kIHRoZSBCb290c3RyYXAgalF1ZXJ5IHBsdWdpbiB3aGljaCBwcm92aWRlcyBzdXBwb3J0XHJcbiAqIGZvciBKYXZhU2NyaXB0IGJhc2VkIEJvb3RzdHJhcCBmZWF0dXJlcyBzdWNoIGFzIG1vZGFscyBhbmQgdGFicy4gVGhpc1xyXG4gKiBjb2RlIG1heSBiZSBtb2RpZmllZCB0byBmaXQgdGhlIHNwZWNpZmljIG5lZWRzIG9mIHlvdXIgYXBwbGljYXRpb24uXHJcbiAqL1xyXG5cclxuLy93aW5kb3cuJCA9IHdpbmRvdy5qUXVlcnkgPSByZXF1aXJlKCdqcXVlcnknKTtcclxuLy9yZXF1aXJlKCdib290c3RyYXAtc2FzcycpO1xyXG5cclxuLyoqXHJcbiAqIFZ1ZSBpcyBhIG1vZGVybiBKYXZhU2NyaXB0IGxpYnJhcnkgZm9yIGJ1aWxkaW5nIGludGVyYWN0aXZlIHdlYiBpbnRlcmZhY2VzXHJcbiAqIHVzaW5nIHJlYWN0aXZlIGRhdGEgYmluZGluZyBhbmQgcmV1c2FibGUgY29tcG9uZW50cy4gVnVlJ3MgQVBJIGlzIGNsZWFuXHJcbiAqIGFuZCBzaW1wbGUsIGxlYXZpbmcgeW91IHRvIGZvY3VzIG9uIGJ1aWxkaW5nIHlvdXIgbmV4dCBncmVhdCBwcm9qZWN0LlxyXG4gKi9cclxuXHJcbi8vd2luZG93LlZ1ZSA9IHJlcXVpcmUoJ3Z1ZScpO1xyXG4vL3JlcXVpcmUoJ3Z1ZS1yZXNvdXJjZScpO1xyXG5cclxuLyoqXHJcbiAqIFdlJ2xsIHJlZ2lzdGVyIGEgSFRUUCBpbnRlcmNlcHRvciB0byBhdHRhY2ggdGhlIFwiQ1NSRlwiIGhlYWRlciB0byBlYWNoIG9mXHJcbiAqIHRoZSBvdXRnb2luZyByZXF1ZXN0cyBpc3N1ZWQgYnkgdGhpcyBhcHBsaWNhdGlvbi4gVGhlIENTUkYgbWlkZGxld2FyZVxyXG4gKiBpbmNsdWRlZCB3aXRoIExhcmF2ZWwgd2lsbCBhdXRvbWF0aWNhbGx5IHZlcmlmeSB0aGUgaGVhZGVyJ3MgdmFsdWUuXHJcbiAqL1xyXG5cclxuLy9WdWUuaHR0cC5pbnRlcmNlcHRvcnMucHVzaCgocmVxdWVzdCwgbmV4dCkgPT4ge1xyXG4vLyAgICByZXF1ZXN0LmhlYWRlcnNbJ1gtQ1NSRi1UT0tFTiddID0gTGFyYXZlbC5jc3JmVG9rZW47XHJcbi8vXHJcbi8vICAgIG5leHQoKTtcclxuLy99KTtcclxuXHJcbi8qKlxyXG4gKiBFY2hvIGV4cG9zZXMgYW4gZXhwcmVzc2l2ZSBBUEkgZm9yIHN1YnNjcmliaW5nIHRvIGNoYW5uZWxzIGFuZCBsaXN0ZW5pbmdcclxuICogZm9yIGV2ZW50cyB0aGF0IGFyZSBicm9hZGNhc3QgYnkgTGFyYXZlbC4gRWNobyBhbmQgZXZlbnQgYnJvYWRjYXN0aW5nXHJcbiAqIGFsbG93cyB5b3VyIHRlYW0gdG8gZWFzaWx5IGJ1aWxkIHJvYnVzdCByZWFsLXRpbWUgd2ViIGFwcGxpY2F0aW9ucy5cclxuICovXHJcblxyXG5pbXBvcnQgRWNobyBmcm9tIFwibGFyYXZlbC1lY2hvXCI7XHJcbmltcG9ydCBQdXNoZXIgZnJvbSBcInB1c2hlci1qc1wiO1xyXG5cclxuXHJcbnZhciB1c2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpKTtcclxudmFyIHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3NhdGVsbGl6ZXJfdG9rZW4nKTtcclxuY29uc29sZS5sb2codG9rZW4pO1xyXG53aW5kb3cuRWNobyA9IG5ldyBFY2hvKHtcclxuICAgIGJyb2FkY2FzdGVyOiAncHVzaGVyJyxcclxuICAgIGtleTogJ2QxZTUwMDk1NTRhMGJjZDM1N2E0JyxcclxuICAgIGNsdXN0ZXI6ICdldScsXHJcbiAgICBlbmNyeXB0ZWQ6IHRydWUsXHJcbi8vICAgIGhvc3Q6IHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSxcclxuICAgIGF1dGg6XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgdG9rZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbn0pO1xyXG5cclxud2luZG93LkVjaG8ucHJpdmF0ZSgndXNlcnMuJyArIHVzZXIuaWQgKyAnLmJvb2ttYXJrcycpXHJcbiAgICAgICAgLmxpc3RlbignLkFwcC5FdmVudHMuQm9va21hcmtzLlN0b3JlZCcsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdoaScpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcclxuICAgICAgICB9KTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvYm9vdHN0cmFwLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OzsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 1 */
/***/ function(module, exports) {

eval("var asyncGenerator = function () {\n  function AwaitValue(value) {\n    this.value = value;\n  }\n\n  function AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n\n        if (value instanceof AwaitValue) {\n          Promise.resolve(value.value).then(function (arg) {\n            resume(\"next\", arg);\n          }, function (arg) {\n            resume(\"throw\", arg);\n          });\n        } else {\n          settle(result.done ? \"return\" : \"normal\", result.value);\n        }\n      } catch (err) {\n        settle(\"throw\", err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case \"return\":\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case \"throw\":\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== \"function\") {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === \"function\" && Symbol.asyncIterator) {\n    AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n\n  AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke(\"next\", arg);\n  };\n\n  AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke(\"throw\", arg);\n  };\n\n  AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke(\"return\", arg);\n  };\n\n  return {\n    wrap: function (fn) {\n      return function () {\n        return new AsyncGenerator(fn.apply(this, arguments));\n      };\n    },\n    await: function (value) {\n      return new AwaitValue(value);\n    }\n  };\n}();\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\nvar Connector = function () {\n    function Connector(options) {\n        classCallCheck(this, Connector);\n\n        this._defaultOptions = {\n            auth: {\n                headers: {}\n            },\n            authEndpoint: '/broadcasting/auth',\n            broadcaster: 'pusher',\n            csrfToken: null,\n            host: null,\n            key: null,\n            namespace: 'App.Events'\n        };\n        this.setOptions(options);\n        this.connect();\n    }\n\n    createClass(Connector, [{\n        key: 'setOptions',\n        value: function setOptions(options) {\n            this.options = _extends(this._defaultOptions, options);\n            if (this.csrfToken()) {\n                this.options.auth.headers['X-CSRF-TOKEN'] = this.csrfToken();\n            }\n            return options;\n        }\n    }, {\n        key: 'csrfToken',\n        value: function csrfToken() {\n            var selector = void 0;\n            if (window && window['Laravel'] && window['Laravel'].csrfToken) {\n                return window['Laravel'].csrfToken;\n            } else if (this.options.csrfToken) {\n                return this.options.csrfToken;\n            } else if (typeof document !== 'undefined' && (selector = document.querySelector('meta[name=\"csrf-token\"]'))) {\n                return selector.getAttribute('content');\n            }\n            return null;\n        }\n    }]);\n    return Connector;\n}();\n\nvar Channel = function () {\n    function Channel() {\n        classCallCheck(this, Channel);\n    }\n\n    createClass(Channel, [{\n        key: 'notification',\n        value: function notification(callback) {\n            return this.listen('.Illuminate.Notifications.Events.BroadcastNotificationCreated', callback);\n        }\n    }, {\n        key: 'listenForWhisper',\n        value: function listenForWhisper(event, callback) {\n            return this.listen('.client-' + event, callback);\n        }\n    }]);\n    return Channel;\n}();\n\nvar EventFormatter = function () {\n    function EventFormatter(namespace) {\n        classCallCheck(this, EventFormatter);\n\n        this.setNamespace(namespace);\n    }\n\n    createClass(EventFormatter, [{\n        key: 'format',\n        value: function format(event) {\n            if (this.namespace) {\n                if (event.charAt(0) != '\\\\' && event.charAt(0) != '.') {\n                    event = this.namespace + '.' + event;\n                } else {\n                    event = event.substr(1);\n                }\n            }\n            return event.replace(/\\./g, '\\\\');\n        }\n    }, {\n        key: 'setNamespace',\n        value: function setNamespace(value) {\n            this.namespace = value;\n        }\n    }]);\n    return EventFormatter;\n}();\n\nvar PusherChannel = function (_Channel) {\n    inherits(PusherChannel, _Channel);\n\n    function PusherChannel(pusher, name, options) {\n        classCallCheck(this, PusherChannel);\n\n        var _this = possibleConstructorReturn(this, (PusherChannel.__proto__ || Object.getPrototypeOf(PusherChannel)).call(this));\n\n        _this.name = name;\n        _this.pusher = pusher;\n        _this.options = options;\n        _this.eventFormatter = new EventFormatter(_this.options.namespace);\n        _this.subscribe();\n        return _this;\n    }\n\n    createClass(PusherChannel, [{\n        key: 'subscribe',\n        value: function subscribe() {\n            this.subscription = this.pusher.subscribe(this.name);\n        }\n    }, {\n        key: 'unsubscribe',\n        value: function unsubscribe() {\n            this.pusher.unsubscribe(this.name);\n        }\n    }, {\n        key: 'listen',\n        value: function listen(event, callback) {\n            this.on(this.eventFormatter.format(event), callback);\n            return this;\n        }\n    }, {\n        key: 'stopListening',\n        value: function stopListening(event) {\n            this.subscription.unbind(this.eventFormatter.format(event));\n            return this;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, callback) {\n            this.subscription.bind(event, callback);\n            return this;\n        }\n    }]);\n    return PusherChannel;\n}(Channel);\n\nvar PusherPrivateChannel = function (_PusherChannel) {\n    inherits(PusherPrivateChannel, _PusherChannel);\n\n    function PusherPrivateChannel() {\n        classCallCheck(this, PusherPrivateChannel);\n        return possibleConstructorReturn(this, (PusherPrivateChannel.__proto__ || Object.getPrototypeOf(PusherPrivateChannel)).apply(this, arguments));\n    }\n\n    createClass(PusherPrivateChannel, [{\n        key: 'whisper',\n        value: function whisper(eventName, data) {\n            this.pusher.channels.channels[this.name].trigger('client-' + eventName, data);\n            return this;\n        }\n    }]);\n    return PusherPrivateChannel;\n}(PusherChannel);\n\nvar PusherPresenceChannel = function (_PusherChannel) {\n    inherits(PusherPresenceChannel, _PusherChannel);\n\n    function PusherPresenceChannel() {\n        classCallCheck(this, PusherPresenceChannel);\n        return possibleConstructorReturn(this, (PusherPresenceChannel.__proto__ || Object.getPrototypeOf(PusherPresenceChannel)).apply(this, arguments));\n    }\n\n    createClass(PusherPresenceChannel, [{\n        key: 'here',\n        value: function here(callback) {\n            this.on('pusher:subscription_succeeded', function (data) {\n                callback(Object.keys(data.members).map(function (k) {\n                    return data.members[k];\n                }));\n            });\n            return this;\n        }\n    }, {\n        key: 'joining',\n        value: function joining(callback) {\n            this.on('pusher:member_added', function (member) {\n                callback(member.info);\n            });\n            return this;\n        }\n    }, {\n        key: 'leaving',\n        value: function leaving(callback) {\n            this.on('pusher:member_removed', function (member) {\n                callback(member.info);\n            });\n            return this;\n        }\n    }, {\n        key: 'whisper',\n        value: function whisper(eventName, data) {\n            this.pusher.channels.channels[this.name].trigger('client-' + eventName, data);\n            return this;\n        }\n    }]);\n    return PusherPresenceChannel;\n}(PusherChannel);\n\nvar SocketIoChannel = function (_Channel) {\n    inherits(SocketIoChannel, _Channel);\n\n    function SocketIoChannel(socket, name, options) {\n        classCallCheck(this, SocketIoChannel);\n\n        var _this = possibleConstructorReturn(this, (SocketIoChannel.__proto__ || Object.getPrototypeOf(SocketIoChannel)).call(this));\n\n        _this.events = {};\n        _this.name = name;\n        _this.socket = socket;\n        _this.options = options;\n        _this.eventFormatter = new EventFormatter(_this.options.namespace);\n        _this.subscribe();\n        _this.configureReconnector();\n        return _this;\n    }\n\n    createClass(SocketIoChannel, [{\n        key: 'subscribe',\n        value: function subscribe() {\n            this.socket.emit('subscribe', {\n                channel: this.name,\n                auth: this.options.auth || {}\n            });\n        }\n    }, {\n        key: 'unsubscribe',\n        value: function unsubscribe() {\n            this.unbind();\n            this.socket.emit('unsubscribe', {\n                channel: this.name,\n                auth: this.options.auth || {}\n            });\n        }\n    }, {\n        key: 'listen',\n        value: function listen(event, callback) {\n            this.on(this.eventFormatter.format(event), callback);\n            return this;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, callback) {\n            var _this2 = this;\n\n            var listener = function listener(channel, data) {\n                if (_this2.name == channel) {\n                    callback(data);\n                }\n            };\n            this.socket.on(event, listener);\n            this.bind(event, listener);\n        }\n    }, {\n        key: 'configureReconnector',\n        value: function configureReconnector() {\n            var _this3 = this;\n\n            var listener = function listener() {\n                _this3.subscribe();\n            };\n            this.socket.on('reconnect', listener);\n            this.bind('reconnect', listener);\n        }\n    }, {\n        key: 'bind',\n        value: function bind(event, callback) {\n            this.events[event] = this.events[event] || [];\n            this.events[event].push(callback);\n        }\n    }, {\n        key: 'unbind',\n        value: function unbind() {\n            var _this4 = this;\n\n            Object.keys(this.events).forEach(function (event) {\n                _this4.events[event].forEach(function (callback) {\n                    _this4.socket.removeListener(event, callback);\n                });\n                delete _this4.events[event];\n            });\n        }\n    }]);\n    return SocketIoChannel;\n}(Channel);\n\nvar SocketIoPrivateChannel = function (_SocketIoChannel) {\n    inherits(SocketIoPrivateChannel, _SocketIoChannel);\n\n    function SocketIoPrivateChannel() {\n        classCallCheck(this, SocketIoPrivateChannel);\n        return possibleConstructorReturn(this, (SocketIoPrivateChannel.__proto__ || Object.getPrototypeOf(SocketIoPrivateChannel)).apply(this, arguments));\n    }\n\n    createClass(SocketIoPrivateChannel, [{\n        key: 'whisper',\n        value: function whisper(eventName, data) {\n            this.socket.emit('client event', {\n                channel: this.name,\n                event: 'client-' + eventName,\n                data: data\n            });\n            return this;\n        }\n    }]);\n    return SocketIoPrivateChannel;\n}(SocketIoChannel);\n\nvar SocketIoPresenceChannel = function (_SocketIoPrivateChann) {\n    inherits(SocketIoPresenceChannel, _SocketIoPrivateChann);\n\n    function SocketIoPresenceChannel() {\n        classCallCheck(this, SocketIoPresenceChannel);\n        return possibleConstructorReturn(this, (SocketIoPresenceChannel.__proto__ || Object.getPrototypeOf(SocketIoPresenceChannel)).apply(this, arguments));\n    }\n\n    createClass(SocketIoPresenceChannel, [{\n        key: 'here',\n        value: function here(callback) {\n            this.on('presence:subscribed', function (members) {\n                callback(members.map(function (m) {\n                    return m.user_info;\n                }));\n            });\n            return this;\n        }\n    }, {\n        key: 'joining',\n        value: function joining(callback) {\n            this.on('presence:joining', function (member) {\n                return callback(member.user_info);\n            });\n            return this;\n        }\n    }, {\n        key: 'leaving',\n        value: function leaving(callback) {\n            this.on('presence:leaving', function (member) {\n                return callback(member.user_info);\n            });\n            return this;\n        }\n    }]);\n    return SocketIoPresenceChannel;\n}(SocketIoPrivateChannel);\n\nvar PusherConnector = function (_Connector) {\n    inherits(PusherConnector, _Connector);\n\n    function PusherConnector() {\n        var _ref;\n\n        classCallCheck(this, PusherConnector);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        var _this = possibleConstructorReturn(this, (_ref = PusherConnector.__proto__ || Object.getPrototypeOf(PusherConnector)).call.apply(_ref, [this].concat(args)));\n\n        _this.channels = {};\n        return _this;\n    }\n\n    createClass(PusherConnector, [{\n        key: 'connect',\n        value: function connect() {\n            this.pusher = new Pusher(this.options.key, this.options);\n        }\n    }, {\n        key: 'listen',\n        value: function listen(name, event, callback) {\n            return this.channel(name).listen(event, callback);\n        }\n    }, {\n        key: 'channel',\n        value: function channel(name) {\n            if (!this.channels[name]) {\n                this.channels[name] = new PusherChannel(this.pusher, name, this.options);\n            }\n            return this.channels[name];\n        }\n    }, {\n        key: 'privateChannel',\n        value: function privateChannel(name) {\n            if (!this.channels['private-' + name]) {\n                this.channels['private-' + name] = new PusherPrivateChannel(this.pusher, 'private-' + name, this.options);\n            }\n            return this.channels['private-' + name];\n        }\n    }, {\n        key: 'presenceChannel',\n        value: function presenceChannel(name) {\n            if (!this.channels['presence-' + name]) {\n                this.channels['presence-' + name] = new PusherPresenceChannel(this.pusher, 'presence-' + name, this.options);\n            }\n            return this.channels['presence-' + name];\n        }\n    }, {\n        key: 'leave',\n        value: function leave(name) {\n            var _this2 = this;\n\n            var channels = [name, 'private-' + name, 'presence-' + name];\n            channels.forEach(function (name, index) {\n                if (_this2.channels[name]) {\n                    _this2.channels[name].unsubscribe();\n                    delete _this2.channels[name];\n                }\n            });\n        }\n    }, {\n        key: 'socketId',\n        value: function socketId() {\n            return this.pusher.connection.socket_id;\n        }\n    }]);\n    return PusherConnector;\n}(Connector);\n\nvar SocketIoConnector = function (_Connector) {\n    inherits(SocketIoConnector, _Connector);\n\n    function SocketIoConnector() {\n        var _ref;\n\n        classCallCheck(this, SocketIoConnector);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        var _this = possibleConstructorReturn(this, (_ref = SocketIoConnector.__proto__ || Object.getPrototypeOf(SocketIoConnector)).call.apply(_ref, [this].concat(args)));\n\n        _this.channels = {};\n        return _this;\n    }\n\n    createClass(SocketIoConnector, [{\n        key: 'connect',\n        value: function connect() {\n            this.socket = io(this.options.host, this.options);\n            return this.socket;\n        }\n    }, {\n        key: 'listen',\n        value: function listen(name, event, callback) {\n            return this.channel(name).listen(event, callback);\n        }\n    }, {\n        key: 'channel',\n        value: function channel(name) {\n            if (!this.channels[name]) {\n                this.channels[name] = new SocketIoChannel(this.socket, name, this.options);\n            }\n            return this.channels[name];\n        }\n    }, {\n        key: 'privateChannel',\n        value: function privateChannel(name) {\n            if (!this.channels['private-' + name]) {\n                this.channels['private-' + name] = new SocketIoPrivateChannel(this.socket, 'private-' + name, this.options);\n            }\n            return this.channels['private-' + name];\n        }\n    }, {\n        key: 'presenceChannel',\n        value: function presenceChannel(name) {\n            if (!this.channels['presence-' + name]) {\n                this.channels['presence-' + name] = new SocketIoPresenceChannel(this.socket, 'presence-' + name, this.options);\n            }\n            return this.channels['presence-' + name];\n        }\n    }, {\n        key: 'leave',\n        value: function leave(name) {\n            var _this2 = this;\n\n            var channels = [name, 'private-' + name, 'presence-' + name];\n            channels.forEach(function (name) {\n                if (_this2.channels[name]) {\n                    _this2.channels[name].unsubscribe();\n                    delete _this2.channels[name];\n                }\n            });\n        }\n    }, {\n        key: 'socketId',\n        value: function socketId() {\n            return this.socket.id;\n        }\n    }]);\n    return SocketIoConnector;\n}(Connector);\n\nvar Echo = function () {\n    function Echo(options) {\n        classCallCheck(this, Echo);\n\n        this.options = options;\n        if (typeof Vue === 'function' && Vue.http) {\n            this.registerVueRequestInterceptor();\n        }\n        if (typeof axios === 'function') {\n            this.registerAxiosRequestInterceptor();\n        }\n        if (typeof jQuery === 'function') {\n            this.registerjQueryAjaxSetup();\n        }\n        if (this.options.broadcaster == 'pusher') {\n            this.connector = new PusherConnector(this.options);\n        } else if (this.options.broadcaster == 'socket.io') {\n            this.connector = new SocketIoConnector(this.options);\n        }\n    }\n\n    createClass(Echo, [{\n        key: 'registerVueRequestInterceptor',\n        value: function registerVueRequestInterceptor() {\n            var _this = this;\n\n            Vue.http.interceptors.push(function (request, next) {\n                if (_this.socketId()) {\n                    request.headers.set('X-Socket-ID', _this.socketId());\n                }\n                next();\n            });\n        }\n    }, {\n        key: 'registerAxiosRequestInterceptor',\n        value: function registerAxiosRequestInterceptor() {\n            var _this2 = this;\n\n            axios.interceptors.request.use(function (config) {\n                if (_this2.socketId()) {\n                    config.headers['X-Socket-Id'] = _this2.socketId();\n                }\n                return config;\n            });\n        }\n    }, {\n        key: 'registerjQueryAjaxSetup',\n        value: function registerjQueryAjaxSetup() {\n            var _this3 = this;\n\n            if (typeof jQuery.ajax != 'undefined') {\n                jQuery.ajaxSetup({\n                    beforeSend: function beforeSend(xhr) {\n                        if (_this3.socketId()) {\n                            xhr.setRequestHeader('X-Socket-Id', _this3.socketId());\n                        }\n                    }\n                });\n            }\n        }\n    }, {\n        key: 'listen',\n        value: function listen(channel, event, callback) {\n            return this.connector.listen(channel, event, callback);\n        }\n    }, {\n        key: 'channel',\n        value: function channel(_channel) {\n            return this.connector.channel(_channel);\n        }\n    }, {\n        key: 'private',\n        value: function _private(channel) {\n            return this.connector.privateChannel(channel);\n        }\n    }, {\n        key: 'join',\n        value: function join(channel) {\n            return this.connector.presenceChannel(channel);\n        }\n    }, {\n        key: 'leave',\n        value: function leave(channel) {\n            this.connector.leave(channel);\n        }\n    }, {\n        key: 'socketId',\n        value: function socketId() {\n            return this.connector.socketId();\n        }\n    }]);\n    return Echo;\n}();\n\nmodule.exports = Echo;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL34vbGFyYXZlbC1lY2hvL2Rpc3QvZWNoby5qcz84ZmMyIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBhc3luY0dlbmVyYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQXdhaXRWYWx1ZSh2YWx1ZSkge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIEFzeW5jR2VuZXJhdG9yKGdlbikge1xuICAgIHZhciBmcm9udCwgYmFjaztcblxuICAgIGZ1bmN0aW9uIHNlbmQoa2V5LCBhcmcpIHtcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciByZXF1ZXN0ID0ge1xuICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgIGFyZzogYXJnLFxuICAgICAgICAgIHJlc29sdmU6IHJlc29sdmUsXG4gICAgICAgICAgcmVqZWN0OiByZWplY3QsXG4gICAgICAgICAgbmV4dDogbnVsbFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChiYWNrKSB7XG4gICAgICAgICAgYmFjayA9IGJhY2submV4dCA9IHJlcXVlc3Q7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZnJvbnQgPSBiYWNrID0gcmVxdWVzdDtcbiAgICAgICAgICByZXN1bWUoa2V5LCBhcmcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXN1bWUoa2V5LCBhcmcpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBnZW5ba2V5XShhcmcpO1xuICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7XG5cbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXdhaXRWYWx1ZSkge1xuICAgICAgICAgIFByb21pc2UucmVzb2x2ZSh2YWx1ZS52YWx1ZSkudGhlbihmdW5jdGlvbiAoYXJnKSB7XG4gICAgICAgICAgICByZXN1bWUoXCJuZXh0XCIsIGFyZyk7XG4gICAgICAgICAgfSwgZnVuY3Rpb24gKGFyZykge1xuICAgICAgICAgICAgcmVzdW1lKFwidGhyb3dcIiwgYXJnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZXR0bGUocmVzdWx0LmRvbmUgPyBcInJldHVyblwiIDogXCJub3JtYWxcIiwgcmVzdWx0LnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHNldHRsZShcInRocm93XCIsIGVycik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0dGxlKHR5cGUsIHZhbHVlKSB7XG4gICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSBcInJldHVyblwiOlxuICAgICAgICAgIGZyb250LnJlc29sdmUoe1xuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgICAgZG9uZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgXCJ0aHJvd1wiOlxuICAgICAgICAgIGZyb250LnJlamVjdCh2YWx1ZSk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBmcm9udC5yZXNvbHZlKHtcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgIGRvbmU6IGZhbHNlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGZyb250ID0gZnJvbnQubmV4dDtcblxuICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgIHJlc3VtZShmcm9udC5rZXksIGZyb250LmFyZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBiYWNrID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLl9pbnZva2UgPSBzZW5kO1xuXG4gICAgaWYgKHR5cGVvZiBnZW4ucmV0dXJuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRoaXMucmV0dXJuID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHtcbiAgICBBc3luY0dlbmVyYXRvci5wcm90b3R5cGVbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgfVxuXG4gIEFzeW5jR2VuZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKGFyZykge1xuICAgIHJldHVybiB0aGlzLl9pbnZva2UoXCJuZXh0XCIsIGFyZyk7XG4gIH07XG5cbiAgQXN5bmNHZW5lcmF0b3IucHJvdG90eXBlLnRocm93ID0gZnVuY3Rpb24gKGFyZykge1xuICAgIHJldHVybiB0aGlzLl9pbnZva2UoXCJ0aHJvd1wiLCBhcmcpO1xuICB9O1xuXG4gIEFzeW5jR2VuZXJhdG9yLnByb3RvdHlwZS5yZXR1cm4gPSBmdW5jdGlvbiAoYXJnKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ludm9rZShcInJldHVyblwiLCBhcmcpO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgd3JhcDogZnVuY3Rpb24gKGZuKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IEFzeW5jR2VuZXJhdG9yKGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgICAgfTtcbiAgICB9LFxuICAgIGF3YWl0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiBuZXcgQXdhaXRWYWx1ZSh2YWx1ZSk7XG4gICAgfVxuICB9O1xufSgpO1xuXG52YXIgY2xhc3NDYWxsQ2hlY2sgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbiAgfVxufTtcblxudmFyIGNyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykge1xuICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7XG4gICAgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7XG4gICAgcmV0dXJuIENvbnN0cnVjdG9yO1xuICB9O1xufSgpO1xuXG52YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuXG4gICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGFyZ2V0O1xufTtcblxudmFyIGluaGVyaXRzID0gZnVuY3Rpb24gKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7XG4gIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTtcbiAgfVxuXG4gIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwge1xuICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICB2YWx1ZTogc3ViQ2xhc3MsXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfVxuICB9KTtcbiAgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzO1xufTtcblxudmFyIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gPSBmdW5jdGlvbiAoc2VsZiwgY2FsbCkge1xuICBpZiAoIXNlbGYpIHtcbiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7XG4gIH1cblxuICByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjtcbn07XG5cbnZhciBDb25uZWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29ubmVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29ubmVjdG9yKTtcblxuICAgICAgICB0aGlzLl9kZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgICAgICAgIGF1dGg6IHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7fVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGF1dGhFbmRwb2ludDogJy9icm9hZGNhc3RpbmcvYXV0aCcsXG4gICAgICAgICAgICBicm9hZGNhc3RlcjogJ3B1c2hlcicsXG4gICAgICAgICAgICBjc3JmVG9rZW46IG51bGwsXG4gICAgICAgICAgICBob3N0OiBudWxsLFxuICAgICAgICAgICAga2V5OiBudWxsLFxuICAgICAgICAgICAgbmFtZXNwYWNlOiAnQXBwLkV2ZW50cydcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZXRPcHRpb25zKG9wdGlvbnMpO1xuICAgICAgICB0aGlzLmNvbm5lY3QoKTtcbiAgICB9XG5cbiAgICBjcmVhdGVDbGFzcyhDb25uZWN0b3IsIFt7XG4gICAgICAgIGtleTogJ3NldE9wdGlvbnMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0T3B0aW9ucyhvcHRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBfZXh0ZW5kcyh0aGlzLl9kZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG4gICAgICAgICAgICBpZiAodGhpcy5jc3JmVG9rZW4oKSkge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5hdXRoLmhlYWRlcnNbJ1gtQ1NSRi1UT0tFTiddID0gdGhpcy5jc3JmVG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvcHRpb25zO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjc3JmVG9rZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3NyZlRva2VuKCkge1xuICAgICAgICAgICAgdmFyIHNlbGVjdG9yID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKHdpbmRvdyAmJiB3aW5kb3dbJ0xhcmF2ZWwnXSAmJiB3aW5kb3dbJ0xhcmF2ZWwnXS5jc3JmVG9rZW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gd2luZG93WydMYXJhdmVsJ10uY3NyZlRva2VuO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMuY3NyZlRva2VuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5jc3JmVG9rZW47XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgKHNlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3Rvci5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfV0pO1xuICAgIHJldHVybiBDb25uZWN0b3I7XG59KCk7XG5cbnZhciBDaGFubmVsID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENoYW5uZWwoKSB7XG4gICAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIENoYW5uZWwpO1xuICAgIH1cblxuICAgIGNyZWF0ZUNsYXNzKENoYW5uZWwsIFt7XG4gICAgICAgIGtleTogJ25vdGlmaWNhdGlvbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBub3RpZmljYXRpb24oY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxpc3RlbignLklsbHVtaW5hdGUuTm90aWZpY2F0aW9ucy5FdmVudHMuQnJvYWRjYXN0Tm90aWZpY2F0aW9uQ3JlYXRlZCcsIGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbGlzdGVuRm9yV2hpc3BlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsaXN0ZW5Gb3JXaGlzcGVyKGV2ZW50LCBjYWxsYmFjaykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuKCcuY2xpZW50LScgKyBldmVudCwgY2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgfV0pO1xuICAgIHJldHVybiBDaGFubmVsO1xufSgpO1xuXG52YXIgRXZlbnRGb3JtYXR0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRXZlbnRGb3JtYXR0ZXIobmFtZXNwYWNlKSB7XG4gICAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIEV2ZW50Rm9ybWF0dGVyKTtcblxuICAgICAgICB0aGlzLnNldE5hbWVzcGFjZShuYW1lc3BhY2UpO1xuICAgIH1cblxuICAgIGNyZWF0ZUNsYXNzKEV2ZW50Rm9ybWF0dGVyLCBbe1xuICAgICAgICBrZXk6ICdmb3JtYXQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZm9ybWF0KGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5uYW1lc3BhY2UpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQuY2hhckF0KDApICE9ICdcXFxcJyAmJiBldmVudC5jaGFyQXQoMCkgIT0gJy4nKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50ID0gdGhpcy5uYW1lc3BhY2UgKyAnLicgKyBldmVudDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBldmVudCA9IGV2ZW50LnN1YnN0cigxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZXZlbnQucmVwbGFjZSgvXFwuL2csICdcXFxcJyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NldE5hbWVzcGFjZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXROYW1lc3BhY2UodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZXNwYWNlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XSk7XG4gICAgcmV0dXJuIEV2ZW50Rm9ybWF0dGVyO1xufSgpO1xuXG52YXIgUHVzaGVyQ2hhbm5lbCA9IGZ1bmN0aW9uIChfQ2hhbm5lbCkge1xuICAgIGluaGVyaXRzKFB1c2hlckNoYW5uZWwsIF9DaGFubmVsKTtcblxuICAgIGZ1bmN0aW9uIFB1c2hlckNoYW5uZWwocHVzaGVyLCBuYW1lLCBvcHRpb25zKSB7XG4gICAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIFB1c2hlckNoYW5uZWwpO1xuXG4gICAgICAgIHZhciBfdGhpcyA9IHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFB1c2hlckNoYW5uZWwuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihQdXNoZXJDaGFubmVsKSkuY2FsbCh0aGlzKSk7XG5cbiAgICAgICAgX3RoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIF90aGlzLnB1c2hlciA9IHB1c2hlcjtcbiAgICAgICAgX3RoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIF90aGlzLmV2ZW50Rm9ybWF0dGVyID0gbmV3IEV2ZW50Rm9ybWF0dGVyKF90aGlzLm9wdGlvbnMubmFtZXNwYWNlKTtcbiAgICAgICAgX3RoaXMuc3Vic2NyaWJlKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG5cbiAgICBjcmVhdGVDbGFzcyhQdXNoZXJDaGFubmVsLCBbe1xuICAgICAgICBrZXk6ICdzdWJzY3JpYmUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKCkge1xuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb24gPSB0aGlzLnB1c2hlci5zdWJzY3JpYmUodGhpcy5uYW1lKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndW5zdWJzY3JpYmUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7XG4gICAgICAgICAgICB0aGlzLnB1c2hlci51bnN1YnNjcmliZSh0aGlzLm5hbWUpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdsaXN0ZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbGlzdGVuKGV2ZW50LCBjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5vbih0aGlzLmV2ZW50Rm9ybWF0dGVyLmZvcm1hdChldmVudCksIGNhbGxiYWNrKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdG9wTGlzdGVuaW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3BMaXN0ZW5pbmcoZXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uLnVuYmluZCh0aGlzLmV2ZW50Rm9ybWF0dGVyLmZvcm1hdChldmVudCkpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2ZW50LCBjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb24uYmluZChldmVudCwgY2FsbGJhY2spO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9XSk7XG4gICAgcmV0dXJuIFB1c2hlckNoYW5uZWw7XG59KENoYW5uZWwpO1xuXG52YXIgUHVzaGVyUHJpdmF0ZUNoYW5uZWwgPSBmdW5jdGlvbiAoX1B1c2hlckNoYW5uZWwpIHtcbiAgICBpbmhlcml0cyhQdXNoZXJQcml2YXRlQ2hhbm5lbCwgX1B1c2hlckNoYW5uZWwpO1xuXG4gICAgZnVuY3Rpb24gUHVzaGVyUHJpdmF0ZUNoYW5uZWwoKSB7XG4gICAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIFB1c2hlclByaXZhdGVDaGFubmVsKTtcbiAgICAgICAgcmV0dXJuIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFB1c2hlclByaXZhdGVDaGFubmVsLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoUHVzaGVyUHJpdmF0ZUNoYW5uZWwpKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICB9XG5cbiAgICBjcmVhdGVDbGFzcyhQdXNoZXJQcml2YXRlQ2hhbm5lbCwgW3tcbiAgICAgICAga2V5OiAnd2hpc3BlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB3aGlzcGVyKGV2ZW50TmFtZSwgZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5wdXNoZXIuY2hhbm5lbHMuY2hhbm5lbHNbdGhpcy5uYW1lXS50cmlnZ2VyKCdjbGllbnQtJyArIGV2ZW50TmFtZSwgZGF0YSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgIH1dKTtcbiAgICByZXR1cm4gUHVzaGVyUHJpdmF0ZUNoYW5uZWw7XG59KFB1c2hlckNoYW5uZWwpO1xuXG52YXIgUHVzaGVyUHJlc2VuY2VDaGFubmVsID0gZnVuY3Rpb24gKF9QdXNoZXJDaGFubmVsKSB7XG4gICAgaW5oZXJpdHMoUHVzaGVyUHJlc2VuY2VDaGFubmVsLCBfUHVzaGVyQ2hhbm5lbCk7XG5cbiAgICBmdW5jdGlvbiBQdXNoZXJQcmVzZW5jZUNoYW5uZWwoKSB7XG4gICAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIFB1c2hlclByZXNlbmNlQ2hhbm5lbCk7XG4gICAgICAgIHJldHVybiBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChQdXNoZXJQcmVzZW5jZUNoYW5uZWwuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihQdXNoZXJQcmVzZW5jZUNoYW5uZWwpKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICB9XG5cbiAgICBjcmVhdGVDbGFzcyhQdXNoZXJQcmVzZW5jZUNoYW5uZWwsIFt7XG4gICAgICAgIGtleTogJ2hlcmUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGVyZShjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5vbigncHVzaGVyOnN1YnNjcmlwdGlvbl9zdWNjZWVkZWQnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKE9iamVjdC5rZXlzKGRhdGEubWVtYmVycykubWFwKGZ1bmN0aW9uIChrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLm1lbWJlcnNba107XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnam9pbmluZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luaW5nKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLm9uKCdwdXNoZXI6bWVtYmVyX2FkZGVkJywgZnVuY3Rpb24gKG1lbWJlcikge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG1lbWJlci5pbmZvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xlYXZpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbGVhdmluZyhjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5vbigncHVzaGVyOm1lbWJlcl9yZW1vdmVkJywgZnVuY3Rpb24gKG1lbWJlcikge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG1lbWJlci5pbmZvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3doaXNwZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd2hpc3BlcihldmVudE5hbWUsIGRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMucHVzaGVyLmNoYW5uZWxzLmNoYW5uZWxzW3RoaXMubmFtZV0udHJpZ2dlcignY2xpZW50LScgKyBldmVudE5hbWUsIGRhdGEpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9XSk7XG4gICAgcmV0dXJuIFB1c2hlclByZXNlbmNlQ2hhbm5lbDtcbn0oUHVzaGVyQ2hhbm5lbCk7XG5cbnZhciBTb2NrZXRJb0NoYW5uZWwgPSBmdW5jdGlvbiAoX0NoYW5uZWwpIHtcbiAgICBpbmhlcml0cyhTb2NrZXRJb0NoYW5uZWwsIF9DaGFubmVsKTtcblxuICAgIGZ1bmN0aW9uIFNvY2tldElvQ2hhbm5lbChzb2NrZXQsIG5hbWUsIG9wdGlvbnMpIHtcbiAgICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgU29ja2V0SW9DaGFubmVsKTtcblxuICAgICAgICB2YXIgX3RoaXMgPSBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChTb2NrZXRJb0NoYW5uZWwuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTb2NrZXRJb0NoYW5uZWwpKS5jYWxsKHRoaXMpKTtcblxuICAgICAgICBfdGhpcy5ldmVudHMgPSB7fTtcbiAgICAgICAgX3RoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIF90aGlzLnNvY2tldCA9IHNvY2tldDtcbiAgICAgICAgX3RoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIF90aGlzLmV2ZW50Rm9ybWF0dGVyID0gbmV3IEV2ZW50Rm9ybWF0dGVyKF90aGlzLm9wdGlvbnMubmFtZXNwYWNlKTtcbiAgICAgICAgX3RoaXMuc3Vic2NyaWJlKCk7XG4gICAgICAgIF90aGlzLmNvbmZpZ3VyZVJlY29ubmVjdG9yKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG5cbiAgICBjcmVhdGVDbGFzcyhTb2NrZXRJb0NoYW5uZWwsIFt7XG4gICAgICAgIGtleTogJ3N1YnNjcmliZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdWJzY3JpYmUoKSB7XG4gICAgICAgICAgICB0aGlzLnNvY2tldC5lbWl0KCdzdWJzY3JpYmUnLCB7XG4gICAgICAgICAgICAgICAgY2hhbm5lbDogdGhpcy5uYW1lLFxuICAgICAgICAgICAgICAgIGF1dGg6IHRoaXMub3B0aW9ucy5hdXRoIHx8IHt9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndW5zdWJzY3JpYmUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7XG4gICAgICAgICAgICB0aGlzLnVuYmluZCgpO1xuICAgICAgICAgICAgdGhpcy5zb2NrZXQuZW1pdCgndW5zdWJzY3JpYmUnLCB7XG4gICAgICAgICAgICAgICAgY2hhbm5lbDogdGhpcy5uYW1lLFxuICAgICAgICAgICAgICAgIGF1dGg6IHRoaXMub3B0aW9ucy5hdXRoIHx8IHt9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbGlzdGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxpc3RlbihldmVudCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMub24odGhpcy5ldmVudEZvcm1hdHRlci5mb3JtYXQoZXZlbnQpLCBjYWxsYmFjayk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb24oZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24gbGlzdGVuZXIoY2hhbm5lbCwgZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczIubmFtZSA9PSBjaGFubmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnNvY2tldC5vbihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICAgICAgdGhpcy5iaW5kKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2NvbmZpZ3VyZVJlY29ubmVjdG9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbmZpZ3VyZVJlY29ubmVjdG9yKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uIGxpc3RlbmVyKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMy5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnNvY2tldC5vbigncmVjb25uZWN0JywgbGlzdGVuZXIpO1xuICAgICAgICAgICAgdGhpcy5iaW5kKCdyZWNvbm5lY3QnLCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2JpbmQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYmluZChldmVudCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50XSA9IHRoaXMuZXZlbnRzW2V2ZW50XSB8fCBbXTtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50XS5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndW5iaW5kJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVuYmluZCgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmV2ZW50cykuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBfdGhpczQuZXZlbnRzW2V2ZW50XS5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczQuc29ja2V0LnJlbW92ZUxpc3RlbmVyKGV2ZW50LCBjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIF90aGlzNC5ldmVudHNbZXZlbnRdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XSk7XG4gICAgcmV0dXJuIFNvY2tldElvQ2hhbm5lbDtcbn0oQ2hhbm5lbCk7XG5cbnZhciBTb2NrZXRJb1ByaXZhdGVDaGFubmVsID0gZnVuY3Rpb24gKF9Tb2NrZXRJb0NoYW5uZWwpIHtcbiAgICBpbmhlcml0cyhTb2NrZXRJb1ByaXZhdGVDaGFubmVsLCBfU29ja2V0SW9DaGFubmVsKTtcblxuICAgIGZ1bmN0aW9uIFNvY2tldElvUHJpdmF0ZUNoYW5uZWwoKSB7XG4gICAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIFNvY2tldElvUHJpdmF0ZUNoYW5uZWwpO1xuICAgICAgICByZXR1cm4gcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoU29ja2V0SW9Qcml2YXRlQ2hhbm5lbC5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNvY2tldElvUHJpdmF0ZUNoYW5uZWwpKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICB9XG5cbiAgICBjcmVhdGVDbGFzcyhTb2NrZXRJb1ByaXZhdGVDaGFubmVsLCBbe1xuICAgICAgICBrZXk6ICd3aGlzcGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdoaXNwZXIoZXZlbnROYW1lLCBkYXRhKSB7XG4gICAgICAgICAgICB0aGlzLnNvY2tldC5lbWl0KCdjbGllbnQgZXZlbnQnLCB7XG4gICAgICAgICAgICAgICAgY2hhbm5lbDogdGhpcy5uYW1lLFxuICAgICAgICAgICAgICAgIGV2ZW50OiAnY2xpZW50LScgKyBldmVudE5hbWUsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgIH1dKTtcbiAgICByZXR1cm4gU29ja2V0SW9Qcml2YXRlQ2hhbm5lbDtcbn0oU29ja2V0SW9DaGFubmVsKTtcblxudmFyIFNvY2tldElvUHJlc2VuY2VDaGFubmVsID0gZnVuY3Rpb24gKF9Tb2NrZXRJb1ByaXZhdGVDaGFubikge1xuICAgIGluaGVyaXRzKFNvY2tldElvUHJlc2VuY2VDaGFubmVsLCBfU29ja2V0SW9Qcml2YXRlQ2hhbm4pO1xuXG4gICAgZnVuY3Rpb24gU29ja2V0SW9QcmVzZW5jZUNoYW5uZWwoKSB7XG4gICAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIFNvY2tldElvUHJlc2VuY2VDaGFubmVsKTtcbiAgICAgICAgcmV0dXJuIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFNvY2tldElvUHJlc2VuY2VDaGFubmVsLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU29ja2V0SW9QcmVzZW5jZUNoYW5uZWwpKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICB9XG5cbiAgICBjcmVhdGVDbGFzcyhTb2NrZXRJb1ByZXNlbmNlQ2hhbm5lbCwgW3tcbiAgICAgICAga2V5OiAnaGVyZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoZXJlKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLm9uKCdwcmVzZW5jZTpzdWJzY3JpYmVkJywgZnVuY3Rpb24gKG1lbWJlcnMpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhtZW1iZXJzLm1hcChmdW5jdGlvbiAobSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbS51c2VyX2luZm87XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnam9pbmluZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luaW5nKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLm9uKCdwcmVzZW5jZTpqb2luaW5nJywgZnVuY3Rpb24gKG1lbWJlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhtZW1iZXIudXNlcl9pbmZvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xlYXZpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbGVhdmluZyhjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5vbigncHJlc2VuY2U6bGVhdmluZycsIGZ1bmN0aW9uIChtZW1iZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2sobWVtYmVyLnVzZXJfaW5mbyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgfV0pO1xuICAgIHJldHVybiBTb2NrZXRJb1ByZXNlbmNlQ2hhbm5lbDtcbn0oU29ja2V0SW9Qcml2YXRlQ2hhbm5lbCk7XG5cbnZhciBQdXNoZXJDb25uZWN0b3IgPSBmdW5jdGlvbiAoX0Nvbm5lY3Rvcikge1xuICAgIGluaGVyaXRzKFB1c2hlckNvbm5lY3RvciwgX0Nvbm5lY3Rvcik7XG5cbiAgICBmdW5jdGlvbiBQdXNoZXJDb25uZWN0b3IoKSB7XG4gICAgICAgIHZhciBfcmVmO1xuXG4gICAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIFB1c2hlckNvbm5lY3Rvcik7XG5cbiAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgX3RoaXMgPSBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChfcmVmID0gUHVzaGVyQ29ubmVjdG9yLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoUHVzaGVyQ29ubmVjdG9yKSkuY2FsbC5hcHBseShfcmVmLCBbdGhpc10uY29uY2F0KGFyZ3MpKSk7XG5cbiAgICAgICAgX3RoaXMuY2hhbm5lbHMgPSB7fTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cblxuICAgIGNyZWF0ZUNsYXNzKFB1c2hlckNvbm5lY3RvciwgW3tcbiAgICAgICAga2V5OiAnY29ubmVjdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb25uZWN0KCkge1xuICAgICAgICAgICAgdGhpcy5wdXNoZXIgPSBuZXcgUHVzaGVyKHRoaXMub3B0aW9ucy5rZXksIHRoaXMub3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xpc3RlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsaXN0ZW4obmFtZSwgZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jaGFubmVsKG5hbWUpLmxpc3RlbihldmVudCwgY2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjaGFubmVsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNoYW5uZWwobmFtZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNoYW5uZWxzW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFubmVsc1tuYW1lXSA9IG5ldyBQdXNoZXJDaGFubmVsKHRoaXMucHVzaGVyLCBuYW1lLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hhbm5lbHNbbmFtZV07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3ByaXZhdGVDaGFubmVsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHByaXZhdGVDaGFubmVsKG5hbWUpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5jaGFubmVsc1sncHJpdmF0ZS0nICsgbmFtZV0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5uZWxzWydwcml2YXRlLScgKyBuYW1lXSA9IG5ldyBQdXNoZXJQcml2YXRlQ2hhbm5lbCh0aGlzLnB1c2hlciwgJ3ByaXZhdGUtJyArIG5hbWUsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jaGFubmVsc1sncHJpdmF0ZS0nICsgbmFtZV07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3ByZXNlbmNlQ2hhbm5lbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwcmVzZW5jZUNoYW5uZWwobmFtZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNoYW5uZWxzWydwcmVzZW5jZS0nICsgbmFtZV0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5uZWxzWydwcmVzZW5jZS0nICsgbmFtZV0gPSBuZXcgUHVzaGVyUHJlc2VuY2VDaGFubmVsKHRoaXMucHVzaGVyLCAncHJlc2VuY2UtJyArIG5hbWUsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jaGFubmVsc1sncHJlc2VuY2UtJyArIG5hbWVdO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdsZWF2ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsZWF2ZShuYW1lKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGNoYW5uZWxzID0gW25hbWUsICdwcml2YXRlLScgKyBuYW1lLCAncHJlc2VuY2UtJyArIG5hbWVdO1xuICAgICAgICAgICAgY2hhbm5lbHMuZm9yRWFjaChmdW5jdGlvbiAobmFtZSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLmNoYW5uZWxzW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5jaGFubmVsc1tuYW1lXS51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgX3RoaXMyLmNoYW5uZWxzW25hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzb2NrZXRJZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzb2NrZXRJZCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnB1c2hlci5jb25uZWN0aW9uLnNvY2tldF9pZDtcbiAgICAgICAgfVxuICAgIH1dKTtcbiAgICByZXR1cm4gUHVzaGVyQ29ubmVjdG9yO1xufShDb25uZWN0b3IpO1xuXG52YXIgU29ja2V0SW9Db25uZWN0b3IgPSBmdW5jdGlvbiAoX0Nvbm5lY3Rvcikge1xuICAgIGluaGVyaXRzKFNvY2tldElvQ29ubmVjdG9yLCBfQ29ubmVjdG9yKTtcblxuICAgIGZ1bmN0aW9uIFNvY2tldElvQ29ubmVjdG9yKCkge1xuICAgICAgICB2YXIgX3JlZjtcblxuICAgICAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBTb2NrZXRJb0Nvbm5lY3Rvcik7XG5cbiAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgX3RoaXMgPSBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChfcmVmID0gU29ja2V0SW9Db25uZWN0b3IuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTb2NrZXRJb0Nvbm5lY3RvcikpLmNhbGwuYXBwbHkoX3JlZiwgW3RoaXNdLmNvbmNhdChhcmdzKSkpO1xuXG4gICAgICAgIF90aGlzLmNoYW5uZWxzID0ge307XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG5cbiAgICBjcmVhdGVDbGFzcyhTb2NrZXRJb0Nvbm5lY3RvciwgW3tcbiAgICAgICAga2V5OiAnY29ubmVjdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb25uZWN0KCkge1xuICAgICAgICAgICAgdGhpcy5zb2NrZXQgPSBpbyh0aGlzLm9wdGlvbnMuaG9zdCwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNvY2tldDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbGlzdGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxpc3RlbihuYW1lLCBldmVudCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoYW5uZWwobmFtZSkubGlzdGVuKGV2ZW50LCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2NoYW5uZWwnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2hhbm5lbChuYW1lKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2hhbm5lbHNbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5uZWxzW25hbWVdID0gbmV3IFNvY2tldElvQ2hhbm5lbCh0aGlzLnNvY2tldCwgbmFtZSwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoYW5uZWxzW25hbWVdO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwcml2YXRlQ2hhbm5lbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwcml2YXRlQ2hhbm5lbChuYW1lKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2hhbm5lbHNbJ3ByaXZhdGUtJyArIG5hbWVdKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFubmVsc1sncHJpdmF0ZS0nICsgbmFtZV0gPSBuZXcgU29ja2V0SW9Qcml2YXRlQ2hhbm5lbCh0aGlzLnNvY2tldCwgJ3ByaXZhdGUtJyArIG5hbWUsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jaGFubmVsc1sncHJpdmF0ZS0nICsgbmFtZV07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3ByZXNlbmNlQ2hhbm5lbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwcmVzZW5jZUNoYW5uZWwobmFtZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNoYW5uZWxzWydwcmVzZW5jZS0nICsgbmFtZV0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5uZWxzWydwcmVzZW5jZS0nICsgbmFtZV0gPSBuZXcgU29ja2V0SW9QcmVzZW5jZUNoYW5uZWwodGhpcy5zb2NrZXQsICdwcmVzZW5jZS0nICsgbmFtZSwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoYW5uZWxzWydwcmVzZW5jZS0nICsgbmFtZV07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xlYXZlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxlYXZlKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgICAgICB2YXIgY2hhbm5lbHMgPSBbbmFtZSwgJ3ByaXZhdGUtJyArIG5hbWUsICdwcmVzZW5jZS0nICsgbmFtZV07XG4gICAgICAgICAgICBjaGFubmVscy5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMi5jaGFubmVsc1tuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIuY2hhbm5lbHNbbmFtZV0udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIF90aGlzMi5jaGFubmVsc1tuYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc29ja2V0SWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc29ja2V0SWQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zb2NrZXQuaWQ7XG4gICAgICAgIH1cbiAgICB9XSk7XG4gICAgcmV0dXJuIFNvY2tldElvQ29ubmVjdG9yO1xufShDb25uZWN0b3IpO1xuXG52YXIgRWNobyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBFY2hvKG9wdGlvbnMpIHtcbiAgICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgRWNobyk7XG5cbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgaWYgKHR5cGVvZiBWdWUgPT09ICdmdW5jdGlvbicgJiYgVnVlLmh0dHApIHtcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJWdWVSZXF1ZXN0SW50ZXJjZXB0b3IoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGF4aW9zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyQXhpb3NSZXF1ZXN0SW50ZXJjZXB0b3IoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGpRdWVyeSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5yZWdpc3RlcmpRdWVyeUFqYXhTZXR1cCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuYnJvYWRjYXN0ZXIgPT0gJ3B1c2hlcicpIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdG9yID0gbmV3IFB1c2hlckNvbm5lY3Rvcih0aGlzLm9wdGlvbnMpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5icm9hZGNhc3RlciA9PSAnc29ja2V0LmlvJykge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0b3IgPSBuZXcgU29ja2V0SW9Db25uZWN0b3IodGhpcy5vcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNyZWF0ZUNsYXNzKEVjaG8sIFt7XG4gICAgICAgIGtleTogJ3JlZ2lzdGVyVnVlUmVxdWVzdEludGVyY2VwdG9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyVnVlUmVxdWVzdEludGVyY2VwdG9yKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgVnVlLmh0dHAuaW50ZXJjZXB0b3JzLnB1c2goZnVuY3Rpb24gKHJlcXVlc3QsIG5leHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc29ja2V0SWQoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0LmhlYWRlcnMuc2V0KCdYLVNvY2tldC1JRCcsIF90aGlzLnNvY2tldElkKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVnaXN0ZXJBeGlvc1JlcXVlc3RJbnRlcmNlcHRvcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlckF4aW9zUmVxdWVzdEludGVyY2VwdG9yKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGF4aW9zLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMi5zb2NrZXRJZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzWydYLVNvY2tldC1JZCddID0gX3RoaXMyLnNvY2tldElkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVnaXN0ZXJqUXVlcnlBamF4U2V0dXAnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJqUXVlcnlBamF4U2V0dXAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBqUXVlcnkuYWpheCAhPSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGpRdWVyeS5hamF4U2V0dXAoe1xuICAgICAgICAgICAgICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbiBiZWZvcmVTZW5kKHhocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMy5zb2NrZXRJZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ1gtU29ja2V0LUlkJywgX3RoaXMzLnNvY2tldElkKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xpc3RlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsaXN0ZW4oY2hhbm5lbCwgZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0b3IubGlzdGVuKGNoYW5uZWwsIGV2ZW50LCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2NoYW5uZWwnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2hhbm5lbChfY2hhbm5lbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdG9yLmNoYW5uZWwoX2NoYW5uZWwpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwcml2YXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wcml2YXRlKGNoYW5uZWwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3Rvci5wcml2YXRlQ2hhbm5lbChjaGFubmVsKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnam9pbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luKGNoYW5uZWwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3Rvci5wcmVzZW5jZUNoYW5uZWwoY2hhbm5lbCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xlYXZlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxlYXZlKGNoYW5uZWwpIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdG9yLmxlYXZlKGNoYW5uZWwpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzb2NrZXRJZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzb2NrZXRJZCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3Rvci5zb2NrZXRJZCgpO1xuICAgICAgICB9XG4gICAgfV0pO1xuICAgIHJldHVybiBFY2hvO1xufSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEVjaG87XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2xhcmF2ZWwtZWNoby9kaXN0L2VjaG8uanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 2 */
/***/ function(module, exports, __webpack_require__) {

eval("/*!\n * Pusher JavaScript Library v4.1.0\n * https://pusher.com/\n *\n * Copyright 2017, Pusher\n * Released under the MIT licence.\n */\n\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(true)\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Pusher\"] = factory();\n\telse\n\t\troot[\"Pusher\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar pusher_1 = __webpack_require__(1);\n\tmodule.exports = pusher_1[\"default\"];\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar runtime_1 = __webpack_require__(2);\n\tvar Collections = __webpack_require__(9);\n\tvar dispatcher_1 = __webpack_require__(23);\n\tvar timeline_1 = __webpack_require__(38);\n\tvar level_1 = __webpack_require__(39);\n\tvar StrategyBuilder = __webpack_require__(40);\n\tvar timers_1 = __webpack_require__(12);\n\tvar defaults_1 = __webpack_require__(5);\n\tvar DefaultConfig = __webpack_require__(62);\n\tvar logger_1 = __webpack_require__(8);\n\tvar factory_1 = __webpack_require__(42);\n\tvar Pusher = (function () {\n\t    function Pusher(app_key, options) {\n\t        var _this = this;\n\t        checkAppKey(app_key);\n\t        options = options || {};\n\t        this.key = app_key;\n\t        this.config = Collections.extend(DefaultConfig.getGlobalConfig(), options.cluster ? DefaultConfig.getClusterConfig(options.cluster) : {}, options);\n\t        this.channels = factory_1[\"default\"].createChannels();\n\t        this.global_emitter = new dispatcher_1[\"default\"]();\n\t        this.sessionID = Math.floor(Math.random() * 1000000000);\n\t        this.timeline = new timeline_1[\"default\"](this.key, this.sessionID, {\n\t            cluster: this.config.cluster,\n\t            features: Pusher.getClientFeatures(),\n\t            params: this.config.timelineParams || {},\n\t            limit: 50,\n\t            level: level_1[\"default\"].INFO,\n\t            version: defaults_1[\"default\"].VERSION\n\t        });\n\t        if (!this.config.disableStats) {\n\t            this.timelineSender = factory_1[\"default\"].createTimelineSender(this.timeline, {\n\t                host: this.config.statsHost,\n\t                path: \"/timeline/v2/\" + runtime_1[\"default\"].TimelineTransport.name\n\t            });\n\t        }\n\t        var getStrategy = function (options) {\n\t            var config = Collections.extend({}, _this.config, options);\n\t            return StrategyBuilder.build(runtime_1[\"default\"].getDefaultStrategy(config), config);\n\t        };\n\t        this.connection = factory_1[\"default\"].createConnectionManager(this.key, Collections.extend({ getStrategy: getStrategy,\n\t            timeline: this.timeline,\n\t            activityTimeout: this.config.activity_timeout,\n\t            pongTimeout: this.config.pong_timeout,\n\t            unavailableTimeout: this.config.unavailable_timeout\n\t        }, this.config, { encrypted: this.isEncrypted() }));\n\t        this.connection.bind('connected', function () {\n\t            _this.subscribeAll();\n\t            if (_this.timelineSender) {\n\t                _this.timelineSender.send(_this.connection.isEncrypted());\n\t            }\n\t        });\n\t        this.connection.bind('message', function (params) {\n\t            var internal = (params.event.indexOf('pusher_internal:') === 0);\n\t            if (params.channel) {\n\t                var channel = _this.channel(params.channel);\n\t                if (channel) {\n\t                    channel.handleEvent(params.event, params.data);\n\t                }\n\t            }\n\t            if (!internal) {\n\t                _this.global_emitter.emit(params.event, params.data);\n\t            }\n\t        });\n\t        this.connection.bind('connecting', function () {\n\t            _this.channels.disconnect();\n\t        });\n\t        this.connection.bind('disconnected', function () {\n\t            _this.channels.disconnect();\n\t        });\n\t        this.connection.bind('error', function (err) {\n\t            logger_1[\"default\"].warn('Error', err);\n\t        });\n\t        Pusher.instances.push(this);\n\t        this.timeline.info({ instances: Pusher.instances.length });\n\t        if (Pusher.isReady) {\n\t            this.connect();\n\t        }\n\t    }\n\t    Pusher.ready = function () {\n\t        Pusher.isReady = true;\n\t        for (var i = 0, l = Pusher.instances.length; i < l; i++) {\n\t            Pusher.instances[i].connect();\n\t        }\n\t    };\n\t    Pusher.log = function (message) {\n\t        if (Pusher.logToConsole && (window).console && (window).console.log) {\n\t            (window).console.log(message);\n\t        }\n\t    };\n\t    Pusher.getClientFeatures = function () {\n\t        return Collections.keys(Collections.filterObject({ \"ws\": runtime_1[\"default\"].Transports.ws }, function (t) { return t.isSupported({}); }));\n\t    };\n\t    Pusher.prototype.channel = function (name) {\n\t        return this.channels.find(name);\n\t    };\n\t    Pusher.prototype.allChannels = function () {\n\t        return this.channels.all();\n\t    };\n\t    Pusher.prototype.connect = function () {\n\t        this.connection.connect();\n\t        if (this.timelineSender) {\n\t            if (!this.timelineSenderTimer) {\n\t                var encrypted = this.connection.isEncrypted();\n\t                var timelineSender = this.timelineSender;\n\t                this.timelineSenderTimer = new timers_1.PeriodicTimer(60000, function () {\n\t                    timelineSender.send(encrypted);\n\t                });\n\t            }\n\t        }\n\t    };\n\t    Pusher.prototype.disconnect = function () {\n\t        this.connection.disconnect();\n\t        if (this.timelineSenderTimer) {\n\t            this.timelineSenderTimer.ensureAborted();\n\t            this.timelineSenderTimer = null;\n\t        }\n\t    };\n\t    Pusher.prototype.bind = function (event_name, callback, context) {\n\t        this.global_emitter.bind(event_name, callback, context);\n\t        return this;\n\t    };\n\t    Pusher.prototype.unbind = function (event_name, callback, context) {\n\t        this.global_emitter.unbind(event_name, callback, context);\n\t        return this;\n\t    };\n\t    Pusher.prototype.bind_global = function (callback) {\n\t        this.global_emitter.bind_global(callback);\n\t        return this;\n\t    };\n\t    Pusher.prototype.unbind_global = function (callback) {\n\t        this.global_emitter.unbind_global(callback);\n\t        return this;\n\t    };\n\t    Pusher.prototype.unbind_all = function (callback) {\n\t        this.global_emitter.unbind_all();\n\t        return this;\n\t    };\n\t    Pusher.prototype.subscribeAll = function () {\n\t        var channelName;\n\t        for (channelName in this.channels.channels) {\n\t            if (this.channels.channels.hasOwnProperty(channelName)) {\n\t                this.subscribe(channelName);\n\t            }\n\t        }\n\t    };\n\t    Pusher.prototype.subscribe = function (channel_name) {\n\t        var channel = this.channels.add(channel_name, this);\n\t        if (channel.subscriptionPending && channel.subscriptionCancelled) {\n\t            channel.reinstateSubscription();\n\t        }\n\t        else if (!channel.subscriptionPending && this.connection.state === \"connected\") {\n\t            channel.subscribe();\n\t        }\n\t        return channel;\n\t    };\n\t    Pusher.prototype.unsubscribe = function (channel_name) {\n\t        var channel = this.channels.find(channel_name);\n\t        if (channel && channel.subscriptionPending) {\n\t            channel.cancelSubscription();\n\t        }\n\t        else {\n\t            channel = this.channels.remove(channel_name);\n\t            if (channel && this.connection.state === \"connected\") {\n\t                channel.unsubscribe();\n\t            }\n\t        }\n\t    };\n\t    Pusher.prototype.send_event = function (event_name, data, channel) {\n\t        return this.connection.send_event(event_name, data, channel);\n\t    };\n\t    Pusher.prototype.isEncrypted = function () {\n\t        if (runtime_1[\"default\"].getProtocol() === \"https:\") {\n\t            return true;\n\t        }\n\t        else {\n\t            return Boolean(this.config.encrypted);\n\t        }\n\t    };\n\t    Pusher.instances = [];\n\t    Pusher.isReady = false;\n\t    Pusher.logToConsole = false;\n\t    Pusher.Runtime = runtime_1[\"default\"];\n\t    Pusher.ScriptReceivers = runtime_1[\"default\"].ScriptReceivers;\n\t    Pusher.DependenciesReceivers = runtime_1[\"default\"].DependenciesReceivers;\n\t    Pusher.auth_callbacks = runtime_1[\"default\"].auth_callbacks;\n\t    return Pusher;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = Pusher;\n\tfunction checkAppKey(key) {\n\t    if (key === null || key === undefined) {\n\t        throw \"You must pass your app key when you instantiate Pusher.\";\n\t    }\n\t}\n\truntime_1[\"default\"].setup(Pusher);\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar dependencies_1 = __webpack_require__(3);\n\tvar xhr_auth_1 = __webpack_require__(7);\n\tvar jsonp_auth_1 = __webpack_require__(14);\n\tvar script_request_1 = __webpack_require__(15);\n\tvar jsonp_request_1 = __webpack_require__(16);\n\tvar script_receiver_factory_1 = __webpack_require__(4);\n\tvar jsonp_timeline_1 = __webpack_require__(17);\n\tvar transports_1 = __webpack_require__(18);\n\tvar net_info_1 = __webpack_require__(25);\n\tvar default_strategy_1 = __webpack_require__(26);\n\tvar transport_connection_initializer_1 = __webpack_require__(27);\n\tvar http_1 = __webpack_require__(28);\n\tvar Runtime = {\n\t    nextAuthCallbackID: 1,\n\t    auth_callbacks: {},\n\t    ScriptReceivers: script_receiver_factory_1.ScriptReceivers,\n\t    DependenciesReceivers: dependencies_1.DependenciesReceivers,\n\t    getDefaultStrategy: default_strategy_1[\"default\"],\n\t    Transports: transports_1[\"default\"],\n\t    transportConnectionInitializer: transport_connection_initializer_1[\"default\"],\n\t    HTTPFactory: http_1[\"default\"],\n\t    TimelineTransport: jsonp_timeline_1[\"default\"],\n\t    getXHRAPI: function () {\n\t        return window.XMLHttpRequest;\n\t    },\n\t    getWebSocketAPI: function () {\n\t        return window.WebSocket || window.MozWebSocket;\n\t    },\n\t    setup: function (PusherClass) {\n\t        var _this = this;\n\t        window.Pusher = PusherClass;\n\t        var initializeOnDocumentBody = function () {\n\t            _this.onDocumentBody(PusherClass.ready);\n\t        };\n\t        if (!window.JSON) {\n\t            dependencies_1.Dependencies.load(\"json2\", {}, initializeOnDocumentBody);\n\t        }\n\t        else {\n\t            initializeOnDocumentBody();\n\t        }\n\t    },\n\t    getDocument: function () {\n\t        return document;\n\t    },\n\t    getProtocol: function () {\n\t        return this.getDocument().location.protocol;\n\t    },\n\t    getAuthorizers: function () {\n\t        return { ajax: xhr_auth_1[\"default\"], jsonp: jsonp_auth_1[\"default\"] };\n\t    },\n\t    onDocumentBody: function (callback) {\n\t        var _this = this;\n\t        if (document.body) {\n\t            callback();\n\t        }\n\t        else {\n\t            setTimeout(function () {\n\t                _this.onDocumentBody(callback);\n\t            }, 0);\n\t        }\n\t    },\n\t    createJSONPRequest: function (url, data) {\n\t        return new jsonp_request_1[\"default\"](url, data);\n\t    },\n\t    createScriptRequest: function (src) {\n\t        return new script_request_1[\"default\"](src);\n\t    },\n\t    getLocalStorage: function () {\n\t        try {\n\t            return window.localStorage;\n\t        }\n\t        catch (e) {\n\t            return undefined;\n\t        }\n\t    },\n\t    createXHR: function () {\n\t        if (this.getXHRAPI()) {\n\t            return this.createXMLHttpRequest();\n\t        }\n\t        else {\n\t            return this.createMicrosoftXHR();\n\t        }\n\t    },\n\t    createXMLHttpRequest: function () {\n\t        var Constructor = this.getXHRAPI();\n\t        return new Constructor();\n\t    },\n\t    createMicrosoftXHR: function () {\n\t        return new ActiveXObject(\"Microsoft.XMLHTTP\");\n\t    },\n\t    getNetwork: function () {\n\t        return net_info_1.Network;\n\t    },\n\t    createWebSocket: function (url) {\n\t        var Constructor = this.getWebSocketAPI();\n\t        return new Constructor(url);\n\t    },\n\t    createSocketRequest: function (method, url) {\n\t        if (this.isXHRSupported()) {\n\t            return this.HTTPFactory.createXHR(method, url);\n\t        }\n\t        else if (this.isXDRSupported(url.indexOf(\"https:\") === 0)) {\n\t            return this.HTTPFactory.createXDR(method, url);\n\t        }\n\t        else {\n\t            throw \"Cross-origin HTTP requests are not supported\";\n\t        }\n\t    },\n\t    isXHRSupported: function () {\n\t        var Constructor = this.getXHRAPI();\n\t        return Boolean(Constructor) && (new Constructor()).withCredentials !== undefined;\n\t    },\n\t    isXDRSupported: function (encrypted) {\n\t        var protocol = encrypted ? \"https:\" : \"http:\";\n\t        var documentProtocol = this.getProtocol();\n\t        return Boolean((window['XDomainRequest'])) && documentProtocol === protocol;\n\t    },\n\t    addUnloadListener: function (listener) {\n\t        if (window.addEventListener !== undefined) {\n\t            window.addEventListener(\"unload\", listener, false);\n\t        }\n\t        else if (window.attachEvent !== undefined) {\n\t            window.attachEvent(\"onunload\", listener);\n\t        }\n\t    },\n\t    removeUnloadListener: function (listener) {\n\t        if (window.addEventListener !== undefined) {\n\t            window.removeEventListener(\"unload\", listener, false);\n\t        }\n\t        else if (window.detachEvent !== undefined) {\n\t            window.detachEvent(\"onunload\", listener);\n\t        }\n\t    }\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = Runtime;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar script_receiver_factory_1 = __webpack_require__(4);\n\tvar defaults_1 = __webpack_require__(5);\n\tvar dependency_loader_1 = __webpack_require__(6);\n\texports.DependenciesReceivers = new script_receiver_factory_1.ScriptReceiverFactory(\"_pusher_dependencies\", \"Pusher.DependenciesReceivers\");\n\texports.Dependencies = new dependency_loader_1[\"default\"]({\n\t    cdn_http: defaults_1[\"default\"].cdn_http,\n\t    cdn_https: defaults_1[\"default\"].cdn_https,\n\t    version: defaults_1[\"default\"].VERSION,\n\t    suffix: defaults_1[\"default\"].dependency_suffix,\n\t    receivers: exports.DependenciesReceivers\n\t});\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar ScriptReceiverFactory = (function () {\n\t    function ScriptReceiverFactory(prefix, name) {\n\t        this.lastId = 0;\n\t        this.prefix = prefix;\n\t        this.name = name;\n\t    }\n\t    ScriptReceiverFactory.prototype.create = function (callback) {\n\t        this.lastId++;\n\t        var number = this.lastId;\n\t        var id = this.prefix + number;\n\t        var name = this.name + \"[\" + number + \"]\";\n\t        var called = false;\n\t        var callbackWrapper = function () {\n\t            if (!called) {\n\t                callback.apply(null, arguments);\n\t                called = true;\n\t            }\n\t        };\n\t        this[number] = callbackWrapper;\n\t        return { number: number, id: id, name: name, callback: callbackWrapper };\n\t    };\n\t    ScriptReceiverFactory.prototype.remove = function (receiver) {\n\t        delete this[receiver.number];\n\t    };\n\t    return ScriptReceiverFactory;\n\t}());\n\texports.ScriptReceiverFactory = ScriptReceiverFactory;\n\texports.ScriptReceivers = new ScriptReceiverFactory(\"_pusher_script_\", \"Pusher.ScriptReceivers\");\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar Defaults = {\n\t    VERSION: \"4.1.0\",\n\t    PROTOCOL: 7,\n\t    host: 'ws.pusherapp.com',\n\t    ws_port: 80,\n\t    wss_port: 443,\n\t    sockjs_host: 'sockjs.pusher.com',\n\t    sockjs_http_port: 80,\n\t    sockjs_https_port: 443,\n\t    sockjs_path: \"/pusher\",\n\t    stats_host: 'stats.pusher.com',\n\t    channel_auth_endpoint: '/pusher/auth',\n\t    channel_auth_transport: 'ajax',\n\t    activity_timeout: 120000,\n\t    pong_timeout: 30000,\n\t    unavailable_timeout: 10000,\n\t    cdn_http: 'http://js.pusher.com',\n\t    cdn_https: 'https://js.pusher.com',\n\t    dependency_suffix: ''\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = Defaults;\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar script_receiver_factory_1 = __webpack_require__(4);\n\tvar runtime_1 = __webpack_require__(2);\n\tvar DependencyLoader = (function () {\n\t    function DependencyLoader(options) {\n\t        this.options = options;\n\t        this.receivers = options.receivers || script_receiver_factory_1.ScriptReceivers;\n\t        this.loading = {};\n\t    }\n\t    DependencyLoader.prototype.load = function (name, options, callback) {\n\t        var self = this;\n\t        if (self.loading[name] && self.loading[name].length > 0) {\n\t            self.loading[name].push(callback);\n\t        }\n\t        else {\n\t            self.loading[name] = [callback];\n\t            var request = runtime_1[\"default\"].createScriptRequest(self.getPath(name, options));\n\t            var receiver = self.receivers.create(function (error) {\n\t                self.receivers.remove(receiver);\n\t                if (self.loading[name]) {\n\t                    var callbacks = self.loading[name];\n\t                    delete self.loading[name];\n\t                    var successCallback = function (wasSuccessful) {\n\t                        if (!wasSuccessful) {\n\t                            request.cleanup();\n\t                        }\n\t                    };\n\t                    for (var i = 0; i < callbacks.length; i++) {\n\t                        callbacks[i](error, successCallback);\n\t                    }\n\t                }\n\t            });\n\t            request.send(receiver);\n\t        }\n\t    };\n\t    DependencyLoader.prototype.getRoot = function (options) {\n\t        var cdn;\n\t        var protocol = runtime_1[\"default\"].getDocument().location.protocol;\n\t        if ((options && options.encrypted) || protocol === \"https:\") {\n\t            cdn = this.options.cdn_https;\n\t        }\n\t        else {\n\t            cdn = this.options.cdn_http;\n\t        }\n\t        return cdn.replace(/\\/*$/, \"\") + \"/\" + this.options.version;\n\t    };\n\t    DependencyLoader.prototype.getPath = function (name, options) {\n\t        return this.getRoot(options) + '/' + name + this.options.suffix + '.js';\n\t    };\n\t    ;\n\t    return DependencyLoader;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = DependencyLoader;\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar logger_1 = __webpack_require__(8);\n\tvar runtime_1 = __webpack_require__(2);\n\tvar ajax = function (context, socketId, callback) {\n\t    var self = this, xhr;\n\t    xhr = runtime_1[\"default\"].createXHR();\n\t    xhr.open(\"POST\", self.options.authEndpoint, true);\n\t    xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\t    for (var headerName in this.authOptions.headers) {\n\t        xhr.setRequestHeader(headerName, this.authOptions.headers[headerName]);\n\t    }\n\t    xhr.onreadystatechange = function () {\n\t        if (xhr.readyState === 4) {\n\t            if (xhr.status === 200) {\n\t                var data, parsed = false;\n\t                try {\n\t                    data = JSON.parse(xhr.responseText);\n\t                    parsed = true;\n\t                }\n\t                catch (e) {\n\t                    callback(true, 'JSON returned from webapp was invalid, yet status code was 200. Data was: ' + xhr.responseText);\n\t                }\n\t                if (parsed) {\n\t                    callback(false, data);\n\t                }\n\t            }\n\t            else {\n\t                logger_1[\"default\"].warn(\"Couldn't get auth info from your webapp\", xhr.status);\n\t                callback(true, xhr.status);\n\t            }\n\t        }\n\t    };\n\t    xhr.send(this.composeQuery(socketId));\n\t    return xhr;\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = ajax;\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar collections_1 = __webpack_require__(9);\n\tvar pusher_1 = __webpack_require__(1);\n\tvar Logger = {\n\t    debug: function () {\n\t        var args = [];\n\t        for (var _i = 0; _i < arguments.length; _i++) {\n\t            args[_i - 0] = arguments[_i];\n\t        }\n\t        if (!pusher_1[\"default\"].log) {\n\t            return;\n\t        }\n\t        pusher_1[\"default\"].log(collections_1.stringify.apply(this, arguments));\n\t    },\n\t    warn: function () {\n\t        var args = [];\n\t        for (var _i = 0; _i < arguments.length; _i++) {\n\t            args[_i - 0] = arguments[_i];\n\t        }\n\t        var message = collections_1.stringify.apply(this, arguments);\n\t        if ((window).console) {\n\t            if ((window).console.warn) {\n\t                (window).console.warn(message);\n\t            }\n\t            else if ((window).console.log) {\n\t                (window).console.log(message);\n\t            }\n\t        }\n\t        if (pusher_1[\"default\"].log) {\n\t            pusher_1[\"default\"].log(message);\n\t        }\n\t    }\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = Logger;\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar base64_1 = __webpack_require__(10);\n\tvar util_1 = __webpack_require__(11);\n\tfunction extend(target) {\n\t    var sources = [];\n\t    for (var _i = 1; _i < arguments.length; _i++) {\n\t        sources[_i - 1] = arguments[_i];\n\t    }\n\t    for (var i = 0; i < sources.length; i++) {\n\t        var extensions = sources[i];\n\t        for (var property in extensions) {\n\t            if (extensions[property] && extensions[property].constructor &&\n\t                extensions[property].constructor === Object) {\n\t                target[property] = extend(target[property] || {}, extensions[property]);\n\t            }\n\t            else {\n\t                target[property] = extensions[property];\n\t            }\n\t        }\n\t    }\n\t    return target;\n\t}\n\texports.extend = extend;\n\tfunction stringify() {\n\t    var m = [\"Pusher\"];\n\t    for (var i = 0; i < arguments.length; i++) {\n\t        if (typeof arguments[i] === \"string\") {\n\t            m.push(arguments[i]);\n\t        }\n\t        else {\n\t            m.push(safeJSONStringify(arguments[i]));\n\t        }\n\t    }\n\t    return m.join(\" : \");\n\t}\n\texports.stringify = stringify;\n\tfunction arrayIndexOf(array, item) {\n\t    var nativeIndexOf = Array.prototype.indexOf;\n\t    if (array === null) {\n\t        return -1;\n\t    }\n\t    if (nativeIndexOf && array.indexOf === nativeIndexOf) {\n\t        return array.indexOf(item);\n\t    }\n\t    for (var i = 0, l = array.length; i < l; i++) {\n\t        if (array[i] === item) {\n\t            return i;\n\t        }\n\t    }\n\t    return -1;\n\t}\n\texports.arrayIndexOf = arrayIndexOf;\n\tfunction objectApply(object, f) {\n\t    for (var key in object) {\n\t        if (Object.prototype.hasOwnProperty.call(object, key)) {\n\t            f(object[key], key, object);\n\t        }\n\t    }\n\t}\n\texports.objectApply = objectApply;\n\tfunction keys(object) {\n\t    var keys = [];\n\t    objectApply(object, function (_, key) {\n\t        keys.push(key);\n\t    });\n\t    return keys;\n\t}\n\texports.keys = keys;\n\tfunction values(object) {\n\t    var values = [];\n\t    objectApply(object, function (value) {\n\t        values.push(value);\n\t    });\n\t    return values;\n\t}\n\texports.values = values;\n\tfunction apply(array, f, context) {\n\t    for (var i = 0; i < array.length; i++) {\n\t        f.call(context || (window), array[i], i, array);\n\t    }\n\t}\n\texports.apply = apply;\n\tfunction map(array, f) {\n\t    var result = [];\n\t    for (var i = 0; i < array.length; i++) {\n\t        result.push(f(array[i], i, array, result));\n\t    }\n\t    return result;\n\t}\n\texports.map = map;\n\tfunction mapObject(object, f) {\n\t    var result = {};\n\t    objectApply(object, function (value, key) {\n\t        result[key] = f(value);\n\t    });\n\t    return result;\n\t}\n\texports.mapObject = mapObject;\n\tfunction filter(array, test) {\n\t    test = test || function (value) { return !!value; };\n\t    var result = [];\n\t    for (var i = 0; i < array.length; i++) {\n\t        if (test(array[i], i, array, result)) {\n\t            result.push(array[i]);\n\t        }\n\t    }\n\t    return result;\n\t}\n\texports.filter = filter;\n\tfunction filterObject(object, test) {\n\t    var result = {};\n\t    objectApply(object, function (value, key) {\n\t        if ((test && test(value, key, object, result)) || Boolean(value)) {\n\t            result[key] = value;\n\t        }\n\t    });\n\t    return result;\n\t}\n\texports.filterObject = filterObject;\n\tfunction flatten(object) {\n\t    var result = [];\n\t    objectApply(object, function (value, key) {\n\t        result.push([key, value]);\n\t    });\n\t    return result;\n\t}\n\texports.flatten = flatten;\n\tfunction any(array, test) {\n\t    for (var i = 0; i < array.length; i++) {\n\t        if (test(array[i], i, array)) {\n\t            return true;\n\t        }\n\t    }\n\t    return false;\n\t}\n\texports.any = any;\n\tfunction all(array, test) {\n\t    for (var i = 0; i < array.length; i++) {\n\t        if (!test(array[i], i, array)) {\n\t            return false;\n\t        }\n\t    }\n\t    return true;\n\t}\n\texports.all = all;\n\tfunction encodeParamsObject(data) {\n\t    return mapObject(data, function (value) {\n\t        if (typeof value === \"object\") {\n\t            value = safeJSONStringify(value);\n\t        }\n\t        return encodeURIComponent(base64_1[\"default\"](value.toString()));\n\t    });\n\t}\n\texports.encodeParamsObject = encodeParamsObject;\n\tfunction buildQueryString(data) {\n\t    var params = filterObject(data, function (value) {\n\t        return value !== undefined;\n\t    });\n\t    var query = map(flatten(encodeParamsObject(params)), util_1[\"default\"].method(\"join\", \"=\")).join(\"&\");\n\t    return query;\n\t}\n\texports.buildQueryString = buildQueryString;\n\tfunction decycleObject(object) {\n\t    var objects = [], paths = [];\n\t    return (function derez(value, path) {\n\t        var i, name, nu;\n\t        switch (typeof value) {\n\t            case 'object':\n\t                if (!value) {\n\t                    return null;\n\t                }\n\t                for (i = 0; i < objects.length; i += 1) {\n\t                    if (objects[i] === value) {\n\t                        return { $ref: paths[i] };\n\t                    }\n\t                }\n\t                objects.push(value);\n\t                paths.push(path);\n\t                if (Object.prototype.toString.apply(value) === '[object Array]') {\n\t                    nu = [];\n\t                    for (i = 0; i < value.length; i += 1) {\n\t                        nu[i] = derez(value[i], path + '[' + i + ']');\n\t                    }\n\t                }\n\t                else {\n\t                    nu = {};\n\t                    for (name in value) {\n\t                        if (Object.prototype.hasOwnProperty.call(value, name)) {\n\t                            nu[name] = derez(value[name], path + '[' + JSON.stringify(name) + ']');\n\t                        }\n\t                    }\n\t                }\n\t                return nu;\n\t            case 'number':\n\t            case 'string':\n\t            case 'boolean':\n\t                return value;\n\t        }\n\t    }(object, '$'));\n\t}\n\texports.decycleObject = decycleObject;\n\tfunction safeJSONStringify(source) {\n\t    try {\n\t        return JSON.stringify(source);\n\t    }\n\t    catch (e) {\n\t        return JSON.stringify(decycleObject(source));\n\t    }\n\t}\n\texports.safeJSONStringify = safeJSONStringify;\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tfunction encode(s) {\n\t    return btoa(utob(s));\n\t}\n\texports.__esModule = true;\n\texports[\"default\"] = encode;\n\tvar fromCharCode = String.fromCharCode;\n\tvar b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\tvar b64tab = {};\n\tfor (var i = 0, l = b64chars.length; i < l; i++) {\n\t    b64tab[b64chars.charAt(i)] = i;\n\t}\n\tvar cb_utob = function (c) {\n\t    var cc = c.charCodeAt(0);\n\t    return cc < 0x80 ? c\n\t        : cc < 0x800 ? fromCharCode(0xc0 | (cc >>> 6)) +\n\t            fromCharCode(0x80 | (cc & 0x3f))\n\t            : fromCharCode(0xe0 | ((cc >>> 12) & 0x0f)) +\n\t                fromCharCode(0x80 | ((cc >>> 6) & 0x3f)) +\n\t                fromCharCode(0x80 | (cc & 0x3f));\n\t};\n\tvar utob = function (u) {\n\t    return u.replace(/[^\\x00-\\x7F]/g, cb_utob);\n\t};\n\tvar cb_encode = function (ccc) {\n\t    var padlen = [0, 2, 1][ccc.length % 3];\n\t    var ord = ccc.charCodeAt(0) << 16\n\t        | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\n\t        | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0));\n\t    var chars = [\n\t        b64chars.charAt(ord >>> 18),\n\t        b64chars.charAt((ord >>> 12) & 63),\n\t        padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\n\t        padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\n\t    ];\n\t    return chars.join('');\n\t};\n\tvar btoa = (window).btoa || function (b) {\n\t    return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\n\t};\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar timers_1 = __webpack_require__(12);\n\tvar Util = {\n\t    now: function () {\n\t        if (Date.now) {\n\t            return Date.now();\n\t        }\n\t        else {\n\t            return new Date().valueOf();\n\t        }\n\t    },\n\t    defer: function (callback) {\n\t        return new timers_1.OneOffTimer(0, callback);\n\t    },\n\t    method: function (name) {\n\t        var args = [];\n\t        for (var _i = 1; _i < arguments.length; _i++) {\n\t            args[_i - 1] = arguments[_i];\n\t        }\n\t        var boundArguments = Array.prototype.slice.call(arguments, 1);\n\t        return function (object) {\n\t            return object[name].apply(object, boundArguments.concat(arguments));\n\t        };\n\t    }\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = Util;\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar abstract_timer_1 = __webpack_require__(13);\n\tfunction clearTimeout(timer) {\n\t    (window).clearTimeout(timer);\n\t}\n\tfunction clearInterval(timer) {\n\t    (window).clearInterval(timer);\n\t}\n\tvar OneOffTimer = (function (_super) {\n\t    __extends(OneOffTimer, _super);\n\t    function OneOffTimer(delay, callback) {\n\t        _super.call(this, setTimeout, clearTimeout, delay, function (timer) {\n\t            callback();\n\t            return null;\n\t        });\n\t    }\n\t    return OneOffTimer;\n\t}(abstract_timer_1[\"default\"]));\n\texports.OneOffTimer = OneOffTimer;\n\tvar PeriodicTimer = (function (_super) {\n\t    __extends(PeriodicTimer, _super);\n\t    function PeriodicTimer(delay, callback) {\n\t        _super.call(this, setInterval, clearInterval, delay, function (timer) {\n\t            callback();\n\t            return timer;\n\t        });\n\t    }\n\t    return PeriodicTimer;\n\t}(abstract_timer_1[\"default\"]));\n\texports.PeriodicTimer = PeriodicTimer;\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar Timer = (function () {\n\t    function Timer(set, clear, delay, callback) {\n\t        var _this = this;\n\t        this.clear = clear;\n\t        this.timer = set(function () {\n\t            if (_this.timer) {\n\t                _this.timer = callback(_this.timer);\n\t            }\n\t        }, delay);\n\t    }\n\t    Timer.prototype.isRunning = function () {\n\t        return this.timer !== null;\n\t    };\n\t    Timer.prototype.ensureAborted = function () {\n\t        if (this.timer) {\n\t            this.clear(this.timer);\n\t            this.timer = null;\n\t        }\n\t    };\n\t    return Timer;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = Timer;\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar logger_1 = __webpack_require__(8);\n\tvar jsonp = function (context, socketId, callback) {\n\t    if (this.authOptions.headers !== undefined) {\n\t        logger_1[\"default\"].warn(\"Warn\", \"To send headers with the auth request, you must use AJAX, rather than JSONP.\");\n\t    }\n\t    var callbackName = context.nextAuthCallbackID.toString();\n\t    context.nextAuthCallbackID++;\n\t    var document = context.getDocument();\n\t    var script = document.createElement(\"script\");\n\t    context.auth_callbacks[callbackName] = function (data) {\n\t        callback(false, data);\n\t    };\n\t    var callback_name = \"Pusher.auth_callbacks['\" + callbackName + \"']\";\n\t    script.src = this.options.authEndpoint +\n\t        '?callback=' +\n\t        encodeURIComponent(callback_name) +\n\t        '&' +\n\t        this.composeQuery(socketId);\n\t    var head = document.getElementsByTagName(\"head\")[0] || document.documentElement;\n\t    head.insertBefore(script, head.firstChild);\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = jsonp;\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar ScriptRequest = (function () {\n\t    function ScriptRequest(src) {\n\t        this.src = src;\n\t    }\n\t    ScriptRequest.prototype.send = function (receiver) {\n\t        var self = this;\n\t        var errorString = \"Error loading \" + self.src;\n\t        self.script = document.createElement(\"script\");\n\t        self.script.id = receiver.id;\n\t        self.script.src = self.src;\n\t        self.script.type = \"text/javascript\";\n\t        self.script.charset = \"UTF-8\";\n\t        if (self.script.addEventListener) {\n\t            self.script.onerror = function () {\n\t                receiver.callback(errorString);\n\t            };\n\t            self.script.onload = function () {\n\t                receiver.callback(null);\n\t            };\n\t        }\n\t        else {\n\t            self.script.onreadystatechange = function () {\n\t                if (self.script.readyState === 'loaded' ||\n\t                    self.script.readyState === 'complete') {\n\t                    receiver.callback(null);\n\t                }\n\t            };\n\t        }\n\t        if (self.script.async === undefined && document.attachEvent &&\n\t            /opera/i.test(navigator.userAgent)) {\n\t            self.errorScript = document.createElement(\"script\");\n\t            self.errorScript.id = receiver.id + \"_error\";\n\t            self.errorScript.text = receiver.name + \"('\" + errorString + \"');\";\n\t            self.script.async = self.errorScript.async = false;\n\t        }\n\t        else {\n\t            self.script.async = true;\n\t        }\n\t        var head = document.getElementsByTagName('head')[0];\n\t        head.insertBefore(self.script, head.firstChild);\n\t        if (self.errorScript) {\n\t            head.insertBefore(self.errorScript, self.script.nextSibling);\n\t        }\n\t    };\n\t    ScriptRequest.prototype.cleanup = function () {\n\t        if (this.script) {\n\t            this.script.onload = this.script.onerror = null;\n\t            this.script.onreadystatechange = null;\n\t        }\n\t        if (this.script && this.script.parentNode) {\n\t            this.script.parentNode.removeChild(this.script);\n\t        }\n\t        if (this.errorScript && this.errorScript.parentNode) {\n\t            this.errorScript.parentNode.removeChild(this.errorScript);\n\t        }\n\t        this.script = null;\n\t        this.errorScript = null;\n\t    };\n\t    return ScriptRequest;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = ScriptRequest;\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Collections = __webpack_require__(9);\n\tvar runtime_1 = __webpack_require__(2);\n\tvar JSONPRequest = (function () {\n\t    function JSONPRequest(url, data) {\n\t        this.url = url;\n\t        this.data = data;\n\t    }\n\t    JSONPRequest.prototype.send = function (receiver) {\n\t        if (this.request) {\n\t            return;\n\t        }\n\t        var query = Collections.buildQueryString(this.data);\n\t        var url = this.url + \"/\" + receiver.number + \"?\" + query;\n\t        this.request = runtime_1[\"default\"].createScriptRequest(url);\n\t        this.request.send(receiver);\n\t    };\n\t    JSONPRequest.prototype.cleanup = function () {\n\t        if (this.request) {\n\t            this.request.cleanup();\n\t        }\n\t    };\n\t    return JSONPRequest;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = JSONPRequest;\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar runtime_1 = __webpack_require__(2);\n\tvar script_receiver_factory_1 = __webpack_require__(4);\n\tvar getAgent = function (sender, encrypted) {\n\t    return function (data, callback) {\n\t        var scheme = \"http\" + (encrypted ? \"s\" : \"\") + \"://\";\n\t        var url = scheme + (sender.host || sender.options.host) + sender.options.path;\n\t        var request = runtime_1[\"default\"].createJSONPRequest(url, data);\n\t        var receiver = runtime_1[\"default\"].ScriptReceivers.create(function (error, result) {\n\t            script_receiver_factory_1.ScriptReceivers.remove(receiver);\n\t            request.cleanup();\n\t            if (result && result.host) {\n\t                sender.host = result.host;\n\t            }\n\t            if (callback) {\n\t                callback(error, result);\n\t            }\n\t        });\n\t        request.send(receiver);\n\t    };\n\t};\n\tvar jsonp = {\n\t    name: 'jsonp',\n\t    getAgent: getAgent\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = jsonp;\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar transports_1 = __webpack_require__(19);\n\tvar transport_1 = __webpack_require__(21);\n\tvar URLSchemes = __webpack_require__(20);\n\tvar runtime_1 = __webpack_require__(2);\n\tvar dependencies_1 = __webpack_require__(3);\n\tvar Collections = __webpack_require__(9);\n\tvar SockJSTransport = new transport_1[\"default\"]({\n\t    file: \"sockjs\",\n\t    urls: URLSchemes.sockjs,\n\t    handlesActivityChecks: true,\n\t    supportsPing: false,\n\t    isSupported: function () {\n\t        return true;\n\t    },\n\t    isInitialized: function () {\n\t        return window.SockJS !== undefined;\n\t    },\n\t    getSocket: function (url, options) {\n\t        return new window.SockJS(url, null, {\n\t            js_path: dependencies_1.Dependencies.getPath(\"sockjs\", {\n\t                encrypted: options.encrypted\n\t            }),\n\t            ignore_null_origin: options.ignoreNullOrigin\n\t        });\n\t    },\n\t    beforeOpen: function (socket, path) {\n\t        socket.send(JSON.stringify({\n\t            path: path\n\t        }));\n\t    }\n\t});\n\tvar xdrConfiguration = {\n\t    isSupported: function (environment) {\n\t        var yes = runtime_1[\"default\"].isXDRSupported(environment.encrypted);\n\t        return yes;\n\t    }\n\t};\n\tvar XDRStreamingTransport = new transport_1[\"default\"](Collections.extend({}, transports_1.streamingConfiguration, xdrConfiguration));\n\tvar XDRPollingTransport = new transport_1[\"default\"](Collections.extend({}, transports_1.pollingConfiguration, xdrConfiguration));\n\ttransports_1[\"default\"].xdr_streaming = XDRStreamingTransport;\n\ttransports_1[\"default\"].xdr_polling = XDRPollingTransport;\n\ttransports_1[\"default\"].sockjs = SockJSTransport;\n\texports.__esModule = true;\n\texports[\"default\"] = transports_1[\"default\"];\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar URLSchemes = __webpack_require__(20);\n\tvar transport_1 = __webpack_require__(21);\n\tvar Collections = __webpack_require__(9);\n\tvar runtime_1 = __webpack_require__(2);\n\tvar WSTransport = new transport_1[\"default\"]({\n\t    urls: URLSchemes.ws,\n\t    handlesActivityChecks: false,\n\t    supportsPing: false,\n\t    isInitialized: function () {\n\t        return Boolean(runtime_1[\"default\"].getWebSocketAPI());\n\t    },\n\t    isSupported: function () {\n\t        return Boolean(runtime_1[\"default\"].getWebSocketAPI());\n\t    },\n\t    getSocket: function (url) {\n\t        return runtime_1[\"default\"].createWebSocket(url);\n\t    }\n\t});\n\tvar httpConfiguration = {\n\t    urls: URLSchemes.http,\n\t    handlesActivityChecks: false,\n\t    supportsPing: true,\n\t    isInitialized: function () {\n\t        return true;\n\t    }\n\t};\n\texports.streamingConfiguration = Collections.extend({ getSocket: function (url) {\n\t        return runtime_1[\"default\"].HTTPFactory.createStreamingSocket(url);\n\t    }\n\t}, httpConfiguration);\n\texports.pollingConfiguration = Collections.extend({ getSocket: function (url) {\n\t        return runtime_1[\"default\"].HTTPFactory.createPollingSocket(url);\n\t    }\n\t}, httpConfiguration);\n\tvar xhrConfiguration = {\n\t    isSupported: function () {\n\t        return runtime_1[\"default\"].isXHRSupported();\n\t    }\n\t};\n\tvar XHRStreamingTransport = new transport_1[\"default\"](Collections.extend({}, exports.streamingConfiguration, xhrConfiguration));\n\tvar XHRPollingTransport = new transport_1[\"default\"](Collections.extend({}, exports.pollingConfiguration, xhrConfiguration));\n\tvar Transports = {\n\t    ws: WSTransport,\n\t    xhr_streaming: XHRStreamingTransport,\n\t    xhr_polling: XHRPollingTransport\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = Transports;\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar defaults_1 = __webpack_require__(5);\n\tfunction getGenericURL(baseScheme, params, path) {\n\t    var scheme = baseScheme + (params.encrypted ? \"s\" : \"\");\n\t    var host = params.encrypted ? params.hostEncrypted : params.hostUnencrypted;\n\t    return scheme + \"://\" + host + path;\n\t}\n\tfunction getGenericPath(key, queryString) {\n\t    var path = \"/app/\" + key;\n\t    var query = \"?protocol=\" + defaults_1[\"default\"].PROTOCOL +\n\t        \"&client=js\" +\n\t        \"&version=\" + defaults_1[\"default\"].VERSION +\n\t        (queryString ? (\"&\" + queryString) : \"\");\n\t    return path + query;\n\t}\n\texports.ws = {\n\t    getInitial: function (key, params) {\n\t        return getGenericURL(\"ws\", params, getGenericPath(key, \"flash=false\"));\n\t    }\n\t};\n\texports.http = {\n\t    getInitial: function (key, params) {\n\t        var path = (params.httpPath || \"/pusher\") + getGenericPath(key);\n\t        return getGenericURL(\"http\", params, path);\n\t    }\n\t};\n\texports.sockjs = {\n\t    getInitial: function (key, params) {\n\t        return getGenericURL(\"http\", params, params.httpPath || \"/pusher\");\n\t    },\n\t    getPath: function (key, params) {\n\t        return getGenericPath(key);\n\t    }\n\t};\n\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar transport_connection_1 = __webpack_require__(22);\n\tvar Transport = (function () {\n\t    function Transport(hooks) {\n\t        this.hooks = hooks;\n\t    }\n\t    Transport.prototype.isSupported = function (environment) {\n\t        return this.hooks.isSupported(environment);\n\t    };\n\t    Transport.prototype.createConnection = function (name, priority, key, options) {\n\t        return new transport_connection_1[\"default\"](this.hooks, name, priority, key, options);\n\t    };\n\t    return Transport;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = Transport;\n\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar util_1 = __webpack_require__(11);\n\tvar Collections = __webpack_require__(9);\n\tvar dispatcher_1 = __webpack_require__(23);\n\tvar logger_1 = __webpack_require__(8);\n\tvar runtime_1 = __webpack_require__(2);\n\tvar TransportConnection = (function (_super) {\n\t    __extends(TransportConnection, _super);\n\t    function TransportConnection(hooks, name, priority, key, options) {\n\t        _super.call(this);\n\t        this.initialize = runtime_1[\"default\"].transportConnectionInitializer;\n\t        this.hooks = hooks;\n\t        this.name = name;\n\t        this.priority = priority;\n\t        this.key = key;\n\t        this.options = options;\n\t        this.state = \"new\";\n\t        this.timeline = options.timeline;\n\t        this.activityTimeout = options.activityTimeout;\n\t        this.id = this.timeline.generateUniqueID();\n\t    }\n\t    TransportConnection.prototype.handlesActivityChecks = function () {\n\t        return Boolean(this.hooks.handlesActivityChecks);\n\t    };\n\t    TransportConnection.prototype.supportsPing = function () {\n\t        return Boolean(this.hooks.supportsPing);\n\t    };\n\t    TransportConnection.prototype.connect = function () {\n\t        var _this = this;\n\t        if (this.socket || this.state !== \"initialized\") {\n\t            return false;\n\t        }\n\t        var url = this.hooks.urls.getInitial(this.key, this.options);\n\t        try {\n\t            this.socket = this.hooks.getSocket(url, this.options);\n\t        }\n\t        catch (e) {\n\t            util_1[\"default\"].defer(function () {\n\t                _this.onError(e);\n\t                _this.changeState(\"closed\");\n\t            });\n\t            return false;\n\t        }\n\t        this.bindListeners();\n\t        logger_1[\"default\"].debug(\"Connecting\", { transport: this.name, url: url });\n\t        this.changeState(\"connecting\");\n\t        return true;\n\t    };\n\t    TransportConnection.prototype.close = function () {\n\t        if (this.socket) {\n\t            this.socket.close();\n\t            return true;\n\t        }\n\t        else {\n\t            return false;\n\t        }\n\t    };\n\t    TransportConnection.prototype.send = function (data) {\n\t        var _this = this;\n\t        if (this.state === \"open\") {\n\t            util_1[\"default\"].defer(function () {\n\t                if (_this.socket) {\n\t                    _this.socket.send(data);\n\t                }\n\t            });\n\t            return true;\n\t        }\n\t        else {\n\t            return false;\n\t        }\n\t    };\n\t    TransportConnection.prototype.ping = function () {\n\t        if (this.state === \"open\" && this.supportsPing()) {\n\t            this.socket.ping();\n\t        }\n\t    };\n\t    TransportConnection.prototype.onOpen = function () {\n\t        if (this.hooks.beforeOpen) {\n\t            this.hooks.beforeOpen(this.socket, this.hooks.urls.getPath(this.key, this.options));\n\t        }\n\t        this.changeState(\"open\");\n\t        this.socket.onopen = undefined;\n\t    };\n\t    TransportConnection.prototype.onError = function (error) {\n\t        this.emit(\"error\", { type: 'WebSocketError', error: error });\n\t        this.timeline.error(this.buildTimelineMessage({ error: error.toString() }));\n\t    };\n\t    TransportConnection.prototype.onClose = function (closeEvent) {\n\t        if (closeEvent) {\n\t            this.changeState(\"closed\", {\n\t                code: closeEvent.code,\n\t                reason: closeEvent.reason,\n\t                wasClean: closeEvent.wasClean\n\t            });\n\t        }\n\t        else {\n\t            this.changeState(\"closed\");\n\t        }\n\t        this.unbindListeners();\n\t        this.socket = undefined;\n\t    };\n\t    TransportConnection.prototype.onMessage = function (message) {\n\t        this.emit(\"message\", message);\n\t    };\n\t    TransportConnection.prototype.onActivity = function () {\n\t        this.emit(\"activity\");\n\t    };\n\t    TransportConnection.prototype.bindListeners = function () {\n\t        var _this = this;\n\t        this.socket.onopen = function () {\n\t            _this.onOpen();\n\t        };\n\t        this.socket.onerror = function (error) {\n\t            _this.onError(error);\n\t        };\n\t        this.socket.onclose = function (closeEvent) {\n\t            _this.onClose(closeEvent);\n\t        };\n\t        this.socket.onmessage = function (message) {\n\t            _this.onMessage(message);\n\t        };\n\t        if (this.supportsPing()) {\n\t            this.socket.onactivity = function () { _this.onActivity(); };\n\t        }\n\t    };\n\t    TransportConnection.prototype.unbindListeners = function () {\n\t        if (this.socket) {\n\t            this.socket.onopen = undefined;\n\t            this.socket.onerror = undefined;\n\t            this.socket.onclose = undefined;\n\t            this.socket.onmessage = undefined;\n\t            if (this.supportsPing()) {\n\t                this.socket.onactivity = undefined;\n\t            }\n\t        }\n\t    };\n\t    TransportConnection.prototype.changeState = function (state, params) {\n\t        this.state = state;\n\t        this.timeline.info(this.buildTimelineMessage({\n\t            state: state,\n\t            params: params\n\t        }));\n\t        this.emit(state, params);\n\t    };\n\t    TransportConnection.prototype.buildTimelineMessage = function (message) {\n\t        return Collections.extend({ cid: this.id }, message);\n\t    };\n\t    return TransportConnection;\n\t}(dispatcher_1[\"default\"]));\n\texports.__esModule = true;\n\texports[\"default\"] = TransportConnection;\n\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Collections = __webpack_require__(9);\n\tvar callback_registry_1 = __webpack_require__(24);\n\tvar Dispatcher = (function () {\n\t    function Dispatcher(failThrough) {\n\t        this.callbacks = new callback_registry_1[\"default\"]();\n\t        this.global_callbacks = [];\n\t        this.failThrough = failThrough;\n\t    }\n\t    Dispatcher.prototype.bind = function (eventName, callback, context) {\n\t        this.callbacks.add(eventName, callback, context);\n\t        return this;\n\t    };\n\t    Dispatcher.prototype.bind_global = function (callback) {\n\t        this.global_callbacks.push(callback);\n\t        return this;\n\t    };\n\t    Dispatcher.prototype.unbind = function (eventName, callback, context) {\n\t        this.callbacks.remove(eventName, callback, context);\n\t        return this;\n\t    };\n\t    Dispatcher.prototype.unbind_global = function (callback) {\n\t        if (!callback) {\n\t            this.global_callbacks = [];\n\t            return this;\n\t        }\n\t        this.global_callbacks = Collections.filter(this.global_callbacks || [], function (c) { return c !== callback; });\n\t        return this;\n\t    };\n\t    Dispatcher.prototype.unbind_all = function () {\n\t        this.unbind();\n\t        this.unbind_global();\n\t        return this;\n\t    };\n\t    Dispatcher.prototype.emit = function (eventName, data) {\n\t        var i;\n\t        for (i = 0; i < this.global_callbacks.length; i++) {\n\t            this.global_callbacks[i](eventName, data);\n\t        }\n\t        var callbacks = this.callbacks.get(eventName);\n\t        if (callbacks && callbacks.length > 0) {\n\t            for (i = 0; i < callbacks.length; i++) {\n\t                callbacks[i].fn.call(callbacks[i].context || (window), data);\n\t            }\n\t        }\n\t        else if (this.failThrough) {\n\t            this.failThrough(eventName, data);\n\t        }\n\t        return this;\n\t    };\n\t    return Dispatcher;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = Dispatcher;\n\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Collections = __webpack_require__(9);\n\tvar CallbackRegistry = (function () {\n\t    function CallbackRegistry() {\n\t        this._callbacks = {};\n\t    }\n\t    CallbackRegistry.prototype.get = function (name) {\n\t        return this._callbacks[prefix(name)];\n\t    };\n\t    CallbackRegistry.prototype.add = function (name, callback, context) {\n\t        var prefixedEventName = prefix(name);\n\t        this._callbacks[prefixedEventName] = this._callbacks[prefixedEventName] || [];\n\t        this._callbacks[prefixedEventName].push({\n\t            fn: callback,\n\t            context: context\n\t        });\n\t    };\n\t    CallbackRegistry.prototype.remove = function (name, callback, context) {\n\t        if (!name && !callback && !context) {\n\t            this._callbacks = {};\n\t            return;\n\t        }\n\t        var names = name ? [prefix(name)] : Collections.keys(this._callbacks);\n\t        if (callback || context) {\n\t            this.removeCallback(names, callback, context);\n\t        }\n\t        else {\n\t            this.removeAllCallbacks(names);\n\t        }\n\t    };\n\t    CallbackRegistry.prototype.removeCallback = function (names, callback, context) {\n\t        Collections.apply(names, function (name) {\n\t            this._callbacks[name] = Collections.filter(this._callbacks[name] || [], function (binding) {\n\t                return (callback && callback !== binding.fn) ||\n\t                    (context && context !== binding.context);\n\t            });\n\t            if (this._callbacks[name].length === 0) {\n\t                delete this._callbacks[name];\n\t            }\n\t        }, this);\n\t    };\n\t    CallbackRegistry.prototype.removeAllCallbacks = function (names) {\n\t        Collections.apply(names, function (name) {\n\t            delete this._callbacks[name];\n\t        }, this);\n\t    };\n\t    return CallbackRegistry;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = CallbackRegistry;\n\tfunction prefix(name) {\n\t    return \"_\" + name;\n\t}\n\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar dispatcher_1 = __webpack_require__(23);\n\tvar NetInfo = (function (_super) {\n\t    __extends(NetInfo, _super);\n\t    function NetInfo() {\n\t        _super.call(this);\n\t        var self = this;\n\t        if (window.addEventListener !== undefined) {\n\t            window.addEventListener(\"online\", function () {\n\t                self.emit('online');\n\t            }, false);\n\t            window.addEventListener(\"offline\", function () {\n\t                self.emit('offline');\n\t            }, false);\n\t        }\n\t    }\n\t    NetInfo.prototype.isOnline = function () {\n\t        if (window.navigator.onLine === undefined) {\n\t            return true;\n\t        }\n\t        else {\n\t            return window.navigator.onLine;\n\t        }\n\t    };\n\t    return NetInfo;\n\t}(dispatcher_1[\"default\"]));\n\texports.NetInfo = NetInfo;\n\texports.Network = new NetInfo();\n\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar getDefaultStrategy = function (config) {\n\t    var wsStrategy;\n\t    if (config.encrypted) {\n\t        wsStrategy = [\n\t            \":best_connected_ever\",\n\t            \":ws_loop\",\n\t            [\":delayed\", 2000, [\":http_fallback_loop\"]]\n\t        ];\n\t    }\n\t    else {\n\t        wsStrategy = [\n\t            \":best_connected_ever\",\n\t            \":ws_loop\",\n\t            [\":delayed\", 2000, [\":wss_loop\"]],\n\t            [\":delayed\", 5000, [\":http_fallback_loop\"]]\n\t        ];\n\t    }\n\t    return [\n\t        [\":def\", \"ws_options\", {\n\t                hostUnencrypted: config.wsHost + \":\" + config.wsPort,\n\t                hostEncrypted: config.wsHost + \":\" + config.wssPort\n\t            }],\n\t        [\":def\", \"wss_options\", [\":extend\", \":ws_options\", {\n\t                    encrypted: true\n\t                }]],\n\t        [\":def\", \"sockjs_options\", {\n\t                hostUnencrypted: config.httpHost + \":\" + config.httpPort,\n\t                hostEncrypted: config.httpHost + \":\" + config.httpsPort,\n\t                httpPath: config.httpPath\n\t            }],\n\t        [\":def\", \"timeouts\", {\n\t                loop: true,\n\t                timeout: 15000,\n\t                timeoutLimit: 60000\n\t            }],\n\t        [\":def\", \"ws_manager\", [\":transport_manager\", {\n\t                    lives: 2,\n\t                    minPingDelay: 10000,\n\t                    maxPingDelay: config.activity_timeout\n\t                }]],\n\t        [\":def\", \"streaming_manager\", [\":transport_manager\", {\n\t                    lives: 2,\n\t                    minPingDelay: 10000,\n\t                    maxPingDelay: config.activity_timeout\n\t                }]],\n\t        [\":def_transport\", \"ws\", \"ws\", 3, \":ws_options\", \":ws_manager\"],\n\t        [\":def_transport\", \"wss\", \"ws\", 3, \":wss_options\", \":ws_manager\"],\n\t        [\":def_transport\", \"sockjs\", \"sockjs\", 1, \":sockjs_options\"],\n\t        [\":def_transport\", \"xhr_streaming\", \"xhr_streaming\", 1, \":sockjs_options\", \":streaming_manager\"],\n\t        [\":def_transport\", \"xdr_streaming\", \"xdr_streaming\", 1, \":sockjs_options\", \":streaming_manager\"],\n\t        [\":def_transport\", \"xhr_polling\", \"xhr_polling\", 1, \":sockjs_options\"],\n\t        [\":def_transport\", \"xdr_polling\", \"xdr_polling\", 1, \":sockjs_options\"],\n\t        [\":def\", \"ws_loop\", [\":sequential\", \":timeouts\", \":ws\"]],\n\t        [\":def\", \"wss_loop\", [\":sequential\", \":timeouts\", \":wss\"]],\n\t        [\":def\", \"sockjs_loop\", [\":sequential\", \":timeouts\", \":sockjs\"]],\n\t        [\":def\", \"streaming_loop\", [\":sequential\", \":timeouts\",\n\t                [\":if\", [\":is_supported\", \":xhr_streaming\"],\n\t                    \":xhr_streaming\",\n\t                    \":xdr_streaming\"\n\t                ]\n\t            ]],\n\t        [\":def\", \"polling_loop\", [\":sequential\", \":timeouts\",\n\t                [\":if\", [\":is_supported\", \":xhr_polling\"],\n\t                    \":xhr_polling\",\n\t                    \":xdr_polling\"\n\t                ]\n\t            ]],\n\t        [\":def\", \"http_loop\", [\":if\", [\":is_supported\", \":streaming_loop\"], [\n\t                    \":best_connected_ever\",\n\t                    \":streaming_loop\",\n\t                    [\":delayed\", 4000, [\":polling_loop\"]]\n\t                ], [\n\t                    \":polling_loop\"\n\t                ]]],\n\t        [\":def\", \"http_fallback_loop\",\n\t            [\":if\", [\":is_supported\", \":http_loop\"], [\n\t                    \":http_loop\"\n\t                ], [\n\t                    \":sockjs_loop\"\n\t                ]]\n\t        ],\n\t        [\":def\", \"strategy\",\n\t            [\":cached\", 1800000,\n\t                [\":first_connected\",\n\t                    [\":if\", [\":is_supported\", \":ws\"],\n\t                        wsStrategy,\n\t                        \":http_fallback_loop\"\n\t                    ]\n\t                ]\n\t            ]\n\t        ]\n\t    ];\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = getDefaultStrategy;\n\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar dependencies_1 = __webpack_require__(3);\n\tfunction default_1() {\n\t    var self = this;\n\t    self.timeline.info(self.buildTimelineMessage({\n\t        transport: self.name + (self.options.encrypted ? \"s\" : \"\")\n\t    }));\n\t    if (self.hooks.isInitialized()) {\n\t        self.changeState(\"initialized\");\n\t    }\n\t    else if (self.hooks.file) {\n\t        self.changeState(\"initializing\");\n\t        dependencies_1.Dependencies.load(self.hooks.file, { encrypted: self.options.encrypted }, function (error, callback) {\n\t            if (self.hooks.isInitialized()) {\n\t                self.changeState(\"initialized\");\n\t                callback(true);\n\t            }\n\t            else {\n\t                if (error) {\n\t                    self.onError(error);\n\t                }\n\t                self.onClose();\n\t                callback(false);\n\t            }\n\t        });\n\t    }\n\t    else {\n\t        self.onClose();\n\t    }\n\t}\n\texports.__esModule = true;\n\texports[\"default\"] = default_1;\n\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar http_xdomain_request_1 = __webpack_require__(29);\n\tvar http_1 = __webpack_require__(31);\n\thttp_1[\"default\"].createXDR = function (method, url) {\n\t    return this.createRequest(http_xdomain_request_1[\"default\"], method, url);\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = http_1[\"default\"];\n\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Errors = __webpack_require__(30);\n\tvar hooks = {\n\t    getRequest: function (socket) {\n\t        var xdr = new window.XDomainRequest();\n\t        xdr.ontimeout = function () {\n\t            socket.emit(\"error\", new Errors.RequestTimedOut());\n\t            socket.close();\n\t        };\n\t        xdr.onerror = function (e) {\n\t            socket.emit(\"error\", e);\n\t            socket.close();\n\t        };\n\t        xdr.onprogress = function () {\n\t            if (xdr.responseText && xdr.responseText.length > 0) {\n\t                socket.onChunk(200, xdr.responseText);\n\t            }\n\t        };\n\t        xdr.onload = function () {\n\t            if (xdr.responseText && xdr.responseText.length > 0) {\n\t                socket.onChunk(200, xdr.responseText);\n\t            }\n\t            socket.emit(\"finished\", 200);\n\t            socket.close();\n\t        };\n\t        return xdr;\n\t    },\n\t    abortRequest: function (xdr) {\n\t        xdr.ontimeout = xdr.onerror = xdr.onprogress = xdr.onload = null;\n\t        xdr.abort();\n\t    }\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = hooks;\n\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar BadEventName = (function (_super) {\n\t    __extends(BadEventName, _super);\n\t    function BadEventName() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return BadEventName;\n\t}(Error));\n\texports.BadEventName = BadEventName;\n\tvar RequestTimedOut = (function (_super) {\n\t    __extends(RequestTimedOut, _super);\n\t    function RequestTimedOut() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return RequestTimedOut;\n\t}(Error));\n\texports.RequestTimedOut = RequestTimedOut;\n\tvar TransportPriorityTooLow = (function (_super) {\n\t    __extends(TransportPriorityTooLow, _super);\n\t    function TransportPriorityTooLow() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return TransportPriorityTooLow;\n\t}(Error));\n\texports.TransportPriorityTooLow = TransportPriorityTooLow;\n\tvar TransportClosed = (function (_super) {\n\t    __extends(TransportClosed, _super);\n\t    function TransportClosed() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return TransportClosed;\n\t}(Error));\n\texports.TransportClosed = TransportClosed;\n\tvar UnsupportedTransport = (function (_super) {\n\t    __extends(UnsupportedTransport, _super);\n\t    function UnsupportedTransport() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return UnsupportedTransport;\n\t}(Error));\n\texports.UnsupportedTransport = UnsupportedTransport;\n\tvar UnsupportedStrategy = (function (_super) {\n\t    __extends(UnsupportedStrategy, _super);\n\t    function UnsupportedStrategy() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return UnsupportedStrategy;\n\t}(Error));\n\texports.UnsupportedStrategy = UnsupportedStrategy;\n\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar http_request_1 = __webpack_require__(32);\n\tvar http_socket_1 = __webpack_require__(33);\n\tvar http_streaming_socket_1 = __webpack_require__(35);\n\tvar http_polling_socket_1 = __webpack_require__(36);\n\tvar http_xhr_request_1 = __webpack_require__(37);\n\tvar HTTP = {\n\t    createStreamingSocket: function (url) {\n\t        return this.createSocket(http_streaming_socket_1[\"default\"], url);\n\t    },\n\t    createPollingSocket: function (url) {\n\t        return this.createSocket(http_polling_socket_1[\"default\"], url);\n\t    },\n\t    createSocket: function (hooks, url) {\n\t        return new http_socket_1[\"default\"](hooks, url);\n\t    },\n\t    createXHR: function (method, url) {\n\t        return this.createRequest(http_xhr_request_1[\"default\"], method, url);\n\t    },\n\t    createRequest: function (hooks, method, url) {\n\t        return new http_request_1[\"default\"](hooks, method, url);\n\t    }\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = HTTP;\n\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar runtime_1 = __webpack_require__(2);\n\tvar dispatcher_1 = __webpack_require__(23);\n\tvar MAX_BUFFER_LENGTH = 256 * 1024;\n\tvar HTTPRequest = (function (_super) {\n\t    __extends(HTTPRequest, _super);\n\t    function HTTPRequest(hooks, method, url) {\n\t        _super.call(this);\n\t        this.hooks = hooks;\n\t        this.method = method;\n\t        this.url = url;\n\t    }\n\t    HTTPRequest.prototype.start = function (payload) {\n\t        var _this = this;\n\t        this.position = 0;\n\t        this.xhr = this.hooks.getRequest(this);\n\t        this.unloader = function () {\n\t            _this.close();\n\t        };\n\t        runtime_1[\"default\"].addUnloadListener(this.unloader);\n\t        this.xhr.open(this.method, this.url, true);\n\t        if (this.xhr.setRequestHeader) {\n\t            this.xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n\t        }\n\t        this.xhr.send(payload);\n\t    };\n\t    HTTPRequest.prototype.close = function () {\n\t        if (this.unloader) {\n\t            runtime_1[\"default\"].removeUnloadListener(this.unloader);\n\t            this.unloader = null;\n\t        }\n\t        if (this.xhr) {\n\t            this.hooks.abortRequest(this.xhr);\n\t            this.xhr = null;\n\t        }\n\t    };\n\t    HTTPRequest.prototype.onChunk = function (status, data) {\n\t        while (true) {\n\t            var chunk = this.advanceBuffer(data);\n\t            if (chunk) {\n\t                this.emit(\"chunk\", { status: status, data: chunk });\n\t            }\n\t            else {\n\t                break;\n\t            }\n\t        }\n\t        if (this.isBufferTooLong(data)) {\n\t            this.emit(\"buffer_too_long\");\n\t        }\n\t    };\n\t    HTTPRequest.prototype.advanceBuffer = function (buffer) {\n\t        var unreadData = buffer.slice(this.position);\n\t        var endOfLinePosition = unreadData.indexOf(\"\\n\");\n\t        if (endOfLinePosition !== -1) {\n\t            this.position += endOfLinePosition + 1;\n\t            return unreadData.slice(0, endOfLinePosition);\n\t        }\n\t        else {\n\t            return null;\n\t        }\n\t    };\n\t    HTTPRequest.prototype.isBufferTooLong = function (buffer) {\n\t        return this.position === buffer.length && buffer.length > MAX_BUFFER_LENGTH;\n\t    };\n\t    return HTTPRequest;\n\t}(dispatcher_1[\"default\"]));\n\texports.__esModule = true;\n\texports[\"default\"] = HTTPRequest;\n\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar state_1 = __webpack_require__(34);\n\tvar util_1 = __webpack_require__(11);\n\tvar runtime_1 = __webpack_require__(2);\n\tvar autoIncrement = 1;\n\tvar HTTPSocket = (function () {\n\t    function HTTPSocket(hooks, url) {\n\t        this.hooks = hooks;\n\t        this.session = randomNumber(1000) + \"/\" + randomString(8);\n\t        this.location = getLocation(url);\n\t        this.readyState = state_1[\"default\"].CONNECTING;\n\t        this.openStream();\n\t    }\n\t    HTTPSocket.prototype.send = function (payload) {\n\t        return this.sendRaw(JSON.stringify([payload]));\n\t    };\n\t    HTTPSocket.prototype.ping = function () {\n\t        this.hooks.sendHeartbeat(this);\n\t    };\n\t    HTTPSocket.prototype.close = function (code, reason) {\n\t        this.onClose(code, reason, true);\n\t    };\n\t    HTTPSocket.prototype.sendRaw = function (payload) {\n\t        if (this.readyState === state_1[\"default\"].OPEN) {\n\t            try {\n\t                runtime_1[\"default\"].createSocketRequest(\"POST\", getUniqueURL(getSendURL(this.location, this.session))).start(payload);\n\t                return true;\n\t            }\n\t            catch (e) {\n\t                return false;\n\t            }\n\t        }\n\t        else {\n\t            return false;\n\t        }\n\t    };\n\t    HTTPSocket.prototype.reconnect = function () {\n\t        this.closeStream();\n\t        this.openStream();\n\t    };\n\t    ;\n\t    HTTPSocket.prototype.onClose = function (code, reason, wasClean) {\n\t        this.closeStream();\n\t        this.readyState = state_1[\"default\"].CLOSED;\n\t        if (this.onclose) {\n\t            this.onclose({\n\t                code: code,\n\t                reason: reason,\n\t                wasClean: wasClean\n\t            });\n\t        }\n\t    };\n\t    HTTPSocket.prototype.onChunk = function (chunk) {\n\t        if (chunk.status !== 200) {\n\t            return;\n\t        }\n\t        if (this.readyState === state_1[\"default\"].OPEN) {\n\t            this.onActivity();\n\t        }\n\t        var payload;\n\t        var type = chunk.data.slice(0, 1);\n\t        switch (type) {\n\t            case 'o':\n\t                payload = JSON.parse(chunk.data.slice(1) || '{}');\n\t                this.onOpen(payload);\n\t                break;\n\t            case 'a':\n\t                payload = JSON.parse(chunk.data.slice(1) || '[]');\n\t                for (var i = 0; i < payload.length; i++) {\n\t                    this.onEvent(payload[i]);\n\t                }\n\t                break;\n\t            case 'm':\n\t                payload = JSON.parse(chunk.data.slice(1) || 'null');\n\t                this.onEvent(payload);\n\t                break;\n\t            case 'h':\n\t                this.hooks.onHeartbeat(this);\n\t                break;\n\t            case 'c':\n\t                payload = JSON.parse(chunk.data.slice(1) || '[]');\n\t                this.onClose(payload[0], payload[1], true);\n\t                break;\n\t        }\n\t    };\n\t    HTTPSocket.prototype.onOpen = function (options) {\n\t        if (this.readyState === state_1[\"default\"].CONNECTING) {\n\t            if (options && options.hostname) {\n\t                this.location.base = replaceHost(this.location.base, options.hostname);\n\t            }\n\t            this.readyState = state_1[\"default\"].OPEN;\n\t            if (this.onopen) {\n\t                this.onopen();\n\t            }\n\t        }\n\t        else {\n\t            this.onClose(1006, \"Server lost session\", true);\n\t        }\n\t    };\n\t    HTTPSocket.prototype.onEvent = function (event) {\n\t        if (this.readyState === state_1[\"default\"].OPEN && this.onmessage) {\n\t            this.onmessage({ data: event });\n\t        }\n\t    };\n\t    HTTPSocket.prototype.onActivity = function () {\n\t        if (this.onactivity) {\n\t            this.onactivity();\n\t        }\n\t    };\n\t    HTTPSocket.prototype.onError = function (error) {\n\t        if (this.onerror) {\n\t            this.onerror(error);\n\t        }\n\t    };\n\t    HTTPSocket.prototype.openStream = function () {\n\t        var _this = this;\n\t        this.stream = runtime_1[\"default\"].createSocketRequest(\"POST\", getUniqueURL(this.hooks.getReceiveURL(this.location, this.session)));\n\t        this.stream.bind(\"chunk\", function (chunk) {\n\t            _this.onChunk(chunk);\n\t        });\n\t        this.stream.bind(\"finished\", function (status) {\n\t            _this.hooks.onFinished(_this, status);\n\t        });\n\t        this.stream.bind(\"buffer_too_long\", function () {\n\t            _this.reconnect();\n\t        });\n\t        try {\n\t            this.stream.start();\n\t        }\n\t        catch (error) {\n\t            util_1[\"default\"].defer(function () {\n\t                _this.onError(error);\n\t                _this.onClose(1006, \"Could not start streaming\", false);\n\t            });\n\t        }\n\t    };\n\t    HTTPSocket.prototype.closeStream = function () {\n\t        if (this.stream) {\n\t            this.stream.unbind_all();\n\t            this.stream.close();\n\t            this.stream = null;\n\t        }\n\t    };\n\t    return HTTPSocket;\n\t}());\n\tfunction getLocation(url) {\n\t    var parts = /([^\\?]*)\\/*(\\??.*)/.exec(url);\n\t    return {\n\t        base: parts[1],\n\t        queryString: parts[2]\n\t    };\n\t}\n\tfunction getSendURL(url, session) {\n\t    return url.base + \"/\" + session + \"/xhr_send\";\n\t}\n\tfunction getUniqueURL(url) {\n\t    var separator = (url.indexOf('?') === -1) ? \"?\" : \"&\";\n\t    return url + separator + \"t=\" + (+new Date()) + \"&n=\" + autoIncrement++;\n\t}\n\tfunction replaceHost(url, hostname) {\n\t    var urlParts = /(https?:\\/\\/)([^\\/:]+)((\\/|:)?.*)/.exec(url);\n\t    return urlParts[1] + hostname + urlParts[3];\n\t}\n\tfunction randomNumber(max) {\n\t    return Math.floor(Math.random() * max);\n\t}\n\tfunction randomString(length) {\n\t    var result = [];\n\t    for (var i = 0; i < length; i++) {\n\t        result.push(randomNumber(32).toString(32));\n\t    }\n\t    return result.join('');\n\t}\n\texports.__esModule = true;\n\texports[\"default\"] = HTTPSocket;\n\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar State;\n\t(function (State) {\n\t    State[State[\"CONNECTING\"] = 0] = \"CONNECTING\";\n\t    State[State[\"OPEN\"] = 1] = \"OPEN\";\n\t    State[State[\"CLOSED\"] = 3] = \"CLOSED\";\n\t})(State || (State = {}));\n\texports.__esModule = true;\n\texports[\"default\"] = State;\n\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar hooks = {\n\t    getReceiveURL: function (url, session) {\n\t        return url.base + \"/\" + session + \"/xhr_streaming\" + url.queryString;\n\t    },\n\t    onHeartbeat: function (socket) {\n\t        socket.sendRaw(\"[]\");\n\t    },\n\t    sendHeartbeat: function (socket) {\n\t        socket.sendRaw(\"[]\");\n\t    },\n\t    onFinished: function (socket, status) {\n\t        socket.onClose(1006, \"Connection interrupted (\" + status + \")\", false);\n\t    }\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = hooks;\n\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar hooks = {\n\t    getReceiveURL: function (url, session) {\n\t        return url.base + \"/\" + session + \"/xhr\" + url.queryString;\n\t    },\n\t    onHeartbeat: function () {\n\t    },\n\t    sendHeartbeat: function (socket) {\n\t        socket.sendRaw(\"[]\");\n\t    },\n\t    onFinished: function (socket, status) {\n\t        if (status === 200) {\n\t            socket.reconnect();\n\t        }\n\t        else {\n\t            socket.onClose(1006, \"Connection interrupted (\" + status + \")\", false);\n\t        }\n\t    }\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = hooks;\n\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar runtime_1 = __webpack_require__(2);\n\tvar hooks = {\n\t    getRequest: function (socket) {\n\t        var Constructor = runtime_1[\"default\"].getXHRAPI();\n\t        var xhr = new Constructor();\n\t        xhr.onreadystatechange = xhr.onprogress = function () {\n\t            switch (xhr.readyState) {\n\t                case 3:\n\t                    if (xhr.responseText && xhr.responseText.length > 0) {\n\t                        socket.onChunk(xhr.status, xhr.responseText);\n\t                    }\n\t                    break;\n\t                case 4:\n\t                    if (xhr.responseText && xhr.responseText.length > 0) {\n\t                        socket.onChunk(xhr.status, xhr.responseText);\n\t                    }\n\t                    socket.emit(\"finished\", xhr.status);\n\t                    socket.close();\n\t                    break;\n\t            }\n\t        };\n\t        return xhr;\n\t    },\n\t    abortRequest: function (xhr) {\n\t        xhr.onreadystatechange = null;\n\t        xhr.abort();\n\t    }\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = hooks;\n\n\n/***/ }),\n/* 38 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Collections = __webpack_require__(9);\n\tvar util_1 = __webpack_require__(11);\n\tvar level_1 = __webpack_require__(39);\n\tvar Timeline = (function () {\n\t    function Timeline(key, session, options) {\n\t        this.key = key;\n\t        this.session = session;\n\t        this.events = [];\n\t        this.options = options || {};\n\t        this.sent = 0;\n\t        this.uniqueID = 0;\n\t    }\n\t    Timeline.prototype.log = function (level, event) {\n\t        if (level <= this.options.level) {\n\t            this.events.push(Collections.extend({}, event, { timestamp: util_1[\"default\"].now() }));\n\t            if (this.options.limit && this.events.length > this.options.limit) {\n\t                this.events.shift();\n\t            }\n\t        }\n\t    };\n\t    Timeline.prototype.error = function (event) {\n\t        this.log(level_1[\"default\"].ERROR, event);\n\t    };\n\t    Timeline.prototype.info = function (event) {\n\t        this.log(level_1[\"default\"].INFO, event);\n\t    };\n\t    Timeline.prototype.debug = function (event) {\n\t        this.log(level_1[\"default\"].DEBUG, event);\n\t    };\n\t    Timeline.prototype.isEmpty = function () {\n\t        return this.events.length === 0;\n\t    };\n\t    Timeline.prototype.send = function (sendfn, callback) {\n\t        var _this = this;\n\t        var data = Collections.extend({\n\t            session: this.session,\n\t            bundle: this.sent + 1,\n\t            key: this.key,\n\t            lib: \"js\",\n\t            version: this.options.version,\n\t            cluster: this.options.cluster,\n\t            features: this.options.features,\n\t            timeline: this.events\n\t        }, this.options.params);\n\t        this.events = [];\n\t        sendfn(data, function (error, result) {\n\t            if (!error) {\n\t                _this.sent++;\n\t            }\n\t            if (callback) {\n\t                callback(error, result);\n\t            }\n\t        });\n\t        return true;\n\t    };\n\t    Timeline.prototype.generateUniqueID = function () {\n\t        this.uniqueID++;\n\t        return this.uniqueID;\n\t    };\n\t    return Timeline;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = Timeline;\n\n\n/***/ }),\n/* 39 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar TimelineLevel;\n\t(function (TimelineLevel) {\n\t    TimelineLevel[TimelineLevel[\"ERROR\"] = 3] = \"ERROR\";\n\t    TimelineLevel[TimelineLevel[\"INFO\"] = 6] = \"INFO\";\n\t    TimelineLevel[TimelineLevel[\"DEBUG\"] = 7] = \"DEBUG\";\n\t})(TimelineLevel || (TimelineLevel = {}));\n\texports.__esModule = true;\n\texports[\"default\"] = TimelineLevel;\n\n\n/***/ }),\n/* 40 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Collections = __webpack_require__(9);\n\tvar util_1 = __webpack_require__(11);\n\tvar transport_manager_1 = __webpack_require__(41);\n\tvar Errors = __webpack_require__(30);\n\tvar transport_strategy_1 = __webpack_require__(55);\n\tvar sequential_strategy_1 = __webpack_require__(56);\n\tvar best_connected_ever_strategy_1 = __webpack_require__(57);\n\tvar cached_strategy_1 = __webpack_require__(58);\n\tvar delayed_strategy_1 = __webpack_require__(59);\n\tvar if_strategy_1 = __webpack_require__(60);\n\tvar first_connected_strategy_1 = __webpack_require__(61);\n\tvar runtime_1 = __webpack_require__(2);\n\tvar Transports = runtime_1[\"default\"].Transports;\n\texports.build = function (scheme, options) {\n\t    var context = Collections.extend({}, globalContext, options);\n\t    return evaluate(scheme, context)[1].strategy;\n\t};\n\tvar UnsupportedStrategy = {\n\t    isSupported: function () {\n\t        return false;\n\t    },\n\t    connect: function (_, callback) {\n\t        var deferred = util_1[\"default\"].defer(function () {\n\t            callback(new Errors.UnsupportedStrategy());\n\t        });\n\t        return {\n\t            abort: function () {\n\t                deferred.ensureAborted();\n\t            },\n\t            forceMinPriority: function () { }\n\t        };\n\t    }\n\t};\n\tfunction returnWithOriginalContext(f) {\n\t    return function (context) {\n\t        return [f.apply(this, arguments), context];\n\t    };\n\t}\n\tvar globalContext = {\n\t    extend: function (context, first, second) {\n\t        return [Collections.extend({}, first, second), context];\n\t    },\n\t    def: function (context, name, value) {\n\t        if (context[name] !== undefined) {\n\t            throw \"Redefining symbol \" + name;\n\t        }\n\t        context[name] = value;\n\t        return [undefined, context];\n\t    },\n\t    def_transport: function (context, name, type, priority, options, manager) {\n\t        var transportClass = Transports[type];\n\t        if (!transportClass) {\n\t            throw new Errors.UnsupportedTransport(type);\n\t        }\n\t        var enabled = (!context.enabledTransports ||\n\t            Collections.arrayIndexOf(context.enabledTransports, name) !== -1) &&\n\t            (!context.disabledTransports ||\n\t                Collections.arrayIndexOf(context.disabledTransports, name) === -1);\n\t        var transport;\n\t        if (enabled) {\n\t            transport = new transport_strategy_1[\"default\"](name, priority, manager ? manager.getAssistant(transportClass) : transportClass, Collections.extend({\n\t                key: context.key,\n\t                encrypted: context.encrypted,\n\t                timeline: context.timeline,\n\t                ignoreNullOrigin: context.ignoreNullOrigin\n\t            }, options));\n\t        }\n\t        else {\n\t            transport = UnsupportedStrategy;\n\t        }\n\t        var newContext = context.def(context, name, transport)[1];\n\t        newContext.Transports = context.Transports || {};\n\t        newContext.Transports[name] = transport;\n\t        return [undefined, newContext];\n\t    },\n\t    transport_manager: returnWithOriginalContext(function (_, options) {\n\t        return new transport_manager_1[\"default\"](options);\n\t    }),\n\t    sequential: returnWithOriginalContext(function (_, options) {\n\t        var strategies = Array.prototype.slice.call(arguments, 2);\n\t        return new sequential_strategy_1[\"default\"](strategies, options);\n\t    }),\n\t    cached: returnWithOriginalContext(function (context, ttl, strategy) {\n\t        return new cached_strategy_1[\"default\"](strategy, context.Transports, {\n\t            ttl: ttl,\n\t            timeline: context.timeline,\n\t            encrypted: context.encrypted\n\t        });\n\t    }),\n\t    first_connected: returnWithOriginalContext(function (_, strategy) {\n\t        return new first_connected_strategy_1[\"default\"](strategy);\n\t    }),\n\t    best_connected_ever: returnWithOriginalContext(function () {\n\t        var strategies = Array.prototype.slice.call(arguments, 1);\n\t        return new best_connected_ever_strategy_1[\"default\"](strategies);\n\t    }),\n\t    delayed: returnWithOriginalContext(function (_, delay, strategy) {\n\t        return new delayed_strategy_1[\"default\"](strategy, { delay: delay });\n\t    }),\n\t    \"if\": returnWithOriginalContext(function (_, test, trueBranch, falseBranch) {\n\t        return new if_strategy_1[\"default\"](test, trueBranch, falseBranch);\n\t    }),\n\t    is_supported: returnWithOriginalContext(function (_, strategy) {\n\t        return function () {\n\t            return strategy.isSupported();\n\t        };\n\t    })\n\t};\n\tfunction isSymbol(expression) {\n\t    return (typeof expression === \"string\") && expression.charAt(0) === \":\";\n\t}\n\tfunction getSymbolValue(expression, context) {\n\t    return context[expression.slice(1)];\n\t}\n\tfunction evaluateListOfExpressions(expressions, context) {\n\t    if (expressions.length === 0) {\n\t        return [[], context];\n\t    }\n\t    var head = evaluate(expressions[0], context);\n\t    var tail = evaluateListOfExpressions(expressions.slice(1), head[1]);\n\t    return [[head[0]].concat(tail[0]), tail[1]];\n\t}\n\tfunction evaluateString(expression, context) {\n\t    if (!isSymbol(expression)) {\n\t        return [expression, context];\n\t    }\n\t    var value = getSymbolValue(expression, context);\n\t    if (value === undefined) {\n\t        throw \"Undefined symbol \" + expression;\n\t    }\n\t    return [value, context];\n\t}\n\tfunction evaluateArray(expression, context) {\n\t    if (isSymbol(expression[0])) {\n\t        var f = getSymbolValue(expression[0], context);\n\t        if (expression.length > 1) {\n\t            if (typeof f !== \"function\") {\n\t                throw \"Calling non-function \" + expression[0];\n\t            }\n\t            var args = [Collections.extend({}, context)].concat(Collections.map(expression.slice(1), function (arg) {\n\t                return evaluate(arg, Collections.extend({}, context))[0];\n\t            }));\n\t            return f.apply(this, args);\n\t        }\n\t        else {\n\t            return [f, context];\n\t        }\n\t    }\n\t    else {\n\t        return evaluateListOfExpressions(expression, context);\n\t    }\n\t}\n\tfunction evaluate(expression, context) {\n\t    if (typeof expression === \"string\") {\n\t        return evaluateString(expression, context);\n\t    }\n\t    else if (typeof expression === \"object\") {\n\t        if (expression instanceof Array && expression.length > 0) {\n\t            return evaluateArray(expression, context);\n\t        }\n\t    }\n\t    return [expression, context];\n\t}\n\n\n/***/ }),\n/* 41 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar factory_1 = __webpack_require__(42);\n\tvar TransportManager = (function () {\n\t    function TransportManager(options) {\n\t        this.options = options || {};\n\t        this.livesLeft = this.options.lives || Infinity;\n\t    }\n\t    TransportManager.prototype.getAssistant = function (transport) {\n\t        return factory_1[\"default\"].createAssistantToTheTransportManager(this, transport, {\n\t            minPingDelay: this.options.minPingDelay,\n\t            maxPingDelay: this.options.maxPingDelay\n\t        });\n\t    };\n\t    TransportManager.prototype.isAlive = function () {\n\t        return this.livesLeft > 0;\n\t    };\n\t    TransportManager.prototype.reportDeath = function () {\n\t        this.livesLeft -= 1;\n\t    };\n\t    return TransportManager;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = TransportManager;\n\n\n/***/ }),\n/* 42 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar assistant_to_the_transport_manager_1 = __webpack_require__(43);\n\tvar handshake_1 = __webpack_require__(44);\n\tvar pusher_authorizer_1 = __webpack_require__(47);\n\tvar timeline_sender_1 = __webpack_require__(48);\n\tvar presence_channel_1 = __webpack_require__(49);\n\tvar private_channel_1 = __webpack_require__(50);\n\tvar channel_1 = __webpack_require__(51);\n\tvar connection_manager_1 = __webpack_require__(53);\n\tvar channels_1 = __webpack_require__(54);\n\tvar Factory = {\n\t    createChannels: function () {\n\t        return new channels_1[\"default\"]();\n\t    },\n\t    createConnectionManager: function (key, options) {\n\t        return new connection_manager_1[\"default\"](key, options);\n\t    },\n\t    createChannel: function (name, pusher) {\n\t        return new channel_1[\"default\"](name, pusher);\n\t    },\n\t    createPrivateChannel: function (name, pusher) {\n\t        return new private_channel_1[\"default\"](name, pusher);\n\t    },\n\t    createPresenceChannel: function (name, pusher) {\n\t        return new presence_channel_1[\"default\"](name, pusher);\n\t    },\n\t    createTimelineSender: function (timeline, options) {\n\t        return new timeline_sender_1[\"default\"](timeline, options);\n\t    },\n\t    createAuthorizer: function (channel, options) {\n\t        if (options.authorizer) {\n\t            return options.authorizer(channel, options);\n\t        }\n\t        return new pusher_authorizer_1[\"default\"](channel, options);\n\t    },\n\t    createHandshake: function (transport, callback) {\n\t        return new handshake_1[\"default\"](transport, callback);\n\t    },\n\t    createAssistantToTheTransportManager: function (manager, transport, options) {\n\t        return new assistant_to_the_transport_manager_1[\"default\"](manager, transport, options);\n\t    }\n\t};\n\texports.__esModule = true;\n\texports[\"default\"] = Factory;\n\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar util_1 = __webpack_require__(11);\n\tvar Collections = __webpack_require__(9);\n\tvar AssistantToTheTransportManager = (function () {\n\t    function AssistantToTheTransportManager(manager, transport, options) {\n\t        this.manager = manager;\n\t        this.transport = transport;\n\t        this.minPingDelay = options.minPingDelay;\n\t        this.maxPingDelay = options.maxPingDelay;\n\t        this.pingDelay = undefined;\n\t    }\n\t    AssistantToTheTransportManager.prototype.createConnection = function (name, priority, key, options) {\n\t        var _this = this;\n\t        options = Collections.extend({}, options, {\n\t            activityTimeout: this.pingDelay\n\t        });\n\t        var connection = this.transport.createConnection(name, priority, key, options);\n\t        var openTimestamp = null;\n\t        var onOpen = function () {\n\t            connection.unbind(\"open\", onOpen);\n\t            connection.bind(\"closed\", onClosed);\n\t            openTimestamp = util_1[\"default\"].now();\n\t        };\n\t        var onClosed = function (closeEvent) {\n\t            connection.unbind(\"closed\", onClosed);\n\t            if (closeEvent.code === 1002 || closeEvent.code === 1003) {\n\t                _this.manager.reportDeath();\n\t            }\n\t            else if (!closeEvent.wasClean && openTimestamp) {\n\t                var lifespan = util_1[\"default\"].now() - openTimestamp;\n\t                if (lifespan < 2 * _this.maxPingDelay) {\n\t                    _this.manager.reportDeath();\n\t                    _this.pingDelay = Math.max(lifespan / 2, _this.minPingDelay);\n\t                }\n\t            }\n\t        };\n\t        connection.bind(\"open\", onOpen);\n\t        return connection;\n\t    };\n\t    AssistantToTheTransportManager.prototype.isSupported = function (environment) {\n\t        return this.manager.isAlive() && this.transport.isSupported(environment);\n\t    };\n\t    return AssistantToTheTransportManager;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = AssistantToTheTransportManager;\n\n\n/***/ }),\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Collections = __webpack_require__(9);\n\tvar Protocol = __webpack_require__(45);\n\tvar connection_1 = __webpack_require__(46);\n\tvar Handshake = (function () {\n\t    function Handshake(transport, callback) {\n\t        this.transport = transport;\n\t        this.callback = callback;\n\t        this.bindListeners();\n\t    }\n\t    Handshake.prototype.close = function () {\n\t        this.unbindListeners();\n\t        this.transport.close();\n\t    };\n\t    Handshake.prototype.bindListeners = function () {\n\t        var _this = this;\n\t        this.onMessage = function (m) {\n\t            _this.unbindListeners();\n\t            var result;\n\t            try {\n\t                result = Protocol.processHandshake(m);\n\t            }\n\t            catch (e) {\n\t                _this.finish(\"error\", { error: e });\n\t                _this.transport.close();\n\t                return;\n\t            }\n\t            if (result.action === \"connected\") {\n\t                _this.finish(\"connected\", {\n\t                    connection: new connection_1[\"default\"](result.id, _this.transport),\n\t                    activityTimeout: result.activityTimeout\n\t                });\n\t            }\n\t            else {\n\t                _this.finish(result.action, { error: result.error });\n\t                _this.transport.close();\n\t            }\n\t        };\n\t        this.onClosed = function (closeEvent) {\n\t            _this.unbindListeners();\n\t            var action = Protocol.getCloseAction(closeEvent) || \"backoff\";\n\t            var error = Protocol.getCloseError(closeEvent);\n\t            _this.finish(action, { error: error });\n\t        };\n\t        this.transport.bind(\"message\", this.onMessage);\n\t        this.transport.bind(\"closed\", this.onClosed);\n\t    };\n\t    Handshake.prototype.unbindListeners = function () {\n\t        this.transport.unbind(\"message\", this.onMessage);\n\t        this.transport.unbind(\"closed\", this.onClosed);\n\t    };\n\t    Handshake.prototype.finish = function (action, params) {\n\t        this.callback(Collections.extend({ transport: this.transport, action: action }, params));\n\t    };\n\t    return Handshake;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = Handshake;\n\n\n/***/ }),\n/* 45 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\texports.decodeMessage = function (message) {\n\t    try {\n\t        var params = JSON.parse(message.data);\n\t        if (typeof params.data === 'string') {\n\t            try {\n\t                params.data = JSON.parse(params.data);\n\t            }\n\t            catch (e) {\n\t                if (!(e instanceof SyntaxError)) {\n\t                    throw e;\n\t                }\n\t            }\n\t        }\n\t        return params;\n\t    }\n\t    catch (e) {\n\t        throw { type: 'MessageParseError', error: e, data: message.data };\n\t    }\n\t};\n\texports.encodeMessage = function (message) {\n\t    return JSON.stringify(message);\n\t};\n\texports.processHandshake = function (message) {\n\t    message = exports.decodeMessage(message);\n\t    if (message.event === \"pusher:connection_established\") {\n\t        if (!message.data.activity_timeout) {\n\t            throw \"No activity timeout specified in handshake\";\n\t        }\n\t        return {\n\t            action: \"connected\",\n\t            id: message.data.socket_id,\n\t            activityTimeout: message.data.activity_timeout * 1000\n\t        };\n\t    }\n\t    else if (message.event === \"pusher:error\") {\n\t        return {\n\t            action: this.getCloseAction(message.data),\n\t            error: this.getCloseError(message.data)\n\t        };\n\t    }\n\t    else {\n\t        throw \"Invalid handshake\";\n\t    }\n\t};\n\texports.getCloseAction = function (closeEvent) {\n\t    if (closeEvent.code < 4000) {\n\t        if (closeEvent.code >= 1002 && closeEvent.code <= 1004) {\n\t            return \"backoff\";\n\t        }\n\t        else {\n\t            return null;\n\t        }\n\t    }\n\t    else if (closeEvent.code === 4000) {\n\t        return \"ssl_only\";\n\t    }\n\t    else if (closeEvent.code < 4100) {\n\t        return \"refused\";\n\t    }\n\t    else if (closeEvent.code < 4200) {\n\t        return \"backoff\";\n\t    }\n\t    else if (closeEvent.code < 4300) {\n\t        return \"retry\";\n\t    }\n\t    else {\n\t        return \"refused\";\n\t    }\n\t};\n\texports.getCloseError = function (closeEvent) {\n\t    if (closeEvent.code !== 1000 && closeEvent.code !== 1001) {\n\t        return {\n\t            type: 'PusherError',\n\t            data: {\n\t                code: closeEvent.code,\n\t                message: closeEvent.reason || closeEvent.message\n\t            }\n\t        };\n\t    }\n\t    else {\n\t        return null;\n\t    }\n\t};\n\n\n/***/ }),\n/* 46 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar Collections = __webpack_require__(9);\n\tvar dispatcher_1 = __webpack_require__(23);\n\tvar Protocol = __webpack_require__(45);\n\tvar logger_1 = __webpack_require__(8);\n\tvar Connection = (function (_super) {\n\t    __extends(Connection, _super);\n\t    function Connection(id, transport) {\n\t        _super.call(this);\n\t        this.id = id;\n\t        this.transport = transport;\n\t        this.activityTimeout = transport.activityTimeout;\n\t        this.bindListeners();\n\t    }\n\t    Connection.prototype.handlesActivityChecks = function () {\n\t        return this.transport.handlesActivityChecks();\n\t    };\n\t    Connection.prototype.send = function (data) {\n\t        return this.transport.send(data);\n\t    };\n\t    Connection.prototype.send_event = function (name, data, channel) {\n\t        var message = { event: name, data: data };\n\t        if (channel) {\n\t            message.channel = channel;\n\t        }\n\t        logger_1[\"default\"].debug('Event sent', message);\n\t        return this.send(Protocol.encodeMessage(message));\n\t    };\n\t    Connection.prototype.ping = function () {\n\t        if (this.transport.supportsPing()) {\n\t            this.transport.ping();\n\t        }\n\t        else {\n\t            this.send_event('pusher:ping', {});\n\t        }\n\t    };\n\t    Connection.prototype.close = function () {\n\t        this.transport.close();\n\t    };\n\t    Connection.prototype.bindListeners = function () {\n\t        var _this = this;\n\t        var listeners = {\n\t            message: function (m) {\n\t                var message;\n\t                try {\n\t                    message = Protocol.decodeMessage(m);\n\t                }\n\t                catch (e) {\n\t                    _this.emit('error', {\n\t                        type: 'MessageParseError',\n\t                        error: e,\n\t                        data: m.data\n\t                    });\n\t                }\n\t                if (message !== undefined) {\n\t                    logger_1[\"default\"].debug('Event recd', message);\n\t                    switch (message.event) {\n\t                        case 'pusher:error':\n\t                            _this.emit('error', { type: 'PusherError', data: message.data });\n\t                            break;\n\t                        case 'pusher:ping':\n\t                            _this.emit(\"ping\");\n\t                            break;\n\t                        case 'pusher:pong':\n\t                            _this.emit(\"pong\");\n\t                            break;\n\t                    }\n\t                    _this.emit('message', message);\n\t                }\n\t            },\n\t            activity: function () {\n\t                _this.emit(\"activity\");\n\t            },\n\t            error: function (error) {\n\t                _this.emit(\"error\", { type: \"WebSocketError\", error: error });\n\t            },\n\t            closed: function (closeEvent) {\n\t                unbindListeners();\n\t                if (closeEvent && closeEvent.code) {\n\t                    _this.handleCloseEvent(closeEvent);\n\t                }\n\t                _this.transport = null;\n\t                _this.emit(\"closed\");\n\t            }\n\t        };\n\t        var unbindListeners = function () {\n\t            Collections.objectApply(listeners, function (listener, event) {\n\t                _this.transport.unbind(event, listener);\n\t            });\n\t        };\n\t        Collections.objectApply(listeners, function (listener, event) {\n\t            _this.transport.bind(event, listener);\n\t        });\n\t    };\n\t    Connection.prototype.handleCloseEvent = function (closeEvent) {\n\t        var action = Protocol.getCloseAction(closeEvent);\n\t        var error = Protocol.getCloseError(closeEvent);\n\t        if (error) {\n\t            this.emit('error', error);\n\t        }\n\t        if (action) {\n\t            this.emit(action);\n\t        }\n\t    };\n\t    return Connection;\n\t}(dispatcher_1[\"default\"]));\n\texports.__esModule = true;\n\texports[\"default\"] = Connection;\n\n\n/***/ }),\n/* 47 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar runtime_1 = __webpack_require__(2);\n\tvar PusherAuthorizer = (function () {\n\t    function PusherAuthorizer(channel, options) {\n\t        this.channel = channel;\n\t        var authTransport = options.authTransport;\n\t        if (typeof runtime_1[\"default\"].getAuthorizers()[authTransport] === \"undefined\") {\n\t            throw \"'\" + authTransport + \"' is not a recognized auth transport\";\n\t        }\n\t        this.type = authTransport;\n\t        this.options = options;\n\t        this.authOptions = (options || {}).auth || {};\n\t    }\n\t    PusherAuthorizer.prototype.composeQuery = function (socketId) {\n\t        var query = 'socket_id=' + encodeURIComponent(socketId) +\n\t            '&channel_name=' + encodeURIComponent(this.channel.name);\n\t        for (var i in this.authOptions.params) {\n\t            query += \"&\" + encodeURIComponent(i) + \"=\" + encodeURIComponent(this.authOptions.params[i]);\n\t        }\n\t        return query;\n\t    };\n\t    PusherAuthorizer.prototype.authorize = function (socketId, callback) {\n\t        PusherAuthorizer.authorizers = PusherAuthorizer.authorizers || runtime_1[\"default\"].getAuthorizers();\n\t        return PusherAuthorizer.authorizers[this.type].call(this, runtime_1[\"default\"], socketId, callback);\n\t    };\n\t    return PusherAuthorizer;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = PusherAuthorizer;\n\n\n/***/ }),\n/* 48 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar runtime_1 = __webpack_require__(2);\n\tvar TimelineSender = (function () {\n\t    function TimelineSender(timeline, options) {\n\t        this.timeline = timeline;\n\t        this.options = options || {};\n\t    }\n\t    TimelineSender.prototype.send = function (encrypted, callback) {\n\t        if (this.timeline.isEmpty()) {\n\t            return;\n\t        }\n\t        this.timeline.send(runtime_1[\"default\"].TimelineTransport.getAgent(this, encrypted), callback);\n\t    };\n\t    return TimelineSender;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = TimelineSender;\n\n\n/***/ }),\n/* 49 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar private_channel_1 = __webpack_require__(50);\n\tvar logger_1 = __webpack_require__(8);\n\tvar members_1 = __webpack_require__(52);\n\tvar PresenceChannel = (function (_super) {\n\t    __extends(PresenceChannel, _super);\n\t    function PresenceChannel(name, pusher) {\n\t        _super.call(this, name, pusher);\n\t        this.members = new members_1[\"default\"]();\n\t    }\n\t    PresenceChannel.prototype.authorize = function (socketId, callback) {\n\t        var _this = this;\n\t        _super.prototype.authorize.call(this, socketId, function (error, authData) {\n\t            if (!error) {\n\t                if (authData.channel_data === undefined) {\n\t                    logger_1[\"default\"].warn(\"Invalid auth response for channel '\" +\n\t                        _this.name +\n\t                        \"', expected 'channel_data' field\");\n\t                    callback(\"Invalid auth response\");\n\t                    return;\n\t                }\n\t                var channelData = JSON.parse(authData.channel_data);\n\t                _this.members.setMyID(channelData.user_id);\n\t            }\n\t            callback(error, authData);\n\t        });\n\t    };\n\t    PresenceChannel.prototype.handleEvent = function (event, data) {\n\t        switch (event) {\n\t            case \"pusher_internal:subscription_succeeded\":\n\t                this.subscriptionPending = false;\n\t                this.subscribed = true;\n\t                if (this.subscriptionCancelled) {\n\t                    this.pusher.unsubscribe(this.name);\n\t                }\n\t                else {\n\t                    this.members.onSubscription(data);\n\t                    this.emit(\"pusher:subscription_succeeded\", this.members);\n\t                }\n\t                break;\n\t            case \"pusher_internal:member_added\":\n\t                var addedMember = this.members.addMember(data);\n\t                this.emit('pusher:member_added', addedMember);\n\t                break;\n\t            case \"pusher_internal:member_removed\":\n\t                var removedMember = this.members.removeMember(data);\n\t                if (removedMember) {\n\t                    this.emit('pusher:member_removed', removedMember);\n\t                }\n\t                break;\n\t            default:\n\t                private_channel_1[\"default\"].prototype.handleEvent.call(this, event, data);\n\t        }\n\t    };\n\t    PresenceChannel.prototype.disconnect = function () {\n\t        this.members.reset();\n\t        _super.prototype.disconnect.call(this);\n\t    };\n\t    return PresenceChannel;\n\t}(private_channel_1[\"default\"]));\n\texports.__esModule = true;\n\texports[\"default\"] = PresenceChannel;\n\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar factory_1 = __webpack_require__(42);\n\tvar channel_1 = __webpack_require__(51);\n\tvar PrivateChannel = (function (_super) {\n\t    __extends(PrivateChannel, _super);\n\t    function PrivateChannel() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    PrivateChannel.prototype.authorize = function (socketId, callback) {\n\t        var authorizer = factory_1[\"default\"].createAuthorizer(this, this.pusher.config);\n\t        return authorizer.authorize(socketId, callback);\n\t    };\n\t    return PrivateChannel;\n\t}(channel_1[\"default\"]));\n\texports.__esModule = true;\n\texports[\"default\"] = PrivateChannel;\n\n\n/***/ }),\n/* 51 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar dispatcher_1 = __webpack_require__(23);\n\tvar Errors = __webpack_require__(30);\n\tvar logger_1 = __webpack_require__(8);\n\tvar Channel = (function (_super) {\n\t    __extends(Channel, _super);\n\t    function Channel(name, pusher) {\n\t        _super.call(this, function (event, data) {\n\t            logger_1[\"default\"].debug('No callbacks on ' + name + ' for ' + event);\n\t        });\n\t        this.name = name;\n\t        this.pusher = pusher;\n\t        this.subscribed = false;\n\t        this.subscriptionPending = false;\n\t        this.subscriptionCancelled = false;\n\t    }\n\t    Channel.prototype.authorize = function (socketId, callback) {\n\t        return callback(false, {});\n\t    };\n\t    Channel.prototype.trigger = function (event, data) {\n\t        if (event.indexOf(\"client-\") !== 0) {\n\t            throw new Errors.BadEventName(\"Event '\" + event + \"' does not start with 'client-'\");\n\t        }\n\t        return this.pusher.send_event(event, data, this.name);\n\t    };\n\t    Channel.prototype.disconnect = function () {\n\t        this.subscribed = false;\n\t    };\n\t    Channel.prototype.handleEvent = function (event, data) {\n\t        if (event.indexOf(\"pusher_internal:\") === 0) {\n\t            if (event === \"pusher_internal:subscription_succeeded\") {\n\t                this.subscriptionPending = false;\n\t                this.subscribed = true;\n\t                if (this.subscriptionCancelled) {\n\t                    this.pusher.unsubscribe(this.name);\n\t                }\n\t                else {\n\t                    this.emit(\"pusher:subscription_succeeded\", data);\n\t                }\n\t            }\n\t        }\n\t        else {\n\t            this.emit(event, data);\n\t        }\n\t    };\n\t    Channel.prototype.subscribe = function () {\n\t        var _this = this;\n\t        if (this.subscribed) {\n\t            return;\n\t        }\n\t        this.subscriptionPending = true;\n\t        this.subscriptionCancelled = false;\n\t        this.authorize(this.pusher.connection.socket_id, function (error, data) {\n\t            if (error) {\n\t                _this.handleEvent('pusher:subscription_error', data);\n\t            }\n\t            else {\n\t                _this.pusher.send_event('pusher:subscribe', {\n\t                    auth: data.auth,\n\t                    channel_data: data.channel_data,\n\t                    channel: _this.name\n\t                });\n\t            }\n\t        });\n\t    };\n\t    Channel.prototype.unsubscribe = function () {\n\t        this.subscribed = false;\n\t        this.pusher.send_event('pusher:unsubscribe', {\n\t            channel: this.name\n\t        });\n\t    };\n\t    Channel.prototype.cancelSubscription = function () {\n\t        this.subscriptionCancelled = true;\n\t    };\n\t    Channel.prototype.reinstateSubscription = function () {\n\t        this.subscriptionCancelled = false;\n\t    };\n\t    return Channel;\n\t}(dispatcher_1[\"default\"]));\n\texports.__esModule = true;\n\texports[\"default\"] = Channel;\n\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Collections = __webpack_require__(9);\n\tvar Members = (function () {\n\t    function Members() {\n\t        this.reset();\n\t    }\n\t    Members.prototype.get = function (id) {\n\t        if (Object.prototype.hasOwnProperty.call(this.members, id)) {\n\t            return {\n\t                id: id,\n\t                info: this.members[id]\n\t            };\n\t        }\n\t        else {\n\t            return null;\n\t        }\n\t    };\n\t    Members.prototype.each = function (callback) {\n\t        var _this = this;\n\t        Collections.objectApply(this.members, function (member, id) {\n\t            callback(_this.get(id));\n\t        });\n\t    };\n\t    Members.prototype.setMyID = function (id) {\n\t        this.myID = id;\n\t    };\n\t    Members.prototype.onSubscription = function (subscriptionData) {\n\t        this.members = subscriptionData.presence.hash;\n\t        this.count = subscriptionData.presence.count;\n\t        this.me = this.get(this.myID);\n\t    };\n\t    Members.prototype.addMember = function (memberData) {\n\t        if (this.get(memberData.user_id) === null) {\n\t            this.count++;\n\t        }\n\t        this.members[memberData.user_id] = memberData.user_info;\n\t        return this.get(memberData.user_id);\n\t    };\n\t    Members.prototype.removeMember = function (memberData) {\n\t        var member = this.get(memberData.user_id);\n\t        if (member) {\n\t            delete this.members[memberData.user_id];\n\t            this.count--;\n\t        }\n\t        return member;\n\t    };\n\t    Members.prototype.reset = function () {\n\t        this.members = {};\n\t        this.count = 0;\n\t        this.myID = null;\n\t        this.me = null;\n\t    };\n\t    return Members;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = Members;\n\n\n/***/ }),\n/* 53 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar dispatcher_1 = __webpack_require__(23);\n\tvar timers_1 = __webpack_require__(12);\n\tvar logger_1 = __webpack_require__(8);\n\tvar Collections = __webpack_require__(9);\n\tvar runtime_1 = __webpack_require__(2);\n\tvar ConnectionManager = (function (_super) {\n\t    __extends(ConnectionManager, _super);\n\t    function ConnectionManager(key, options) {\n\t        var _this = this;\n\t        _super.call(this);\n\t        this.key = key;\n\t        this.options = options || {};\n\t        this.state = \"initialized\";\n\t        this.connection = null;\n\t        this.encrypted = !!options.encrypted;\n\t        this.timeline = this.options.timeline;\n\t        this.connectionCallbacks = this.buildConnectionCallbacks();\n\t        this.errorCallbacks = this.buildErrorCallbacks();\n\t        this.handshakeCallbacks = this.buildHandshakeCallbacks(this.errorCallbacks);\n\t        var Network = runtime_1[\"default\"].getNetwork();\n\t        Network.bind(\"online\", function () {\n\t            _this.timeline.info({ netinfo: \"online\" });\n\t            if (_this.state === \"connecting\" || _this.state === \"unavailable\") {\n\t                _this.retryIn(0);\n\t            }\n\t        });\n\t        Network.bind(\"offline\", function () {\n\t            _this.timeline.info({ netinfo: \"offline\" });\n\t            if (_this.connection) {\n\t                _this.sendActivityCheck();\n\t            }\n\t        });\n\t        this.updateStrategy();\n\t    }\n\t    ConnectionManager.prototype.connect = function () {\n\t        if (this.connection || this.runner) {\n\t            return;\n\t        }\n\t        if (!this.strategy.isSupported()) {\n\t            this.updateState(\"failed\");\n\t            return;\n\t        }\n\t        this.updateState(\"connecting\");\n\t        this.startConnecting();\n\t        this.setUnavailableTimer();\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.send = function (data) {\n\t        if (this.connection) {\n\t            return this.connection.send(data);\n\t        }\n\t        else {\n\t            return false;\n\t        }\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.send_event = function (name, data, channel) {\n\t        if (this.connection) {\n\t            return this.connection.send_event(name, data, channel);\n\t        }\n\t        else {\n\t            return false;\n\t        }\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.disconnect = function () {\n\t        this.disconnectInternally();\n\t        this.updateState(\"disconnected\");\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.isEncrypted = function () {\n\t        return this.encrypted;\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.startConnecting = function () {\n\t        var _this = this;\n\t        var callback = function (error, handshake) {\n\t            if (error) {\n\t                _this.runner = _this.strategy.connect(0, callback);\n\t            }\n\t            else {\n\t                if (handshake.action === \"error\") {\n\t                    _this.emit(\"error\", { type: \"HandshakeError\", error: handshake.error });\n\t                    _this.timeline.error({ handshakeError: handshake.error });\n\t                }\n\t                else {\n\t                    _this.abortConnecting();\n\t                    _this.handshakeCallbacks[handshake.action](handshake);\n\t                }\n\t            }\n\t        };\n\t        this.runner = this.strategy.connect(0, callback);\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.abortConnecting = function () {\n\t        if (this.runner) {\n\t            this.runner.abort();\n\t            this.runner = null;\n\t        }\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.disconnectInternally = function () {\n\t        this.abortConnecting();\n\t        this.clearRetryTimer();\n\t        this.clearUnavailableTimer();\n\t        if (this.connection) {\n\t            var connection = this.abandonConnection();\n\t            connection.close();\n\t        }\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.updateStrategy = function () {\n\t        this.strategy = this.options.getStrategy({\n\t            key: this.key,\n\t            timeline: this.timeline,\n\t            encrypted: this.encrypted\n\t        });\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.retryIn = function (delay) {\n\t        var _this = this;\n\t        this.timeline.info({ action: \"retry\", delay: delay });\n\t        if (delay > 0) {\n\t            this.emit(\"connecting_in\", Math.round(delay / 1000));\n\t        }\n\t        this.retryTimer = new timers_1.OneOffTimer(delay || 0, function () {\n\t            _this.disconnectInternally();\n\t            _this.connect();\n\t        });\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.clearRetryTimer = function () {\n\t        if (this.retryTimer) {\n\t            this.retryTimer.ensureAborted();\n\t            this.retryTimer = null;\n\t        }\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.setUnavailableTimer = function () {\n\t        var _this = this;\n\t        this.unavailableTimer = new timers_1.OneOffTimer(this.options.unavailableTimeout, function () {\n\t            _this.updateState(\"unavailable\");\n\t        });\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.clearUnavailableTimer = function () {\n\t        if (this.unavailableTimer) {\n\t            this.unavailableTimer.ensureAborted();\n\t        }\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.sendActivityCheck = function () {\n\t        var _this = this;\n\t        this.stopActivityCheck();\n\t        this.connection.ping();\n\t        this.activityTimer = new timers_1.OneOffTimer(this.options.pongTimeout, function () {\n\t            _this.timeline.error({ pong_timed_out: _this.options.pongTimeout });\n\t            _this.retryIn(0);\n\t        });\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.resetActivityCheck = function () {\n\t        var _this = this;\n\t        this.stopActivityCheck();\n\t        if (!this.connection.handlesActivityChecks()) {\n\t            this.activityTimer = new timers_1.OneOffTimer(this.activityTimeout, function () {\n\t                _this.sendActivityCheck();\n\t            });\n\t        }\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.stopActivityCheck = function () {\n\t        if (this.activityTimer) {\n\t            this.activityTimer.ensureAborted();\n\t        }\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.buildConnectionCallbacks = function () {\n\t        var _this = this;\n\t        return {\n\t            message: function (message) {\n\t                _this.resetActivityCheck();\n\t                _this.emit('message', message);\n\t            },\n\t            ping: function () {\n\t                _this.send_event('pusher:pong', {});\n\t            },\n\t            activity: function () {\n\t                _this.resetActivityCheck();\n\t            },\n\t            error: function (error) {\n\t                _this.emit(\"error\", { type: \"WebSocketError\", error: error });\n\t            },\n\t            closed: function () {\n\t                _this.abandonConnection();\n\t                if (_this.shouldRetry()) {\n\t                    _this.retryIn(1000);\n\t                }\n\t            }\n\t        };\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.buildHandshakeCallbacks = function (errorCallbacks) {\n\t        var _this = this;\n\t        return Collections.extend({}, errorCallbacks, {\n\t            connected: function (handshake) {\n\t                _this.activityTimeout = Math.min(_this.options.activityTimeout, handshake.activityTimeout, handshake.connection.activityTimeout || Infinity);\n\t                _this.clearUnavailableTimer();\n\t                _this.setConnection(handshake.connection);\n\t                _this.socket_id = _this.connection.id;\n\t                _this.updateState(\"connected\", { socket_id: _this.socket_id });\n\t            }\n\t        });\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.buildErrorCallbacks = function () {\n\t        var _this = this;\n\t        var withErrorEmitted = function (callback) {\n\t            return function (result) {\n\t                if (result.error) {\n\t                    _this.emit(\"error\", { type: \"WebSocketError\", error: result.error });\n\t                }\n\t                callback(result);\n\t            };\n\t        };\n\t        return {\n\t            ssl_only: withErrorEmitted(function () {\n\t                _this.encrypted = true;\n\t                _this.updateStrategy();\n\t                _this.retryIn(0);\n\t            }),\n\t            refused: withErrorEmitted(function () {\n\t                _this.disconnect();\n\t            }),\n\t            backoff: withErrorEmitted(function () {\n\t                _this.retryIn(1000);\n\t            }),\n\t            retry: withErrorEmitted(function () {\n\t                _this.retryIn(0);\n\t            })\n\t        };\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.setConnection = function (connection) {\n\t        this.connection = connection;\n\t        for (var event in this.connectionCallbacks) {\n\t            this.connection.bind(event, this.connectionCallbacks[event]);\n\t        }\n\t        this.resetActivityCheck();\n\t    };\n\t    ;\n\t    ConnectionManager.prototype.abandonConnection = function () {\n\t        if (!this.connection) {\n\t            return;\n\t        }\n\t        this.stopActivityCheck();\n\t        for (var event in this.connectionCallbacks) {\n\t            this.connection.unbind(event, this.connectionCallbacks[event]);\n\t        }\n\t        var connection = this.connection;\n\t        this.connection = null;\n\t        return connection;\n\t    };\n\t    ConnectionManager.prototype.updateState = function (newState, data) {\n\t        var previousState = this.state;\n\t        this.state = newState;\n\t        if (previousState !== newState) {\n\t            var newStateDescription = newState;\n\t            if (newStateDescription === \"connected\") {\n\t                newStateDescription += \" with new socket ID \" + data.socket_id;\n\t            }\n\t            logger_1[\"default\"].debug('State changed', previousState + ' -> ' + newStateDescription);\n\t            this.timeline.info({ state: newState, params: data });\n\t            this.emit('state_change', { previous: previousState, current: newState });\n\t            this.emit(newState, data);\n\t        }\n\t    };\n\t    ConnectionManager.prototype.shouldRetry = function () {\n\t        return this.state === \"connecting\" || this.state === \"connected\";\n\t    };\n\t    return ConnectionManager;\n\t}(dispatcher_1[\"default\"]));\n\texports.__esModule = true;\n\texports[\"default\"] = ConnectionManager;\n\n\n/***/ }),\n/* 54 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Collections = __webpack_require__(9);\n\tvar factory_1 = __webpack_require__(42);\n\tvar Channels = (function () {\n\t    function Channels() {\n\t        this.channels = {};\n\t    }\n\t    Channels.prototype.add = function (name, pusher) {\n\t        if (!this.channels[name]) {\n\t            this.channels[name] = createChannel(name, pusher);\n\t        }\n\t        return this.channels[name];\n\t    };\n\t    Channels.prototype.all = function () {\n\t        return Collections.values(this.channels);\n\t    };\n\t    Channels.prototype.find = function (name) {\n\t        return this.channels[name];\n\t    };\n\t    Channels.prototype.remove = function (name) {\n\t        var channel = this.channels[name];\n\t        delete this.channels[name];\n\t        return channel;\n\t    };\n\t    Channels.prototype.disconnect = function () {\n\t        Collections.objectApply(this.channels, function (channel) {\n\t            channel.disconnect();\n\t        });\n\t    };\n\t    return Channels;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = Channels;\n\tfunction createChannel(name, pusher) {\n\t    if (name.indexOf('private-') === 0) {\n\t        return factory_1[\"default\"].createPrivateChannel(name, pusher);\n\t    }\n\t    else if (name.indexOf('presence-') === 0) {\n\t        return factory_1[\"default\"].createPresenceChannel(name, pusher);\n\t    }\n\t    else {\n\t        return factory_1[\"default\"].createChannel(name, pusher);\n\t    }\n\t}\n\n\n/***/ }),\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar factory_1 = __webpack_require__(42);\n\tvar util_1 = __webpack_require__(11);\n\tvar Errors = __webpack_require__(30);\n\tvar Collections = __webpack_require__(9);\n\tvar TransportStrategy = (function () {\n\t    function TransportStrategy(name, priority, transport, options) {\n\t        this.name = name;\n\t        this.priority = priority;\n\t        this.transport = transport;\n\t        this.options = options || {};\n\t    }\n\t    TransportStrategy.prototype.isSupported = function () {\n\t        return this.transport.isSupported({\n\t            encrypted: this.options.encrypted\n\t        });\n\t    };\n\t    TransportStrategy.prototype.connect = function (minPriority, callback) {\n\t        var _this = this;\n\t        if (!this.isSupported()) {\n\t            return failAttempt(new Errors.UnsupportedStrategy(), callback);\n\t        }\n\t        else if (this.priority < minPriority) {\n\t            return failAttempt(new Errors.TransportPriorityTooLow(), callback);\n\t        }\n\t        var connected = false;\n\t        var transport = this.transport.createConnection(this.name, this.priority, this.options.key, this.options);\n\t        var handshake = null;\n\t        var onInitialized = function () {\n\t            transport.unbind(\"initialized\", onInitialized);\n\t            transport.connect();\n\t        };\n\t        var onOpen = function () {\n\t            handshake = factory_1[\"default\"].createHandshake(transport, function (result) {\n\t                connected = true;\n\t                unbindListeners();\n\t                callback(null, result);\n\t            });\n\t        };\n\t        var onError = function (error) {\n\t            unbindListeners();\n\t            callback(error);\n\t        };\n\t        var onClosed = function () {\n\t            unbindListeners();\n\t            var serializedTransport;\n\t            serializedTransport = Collections.safeJSONStringify(transport);\n\t            callback(new Errors.TransportClosed(serializedTransport));\n\t        };\n\t        var unbindListeners = function () {\n\t            transport.unbind(\"initialized\", onInitialized);\n\t            transport.unbind(\"open\", onOpen);\n\t            transport.unbind(\"error\", onError);\n\t            transport.unbind(\"closed\", onClosed);\n\t        };\n\t        transport.bind(\"initialized\", onInitialized);\n\t        transport.bind(\"open\", onOpen);\n\t        transport.bind(\"error\", onError);\n\t        transport.bind(\"closed\", onClosed);\n\t        transport.initialize();\n\t        return {\n\t            abort: function () {\n\t                if (connected) {\n\t                    return;\n\t                }\n\t                unbindListeners();\n\t                if (handshake) {\n\t                    handshake.close();\n\t                }\n\t                else {\n\t                    transport.close();\n\t                }\n\t            },\n\t            forceMinPriority: function (p) {\n\t                if (connected) {\n\t                    return;\n\t                }\n\t                if (_this.priority < p) {\n\t                    if (handshake) {\n\t                        handshake.close();\n\t                    }\n\t                    else {\n\t                        transport.close();\n\t                    }\n\t                }\n\t            }\n\t        };\n\t    };\n\t    return TransportStrategy;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = TransportStrategy;\n\tfunction failAttempt(error, callback) {\n\t    util_1[\"default\"].defer(function () {\n\t        callback(error);\n\t    });\n\t    return {\n\t        abort: function () { },\n\t        forceMinPriority: function () { }\n\t    };\n\t}\n\n\n/***/ }),\n/* 56 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Collections = __webpack_require__(9);\n\tvar util_1 = __webpack_require__(11);\n\tvar timers_1 = __webpack_require__(12);\n\tvar SequentialStrategy = (function () {\n\t    function SequentialStrategy(strategies, options) {\n\t        this.strategies = strategies;\n\t        this.loop = Boolean(options.loop);\n\t        this.failFast = Boolean(options.failFast);\n\t        this.timeout = options.timeout;\n\t        this.timeoutLimit = options.timeoutLimit;\n\t    }\n\t    SequentialStrategy.prototype.isSupported = function () {\n\t        return Collections.any(this.strategies, util_1[\"default\"].method(\"isSupported\"));\n\t    };\n\t    SequentialStrategy.prototype.connect = function (minPriority, callback) {\n\t        var _this = this;\n\t        var strategies = this.strategies;\n\t        var current = 0;\n\t        var timeout = this.timeout;\n\t        var runner = null;\n\t        var tryNextStrategy = function (error, handshake) {\n\t            if (handshake) {\n\t                callback(null, handshake);\n\t            }\n\t            else {\n\t                current = current + 1;\n\t                if (_this.loop) {\n\t                    current = current % strategies.length;\n\t                }\n\t                if (current < strategies.length) {\n\t                    if (timeout) {\n\t                        timeout = timeout * 2;\n\t                        if (_this.timeoutLimit) {\n\t                            timeout = Math.min(timeout, _this.timeoutLimit);\n\t                        }\n\t                    }\n\t                    runner = _this.tryStrategy(strategies[current], minPriority, { timeout: timeout, failFast: _this.failFast }, tryNextStrategy);\n\t                }\n\t                else {\n\t                    callback(true);\n\t                }\n\t            }\n\t        };\n\t        runner = this.tryStrategy(strategies[current], minPriority, { timeout: timeout, failFast: this.failFast }, tryNextStrategy);\n\t        return {\n\t            abort: function () {\n\t                runner.abort();\n\t            },\n\t            forceMinPriority: function (p) {\n\t                minPriority = p;\n\t                if (runner) {\n\t                    runner.forceMinPriority(p);\n\t                }\n\t            }\n\t        };\n\t    };\n\t    SequentialStrategy.prototype.tryStrategy = function (strategy, minPriority, options, callback) {\n\t        var timer = null;\n\t        var runner = null;\n\t        if (options.timeout > 0) {\n\t            timer = new timers_1.OneOffTimer(options.timeout, function () {\n\t                runner.abort();\n\t                callback(true);\n\t            });\n\t        }\n\t        runner = strategy.connect(minPriority, function (error, handshake) {\n\t            if (error && timer && timer.isRunning() && !options.failFast) {\n\t                return;\n\t            }\n\t            if (timer) {\n\t                timer.ensureAborted();\n\t            }\n\t            callback(error, handshake);\n\t        });\n\t        return {\n\t            abort: function () {\n\t                if (timer) {\n\t                    timer.ensureAborted();\n\t                }\n\t                runner.abort();\n\t            },\n\t            forceMinPriority: function (p) {\n\t                runner.forceMinPriority(p);\n\t            }\n\t        };\n\t    };\n\t    return SequentialStrategy;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = SequentialStrategy;\n\n\n/***/ }),\n/* 57 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Collections = __webpack_require__(9);\n\tvar util_1 = __webpack_require__(11);\n\tvar BestConnectedEverStrategy = (function () {\n\t    function BestConnectedEverStrategy(strategies) {\n\t        this.strategies = strategies;\n\t    }\n\t    BestConnectedEverStrategy.prototype.isSupported = function () {\n\t        return Collections.any(this.strategies, util_1[\"default\"].method(\"isSupported\"));\n\t    };\n\t    BestConnectedEverStrategy.prototype.connect = function (minPriority, callback) {\n\t        return connect(this.strategies, minPriority, function (i, runners) {\n\t            return function (error, handshake) {\n\t                runners[i].error = error;\n\t                if (error) {\n\t                    if (allRunnersFailed(runners)) {\n\t                        callback(true);\n\t                    }\n\t                    return;\n\t                }\n\t                Collections.apply(runners, function (runner) {\n\t                    runner.forceMinPriority(handshake.transport.priority);\n\t                });\n\t                callback(null, handshake);\n\t            };\n\t        });\n\t    };\n\t    return BestConnectedEverStrategy;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = BestConnectedEverStrategy;\n\tfunction connect(strategies, minPriority, callbackBuilder) {\n\t    var runners = Collections.map(strategies, function (strategy, i, _, rs) {\n\t        return strategy.connect(minPriority, callbackBuilder(i, rs));\n\t    });\n\t    return {\n\t        abort: function () {\n\t            Collections.apply(runners, abortRunner);\n\t        },\n\t        forceMinPriority: function (p) {\n\t            Collections.apply(runners, function (runner) {\n\t                runner.forceMinPriority(p);\n\t            });\n\t        }\n\t    };\n\t}\n\tfunction allRunnersFailed(runners) {\n\t    return Collections.all(runners, function (runner) {\n\t        return Boolean(runner.error);\n\t    });\n\t}\n\tfunction abortRunner(runner) {\n\t    if (!runner.error && !runner.aborted) {\n\t        runner.abort();\n\t        runner.aborted = true;\n\t    }\n\t}\n\n\n/***/ }),\n/* 58 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar util_1 = __webpack_require__(11);\n\tvar runtime_1 = __webpack_require__(2);\n\tvar sequential_strategy_1 = __webpack_require__(56);\n\tvar Collections = __webpack_require__(9);\n\tvar CachedStrategy = (function () {\n\t    function CachedStrategy(strategy, transports, options) {\n\t        this.strategy = strategy;\n\t        this.transports = transports;\n\t        this.ttl = options.ttl || 1800 * 1000;\n\t        this.encrypted = options.encrypted;\n\t        this.timeline = options.timeline;\n\t    }\n\t    CachedStrategy.prototype.isSupported = function () {\n\t        return this.strategy.isSupported();\n\t    };\n\t    CachedStrategy.prototype.connect = function (minPriority, callback) {\n\t        var encrypted = this.encrypted;\n\t        var info = fetchTransportCache(encrypted);\n\t        var strategies = [this.strategy];\n\t        if (info && info.timestamp + this.ttl >= util_1[\"default\"].now()) {\n\t            var transport = this.transports[info.transport];\n\t            if (transport) {\n\t                this.timeline.info({\n\t                    cached: true,\n\t                    transport: info.transport,\n\t                    latency: info.latency\n\t                });\n\t                strategies.push(new sequential_strategy_1[\"default\"]([transport], {\n\t                    timeout: info.latency * 2 + 1000,\n\t                    failFast: true\n\t                }));\n\t            }\n\t        }\n\t        var startTimestamp = util_1[\"default\"].now();\n\t        var runner = strategies.pop().connect(minPriority, function cb(error, handshake) {\n\t            if (error) {\n\t                flushTransportCache(encrypted);\n\t                if (strategies.length > 0) {\n\t                    startTimestamp = util_1[\"default\"].now();\n\t                    runner = strategies.pop().connect(minPriority, cb);\n\t                }\n\t                else {\n\t                    callback(error);\n\t                }\n\t            }\n\t            else {\n\t                storeTransportCache(encrypted, handshake.transport.name, util_1[\"default\"].now() - startTimestamp);\n\t                callback(null, handshake);\n\t            }\n\t        });\n\t        return {\n\t            abort: function () {\n\t                runner.abort();\n\t            },\n\t            forceMinPriority: function (p) {\n\t                minPriority = p;\n\t                if (runner) {\n\t                    runner.forceMinPriority(p);\n\t                }\n\t            }\n\t        };\n\t    };\n\t    return CachedStrategy;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = CachedStrategy;\n\tfunction getTransportCacheKey(encrypted) {\n\t    return \"pusherTransport\" + (encrypted ? \"Encrypted\" : \"Unencrypted\");\n\t}\n\tfunction fetchTransportCache(encrypted) {\n\t    var storage = runtime_1[\"default\"].getLocalStorage();\n\t    if (storage) {\n\t        try {\n\t            var serializedCache = storage[getTransportCacheKey(encrypted)];\n\t            if (serializedCache) {\n\t                return JSON.parse(serializedCache);\n\t            }\n\t        }\n\t        catch (e) {\n\t            flushTransportCache(encrypted);\n\t        }\n\t    }\n\t    return null;\n\t}\n\tfunction storeTransportCache(encrypted, transport, latency) {\n\t    var storage = runtime_1[\"default\"].getLocalStorage();\n\t    if (storage) {\n\t        try {\n\t            storage[getTransportCacheKey(encrypted)] = Collections.safeJSONStringify({\n\t                timestamp: util_1[\"default\"].now(),\n\t                transport: transport,\n\t                latency: latency\n\t            });\n\t        }\n\t        catch (e) {\n\t        }\n\t    }\n\t}\n\tfunction flushTransportCache(encrypted) {\n\t    var storage = runtime_1[\"default\"].getLocalStorage();\n\t    if (storage) {\n\t        try {\n\t            delete storage[getTransportCacheKey(encrypted)];\n\t        }\n\t        catch (e) {\n\t        }\n\t    }\n\t}\n\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar timers_1 = __webpack_require__(12);\n\tvar DelayedStrategy = (function () {\n\t    function DelayedStrategy(strategy, _a) {\n\t        var number = _a.delay;\n\t        this.strategy = strategy;\n\t        this.options = { delay: number };\n\t    }\n\t    DelayedStrategy.prototype.isSupported = function () {\n\t        return this.strategy.isSupported();\n\t    };\n\t    DelayedStrategy.prototype.connect = function (minPriority, callback) {\n\t        var strategy = this.strategy;\n\t        var runner;\n\t        var timer = new timers_1.OneOffTimer(this.options.delay, function () {\n\t            runner = strategy.connect(minPriority, callback);\n\t        });\n\t        return {\n\t            abort: function () {\n\t                timer.ensureAborted();\n\t                if (runner) {\n\t                    runner.abort();\n\t                }\n\t            },\n\t            forceMinPriority: function (p) {\n\t                minPriority = p;\n\t                if (runner) {\n\t                    runner.forceMinPriority(p);\n\t                }\n\t            }\n\t        };\n\t    };\n\t    return DelayedStrategy;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = DelayedStrategy;\n\n\n/***/ }),\n/* 60 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar IfStrategy = (function () {\n\t    function IfStrategy(test, trueBranch, falseBranch) {\n\t        this.test = test;\n\t        this.trueBranch = trueBranch;\n\t        this.falseBranch = falseBranch;\n\t    }\n\t    IfStrategy.prototype.isSupported = function () {\n\t        var branch = this.test() ? this.trueBranch : this.falseBranch;\n\t        return branch.isSupported();\n\t    };\n\t    IfStrategy.prototype.connect = function (minPriority, callback) {\n\t        var branch = this.test() ? this.trueBranch : this.falseBranch;\n\t        return branch.connect(minPriority, callback);\n\t    };\n\t    return IfStrategy;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = IfStrategy;\n\n\n/***/ }),\n/* 61 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tvar FirstConnectedStrategy = (function () {\n\t    function FirstConnectedStrategy(strategy) {\n\t        this.strategy = strategy;\n\t    }\n\t    FirstConnectedStrategy.prototype.isSupported = function () {\n\t        return this.strategy.isSupported();\n\t    };\n\t    FirstConnectedStrategy.prototype.connect = function (minPriority, callback) {\n\t        var runner = this.strategy.connect(minPriority, function (error, handshake) {\n\t            if (handshake) {\n\t                runner.abort();\n\t            }\n\t            callback(error, handshake);\n\t        });\n\t        return runner;\n\t    };\n\t    return FirstConnectedStrategy;\n\t}());\n\texports.__esModule = true;\n\texports[\"default\"] = FirstConnectedStrategy;\n\n\n/***/ }),\n/* 62 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar defaults_1 = __webpack_require__(5);\n\texports.getGlobalConfig = function () {\n\t    return {\n\t        wsHost: defaults_1[\"default\"].host,\n\t        wsPort: defaults_1[\"default\"].ws_port,\n\t        wssPort: defaults_1[\"default\"].wss_port,\n\t        httpHost: defaults_1[\"default\"].sockjs_host,\n\t        httpPort: defaults_1[\"default\"].sockjs_http_port,\n\t        httpsPort: defaults_1[\"default\"].sockjs_https_port,\n\t        httpPath: defaults_1[\"default\"].sockjs_path,\n\t        statsHost: defaults_1[\"default\"].stats_host,\n\t        authEndpoint: defaults_1[\"default\"].channel_auth_endpoint,\n\t        authTransport: defaults_1[\"default\"].channel_auth_transport,\n\t        activity_timeout: defaults_1[\"default\"].activity_timeout,\n\t        pong_timeout: defaults_1[\"default\"].pong_timeout,\n\t        unavailable_timeout: defaults_1[\"default\"].unavailable_timeout\n\t    };\n\t};\n\texports.getClusterConfig = function (clusterName) {\n\t    return {\n\t        wsHost: \"ws-\" + clusterName + \".pusher.com\",\n\t        httpHost: \"sockjs-\" + clusterName + \".pusher.com\"\n\t    };\n\t};\n\n\n/***/ })\n/******/ ])\n});\n;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL34vcHVzaGVyLWpzL2Rpc3Qvd2ViL3B1c2hlci5qcz9iM2ViIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogUHVzaGVyIEphdmFTY3JpcHQgTGlicmFyeSB2NC4xLjBcbiAqIGh0dHBzOi8vcHVzaGVyLmNvbS9cbiAqXG4gKiBDb3B5cmlnaHQgMjAxNywgUHVzaGVyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2VuY2UuXG4gKi9cblxuKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiUHVzaGVyXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIlB1c2hlclwiXSA9IGZhY3RvcnkoKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG5cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG5cblxuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBwdXNoZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdG1vZHVsZS5leHBvcnRzID0gcHVzaGVyXzFbXCJkZWZhdWx0XCJdO1xuXG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgcnVudGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIENvbGxlY3Rpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0dmFyIGRpc3BhdGNoZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpO1xuXHR2YXIgdGltZWxpbmVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMzgpO1xuXHR2YXIgbGV2ZWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMzkpO1xuXHR2YXIgU3RyYXRlZ3lCdWlsZGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7XG5cdHZhciB0aW1lcnNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpO1xuXHR2YXIgZGVmYXVsdHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG5cdHZhciBEZWZhdWx0Q29uZmlnID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Mik7XG5cdHZhciBsb2dnZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cdHZhciBmYWN0b3J5XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKTtcblx0dmFyIFB1c2hlciA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBQdXNoZXIoYXBwX2tleSwgb3B0aW9ucykge1xuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdCAgICAgICAgY2hlY2tBcHBLZXkoYXBwX2tleSk7XG5cdCAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICAgICAgdGhpcy5rZXkgPSBhcHBfa2V5O1xuXHQgICAgICAgIHRoaXMuY29uZmlnID0gQ29sbGVjdGlvbnMuZXh0ZW5kKERlZmF1bHRDb25maWcuZ2V0R2xvYmFsQ29uZmlnKCksIG9wdGlvbnMuY2x1c3RlciA/IERlZmF1bHRDb25maWcuZ2V0Q2x1c3RlckNvbmZpZyhvcHRpb25zLmNsdXN0ZXIpIDoge30sIG9wdGlvbnMpO1xuXHQgICAgICAgIHRoaXMuY2hhbm5lbHMgPSBmYWN0b3J5XzFbXCJkZWZhdWx0XCJdLmNyZWF0ZUNoYW5uZWxzKCk7XG5cdCAgICAgICAgdGhpcy5nbG9iYWxfZW1pdHRlciA9IG5ldyBkaXNwYXRjaGVyXzFbXCJkZWZhdWx0XCJdKCk7XG5cdCAgICAgICAgdGhpcy5zZXNzaW9uSUQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMDAwKTtcblx0ICAgICAgICB0aGlzLnRpbWVsaW5lID0gbmV3IHRpbWVsaW5lXzFbXCJkZWZhdWx0XCJdKHRoaXMua2V5LCB0aGlzLnNlc3Npb25JRCwge1xuXHQgICAgICAgICAgICBjbHVzdGVyOiB0aGlzLmNvbmZpZy5jbHVzdGVyLFxuXHQgICAgICAgICAgICBmZWF0dXJlczogUHVzaGVyLmdldENsaWVudEZlYXR1cmVzKCksXG5cdCAgICAgICAgICAgIHBhcmFtczogdGhpcy5jb25maWcudGltZWxpbmVQYXJhbXMgfHwge30sXG5cdCAgICAgICAgICAgIGxpbWl0OiA1MCxcblx0ICAgICAgICAgICAgbGV2ZWw6IGxldmVsXzFbXCJkZWZhdWx0XCJdLklORk8sXG5cdCAgICAgICAgICAgIHZlcnNpb246IGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLlZFUlNJT05cblx0ICAgICAgICB9KTtcblx0ICAgICAgICBpZiAoIXRoaXMuY29uZmlnLmRpc2FibGVTdGF0cykge1xuXHQgICAgICAgICAgICB0aGlzLnRpbWVsaW5lU2VuZGVyID0gZmFjdG9yeV8xW1wiZGVmYXVsdFwiXS5jcmVhdGVUaW1lbGluZVNlbmRlcih0aGlzLnRpbWVsaW5lLCB7XG5cdCAgICAgICAgICAgICAgICBob3N0OiB0aGlzLmNvbmZpZy5zdGF0c0hvc3QsXG5cdCAgICAgICAgICAgICAgICBwYXRoOiBcIi90aW1lbGluZS92Mi9cIiArIHJ1bnRpbWVfMVtcImRlZmF1bHRcIl0uVGltZWxpbmVUcmFuc3BvcnQubmFtZVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyIGdldFN0cmF0ZWd5ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcblx0ICAgICAgICAgICAgdmFyIGNvbmZpZyA9IENvbGxlY3Rpb25zLmV4dGVuZCh7fSwgX3RoaXMuY29uZmlnLCBvcHRpb25zKTtcblx0ICAgICAgICAgICAgcmV0dXJuIFN0cmF0ZWd5QnVpbGRlci5idWlsZChydW50aW1lXzFbXCJkZWZhdWx0XCJdLmdldERlZmF1bHRTdHJhdGVneShjb25maWcpLCBjb25maWcpO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gZmFjdG9yeV8xW1wiZGVmYXVsdFwiXS5jcmVhdGVDb25uZWN0aW9uTWFuYWdlcih0aGlzLmtleSwgQ29sbGVjdGlvbnMuZXh0ZW5kKHsgZ2V0U3RyYXRlZ3k6IGdldFN0cmF0ZWd5LFxuXHQgICAgICAgICAgICB0aW1lbGluZTogdGhpcy50aW1lbGluZSxcblx0ICAgICAgICAgICAgYWN0aXZpdHlUaW1lb3V0OiB0aGlzLmNvbmZpZy5hY3Rpdml0eV90aW1lb3V0LFxuXHQgICAgICAgICAgICBwb25nVGltZW91dDogdGhpcy5jb25maWcucG9uZ190aW1lb3V0LFxuXHQgICAgICAgICAgICB1bmF2YWlsYWJsZVRpbWVvdXQ6IHRoaXMuY29uZmlnLnVuYXZhaWxhYmxlX3RpbWVvdXRcblx0ICAgICAgICB9LCB0aGlzLmNvbmZpZywgeyBlbmNyeXB0ZWQ6IHRoaXMuaXNFbmNyeXB0ZWQoKSB9KSk7XG5cdCAgICAgICAgdGhpcy5jb25uZWN0aW9uLmJpbmQoJ2Nvbm5lY3RlZCcsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgX3RoaXMuc3Vic2NyaWJlQWxsKCk7XG5cdCAgICAgICAgICAgIGlmIChfdGhpcy50aW1lbGluZVNlbmRlcikge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMudGltZWxpbmVTZW5kZXIuc2VuZChfdGhpcy5jb25uZWN0aW9uLmlzRW5jcnlwdGVkKCkpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgdGhpcy5jb25uZWN0aW9uLmJpbmQoJ21lc3NhZ2UnLCBmdW5jdGlvbiAocGFyYW1zKSB7XG5cdCAgICAgICAgICAgIHZhciBpbnRlcm5hbCA9IChwYXJhbXMuZXZlbnQuaW5kZXhPZigncHVzaGVyX2ludGVybmFsOicpID09PSAwKTtcblx0ICAgICAgICAgICAgaWYgKHBhcmFtcy5jaGFubmVsKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgY2hhbm5lbCA9IF90aGlzLmNoYW5uZWwocGFyYW1zLmNoYW5uZWwpO1xuXHQgICAgICAgICAgICAgICAgaWYgKGNoYW5uZWwpIHtcblx0ICAgICAgICAgICAgICAgICAgICBjaGFubmVsLmhhbmRsZUV2ZW50KHBhcmFtcy5ldmVudCwgcGFyYW1zLmRhdGEpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGlmICghaW50ZXJuYWwpIHtcblx0ICAgICAgICAgICAgICAgIF90aGlzLmdsb2JhbF9lbWl0dGVyLmVtaXQocGFyYW1zLmV2ZW50LCBwYXJhbXMuZGF0YSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0ICAgICAgICB0aGlzLmNvbm5lY3Rpb24uYmluZCgnY29ubmVjdGluZycsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgX3RoaXMuY2hhbm5lbHMuZGlzY29ubmVjdCgpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHRoaXMuY29ubmVjdGlvbi5iaW5kKCdkaXNjb25uZWN0ZWQnLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIF90aGlzLmNoYW5uZWxzLmRpc2Nvbm5lY3QoKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgICB0aGlzLmNvbm5lY3Rpb24uYmluZCgnZXJyb3InLCBmdW5jdGlvbiAoZXJyKSB7XG5cdCAgICAgICAgICAgIGxvZ2dlcl8xW1wiZGVmYXVsdFwiXS53YXJuKCdFcnJvcicsIGVycik7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgUHVzaGVyLmluc3RhbmNlcy5wdXNoKHRoaXMpO1xuXHQgICAgICAgIHRoaXMudGltZWxpbmUuaW5mbyh7IGluc3RhbmNlczogUHVzaGVyLmluc3RhbmNlcy5sZW5ndGggfSk7XG5cdCAgICAgICAgaWYgKFB1c2hlci5pc1JlYWR5KSB7XG5cdCAgICAgICAgICAgIHRoaXMuY29ubmVjdCgpO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIFB1c2hlci5yZWFkeSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBQdXNoZXIuaXNSZWFkeSA9IHRydWU7XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBQdXNoZXIuaW5zdGFuY2VzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHQgICAgICAgICAgICBQdXNoZXIuaW5zdGFuY2VzW2ldLmNvbm5lY3QoKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgUHVzaGVyLmxvZyA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG5cdCAgICAgICAgaWYgKFB1c2hlci5sb2dUb0NvbnNvbGUgJiYgKHdpbmRvdykuY29uc29sZSAmJiAod2luZG93KS5jb25zb2xlLmxvZykge1xuXHQgICAgICAgICAgICAod2luZG93KS5jb25zb2xlLmxvZyhtZXNzYWdlKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgUHVzaGVyLmdldENsaWVudEZlYXR1cmVzID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiBDb2xsZWN0aW9ucy5rZXlzKENvbGxlY3Rpb25zLmZpbHRlck9iamVjdCh7IFwid3NcIjogcnVudGltZV8xW1wiZGVmYXVsdFwiXS5UcmFuc3BvcnRzLndzIH0sIGZ1bmN0aW9uICh0KSB7IHJldHVybiB0LmlzU3VwcG9ydGVkKHt9KTsgfSkpO1xuXHQgICAgfTtcblx0ICAgIFB1c2hlci5wcm90b3R5cGUuY2hhbm5lbCA9IGZ1bmN0aW9uIChuYW1lKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuY2hhbm5lbHMuZmluZChuYW1lKTtcblx0ICAgIH07XG5cdCAgICBQdXNoZXIucHJvdG90eXBlLmFsbENoYW5uZWxzID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLmNoYW5uZWxzLmFsbCgpO1xuXHQgICAgfTtcblx0ICAgIFB1c2hlci5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLmNvbm5lY3Rpb24uY29ubmVjdCgpO1xuXHQgICAgICAgIGlmICh0aGlzLnRpbWVsaW5lU2VuZGVyKSB7XG5cdCAgICAgICAgICAgIGlmICghdGhpcy50aW1lbGluZVNlbmRlclRpbWVyKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgZW5jcnlwdGVkID0gdGhpcy5jb25uZWN0aW9uLmlzRW5jcnlwdGVkKCk7XG5cdCAgICAgICAgICAgICAgICB2YXIgdGltZWxpbmVTZW5kZXIgPSB0aGlzLnRpbWVsaW5lU2VuZGVyO1xuXHQgICAgICAgICAgICAgICAgdGhpcy50aW1lbGluZVNlbmRlclRpbWVyID0gbmV3IHRpbWVyc18xLlBlcmlvZGljVGltZXIoNjAwMDAsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aW1lbGluZVNlbmRlci5zZW5kKGVuY3J5cHRlZCk7XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBQdXNoZXIucHJvdG90eXBlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5jb25uZWN0aW9uLmRpc2Nvbm5lY3QoKTtcblx0ICAgICAgICBpZiAodGhpcy50aW1lbGluZVNlbmRlclRpbWVyKSB7XG5cdCAgICAgICAgICAgIHRoaXMudGltZWxpbmVTZW5kZXJUaW1lci5lbnN1cmVBYm9ydGVkKCk7XG5cdCAgICAgICAgICAgIHRoaXMudGltZWxpbmVTZW5kZXJUaW1lciA9IG51bGw7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIFB1c2hlci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChldmVudF9uYW1lLCBjYWxsYmFjaywgY29udGV4dCkge1xuXHQgICAgICAgIHRoaXMuZ2xvYmFsX2VtaXR0ZXIuYmluZChldmVudF9uYW1lLCBjYWxsYmFjaywgY29udGV4dCk7XG5cdCAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9O1xuXHQgICAgUHVzaGVyLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoZXZlbnRfbmFtZSwgY2FsbGJhY2ssIGNvbnRleHQpIHtcblx0ICAgICAgICB0aGlzLmdsb2JhbF9lbWl0dGVyLnVuYmluZChldmVudF9uYW1lLCBjYWxsYmFjaywgY29udGV4dCk7XG5cdCAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9O1xuXHQgICAgUHVzaGVyLnByb3RvdHlwZS5iaW5kX2dsb2JhbCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuXHQgICAgICAgIHRoaXMuZ2xvYmFsX2VtaXR0ZXIuYmluZF9nbG9iYWwoY2FsbGJhY2spO1xuXHQgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfTtcblx0ICAgIFB1c2hlci5wcm90b3R5cGUudW5iaW5kX2dsb2JhbCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuXHQgICAgICAgIHRoaXMuZ2xvYmFsX2VtaXR0ZXIudW5iaW5kX2dsb2JhbChjYWxsYmFjayk7XG5cdCAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9O1xuXHQgICAgUHVzaGVyLnByb3RvdHlwZS51bmJpbmRfYWxsID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG5cdCAgICAgICAgdGhpcy5nbG9iYWxfZW1pdHRlci51bmJpbmRfYWxsKCk7XG5cdCAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9O1xuXHQgICAgUHVzaGVyLnByb3RvdHlwZS5zdWJzY3JpYmVBbGwgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGNoYW5uZWxOYW1lO1xuXHQgICAgICAgIGZvciAoY2hhbm5lbE5hbWUgaW4gdGhpcy5jaGFubmVscy5jaGFubmVscykge1xuXHQgICAgICAgICAgICBpZiAodGhpcy5jaGFubmVscy5jaGFubmVscy5oYXNPd25Qcm9wZXJ0eShjaGFubmVsTmFtZSkpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlKGNoYW5uZWxOYW1lKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBQdXNoZXIucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChjaGFubmVsX25hbWUpIHtcblx0ICAgICAgICB2YXIgY2hhbm5lbCA9IHRoaXMuY2hhbm5lbHMuYWRkKGNoYW5uZWxfbmFtZSwgdGhpcyk7XG5cdCAgICAgICAgaWYgKGNoYW5uZWwuc3Vic2NyaXB0aW9uUGVuZGluZyAmJiBjaGFubmVsLnN1YnNjcmlwdGlvbkNhbmNlbGxlZCkge1xuXHQgICAgICAgICAgICBjaGFubmVsLnJlaW5zdGF0ZVN1YnNjcmlwdGlvbigpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIGlmICghY2hhbm5lbC5zdWJzY3JpcHRpb25QZW5kaW5nICYmIHRoaXMuY29ubmVjdGlvbi5zdGF0ZSA9PT0gXCJjb25uZWN0ZWRcIikge1xuXHQgICAgICAgICAgICBjaGFubmVsLnN1YnNjcmliZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gY2hhbm5lbDtcblx0ICAgIH07XG5cdCAgICBQdXNoZXIucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKGNoYW5uZWxfbmFtZSkge1xuXHQgICAgICAgIHZhciBjaGFubmVsID0gdGhpcy5jaGFubmVscy5maW5kKGNoYW5uZWxfbmFtZSk7XG5cdCAgICAgICAgaWYgKGNoYW5uZWwgJiYgY2hhbm5lbC5zdWJzY3JpcHRpb25QZW5kaW5nKSB7XG5cdCAgICAgICAgICAgIGNoYW5uZWwuY2FuY2VsU3Vic2NyaXB0aW9uKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICBjaGFubmVsID0gdGhpcy5jaGFubmVscy5yZW1vdmUoY2hhbm5lbF9uYW1lKTtcblx0ICAgICAgICAgICAgaWYgKGNoYW5uZWwgJiYgdGhpcy5jb25uZWN0aW9uLnN0YXRlID09PSBcImNvbm5lY3RlZFwiKSB7XG5cdCAgICAgICAgICAgICAgICBjaGFubmVsLnVuc3Vic2NyaWJlKCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgUHVzaGVyLnByb3RvdHlwZS5zZW5kX2V2ZW50ID0gZnVuY3Rpb24gKGV2ZW50X25hbWUsIGRhdGEsIGNoYW5uZWwpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uLnNlbmRfZXZlbnQoZXZlbnRfbmFtZSwgZGF0YSwgY2hhbm5lbCk7XG5cdCAgICB9O1xuXHQgICAgUHVzaGVyLnByb3RvdHlwZS5pc0VuY3J5cHRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAocnVudGltZV8xW1wiZGVmYXVsdFwiXS5nZXRQcm90b2NvbCgpID09PSBcImh0dHBzOlwiKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5jb25maWcuZW5jcnlwdGVkKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgUHVzaGVyLmluc3RhbmNlcyA9IFtdO1xuXHQgICAgUHVzaGVyLmlzUmVhZHkgPSBmYWxzZTtcblx0ICAgIFB1c2hlci5sb2dUb0NvbnNvbGUgPSBmYWxzZTtcblx0ICAgIFB1c2hlci5SdW50aW1lID0gcnVudGltZV8xW1wiZGVmYXVsdFwiXTtcblx0ICAgIFB1c2hlci5TY3JpcHRSZWNlaXZlcnMgPSBydW50aW1lXzFbXCJkZWZhdWx0XCJdLlNjcmlwdFJlY2VpdmVycztcblx0ICAgIFB1c2hlci5EZXBlbmRlbmNpZXNSZWNlaXZlcnMgPSBydW50aW1lXzFbXCJkZWZhdWx0XCJdLkRlcGVuZGVuY2llc1JlY2VpdmVycztcblx0ICAgIFB1c2hlci5hdXRoX2NhbGxiYWNrcyA9IHJ1bnRpbWVfMVtcImRlZmF1bHRcIl0uYXV0aF9jYWxsYmFja3M7XG5cdCAgICByZXR1cm4gUHVzaGVyO1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IFB1c2hlcjtcblx0ZnVuY3Rpb24gY2hlY2tBcHBLZXkoa2V5KSB7XG5cdCAgICBpZiAoa2V5ID09PSBudWxsIHx8IGtleSA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgICAgdGhyb3cgXCJZb3UgbXVzdCBwYXNzIHlvdXIgYXBwIGtleSB3aGVuIHlvdSBpbnN0YW50aWF0ZSBQdXNoZXIuXCI7XG5cdCAgICB9XG5cdH1cblx0cnVudGltZV8xW1wiZGVmYXVsdFwiXS5zZXR1cChQdXNoZXIpO1xuXG5cbi8qKiovIH0pLFxuLyogMiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgZGVwZW5kZW5jaWVzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXHR2YXIgeGhyX2F1dGhfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XG5cdHZhciBqc29ucF9hdXRoXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTtcblx0dmFyIHNjcmlwdF9yZXF1ZXN0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTtcblx0dmFyIGpzb25wX3JlcXVlc3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpO1xuXHR2YXIgc2NyaXB0X3JlY2VpdmVyX2ZhY3RvcnlfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XG5cdHZhciBqc29ucF90aW1lbGluZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7XG5cdHZhciB0cmFuc3BvcnRzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTtcblx0dmFyIG5ldF9pbmZvXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KTtcblx0dmFyIGRlZmF1bHRfc3RyYXRlZ3lfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpO1xuXHR2YXIgdHJhbnNwb3J0X2Nvbm5lY3Rpb25faW5pdGlhbGl6ZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpO1xuXHR2YXIgaHR0cF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCk7XG5cdHZhciBSdW50aW1lID0ge1xuXHQgICAgbmV4dEF1dGhDYWxsYmFja0lEOiAxLFxuXHQgICAgYXV0aF9jYWxsYmFja3M6IHt9LFxuXHQgICAgU2NyaXB0UmVjZWl2ZXJzOiBzY3JpcHRfcmVjZWl2ZXJfZmFjdG9yeV8xLlNjcmlwdFJlY2VpdmVycyxcblx0ICAgIERlcGVuZGVuY2llc1JlY2VpdmVyczogZGVwZW5kZW5jaWVzXzEuRGVwZW5kZW5jaWVzUmVjZWl2ZXJzLFxuXHQgICAgZ2V0RGVmYXVsdFN0cmF0ZWd5OiBkZWZhdWx0X3N0cmF0ZWd5XzFbXCJkZWZhdWx0XCJdLFxuXHQgICAgVHJhbnNwb3J0czogdHJhbnNwb3J0c18xW1wiZGVmYXVsdFwiXSxcblx0ICAgIHRyYW5zcG9ydENvbm5lY3Rpb25Jbml0aWFsaXplcjogdHJhbnNwb3J0X2Nvbm5lY3Rpb25faW5pdGlhbGl6ZXJfMVtcImRlZmF1bHRcIl0sXG5cdCAgICBIVFRQRmFjdG9yeTogaHR0cF8xW1wiZGVmYXVsdFwiXSxcblx0ICAgIFRpbWVsaW5lVHJhbnNwb3J0OiBqc29ucF90aW1lbGluZV8xW1wiZGVmYXVsdFwiXSxcblx0ICAgIGdldFhIUkFQSTogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiB3aW5kb3cuWE1MSHR0cFJlcXVlc3Q7XG5cdCAgICB9LFxuXHQgICAgZ2V0V2ViU29ja2V0QVBJOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHdpbmRvdy5XZWJTb2NrZXQgfHwgd2luZG93Lk1veldlYlNvY2tldDtcblx0ICAgIH0sXG5cdCAgICBzZXR1cDogZnVuY3Rpb24gKFB1c2hlckNsYXNzKSB7XG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0ICAgICAgICB3aW5kb3cuUHVzaGVyID0gUHVzaGVyQ2xhc3M7XG5cdCAgICAgICAgdmFyIGluaXRpYWxpemVPbkRvY3VtZW50Qm9keSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgX3RoaXMub25Eb2N1bWVudEJvZHkoUHVzaGVyQ2xhc3MucmVhZHkpO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgaWYgKCF3aW5kb3cuSlNPTikge1xuXHQgICAgICAgICAgICBkZXBlbmRlbmNpZXNfMS5EZXBlbmRlbmNpZXMubG9hZChcImpzb24yXCIsIHt9LCBpbml0aWFsaXplT25Eb2N1bWVudEJvZHkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgaW5pdGlhbGl6ZU9uRG9jdW1lbnRCb2R5KCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0ICAgIGdldERvY3VtZW50OiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIGRvY3VtZW50O1xuXHQgICAgfSxcblx0ICAgIGdldFByb3RvY29sOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RG9jdW1lbnQoKS5sb2NhdGlvbi5wcm90b2NvbDtcblx0ICAgIH0sXG5cdCAgICBnZXRBdXRob3JpemVyczogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiB7IGFqYXg6IHhocl9hdXRoXzFbXCJkZWZhdWx0XCJdLCBqc29ucDoganNvbnBfYXV0aF8xW1wiZGVmYXVsdFwiXSB9O1xuXHQgICAgfSxcblx0ICAgIG9uRG9jdW1lbnRCb2R5OiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIGlmIChkb2N1bWVudC5ib2R5KSB7XG5cdCAgICAgICAgICAgIGNhbGxiYWNrKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIF90aGlzLm9uRG9jdW1lbnRCb2R5KGNhbGxiYWNrKTtcblx0ICAgICAgICAgICAgfSwgMCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0ICAgIGNyZWF0ZUpTT05QUmVxdWVzdDogZnVuY3Rpb24gKHVybCwgZGF0YSkge1xuXHQgICAgICAgIHJldHVybiBuZXcganNvbnBfcmVxdWVzdF8xW1wiZGVmYXVsdFwiXSh1cmwsIGRhdGEpO1xuXHQgICAgfSxcblx0ICAgIGNyZWF0ZVNjcmlwdFJlcXVlc3Q6IGZ1bmN0aW9uIChzcmMpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IHNjcmlwdF9yZXF1ZXN0XzFbXCJkZWZhdWx0XCJdKHNyYyk7XG5cdCAgICB9LFxuXHQgICAgZ2V0TG9jYWxTdG9yYWdlOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2U7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGNhdGNoIChlKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0ICAgIGNyZWF0ZVhIUjogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICh0aGlzLmdldFhIUkFQSSgpKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVhNTEh0dHBSZXF1ZXN0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVNaWNyb3NvZnRYSFIoKTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHQgICAgY3JlYXRlWE1MSHR0cFJlcXVlc3Q6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzLmdldFhIUkFQSSgpO1xuXHQgICAgICAgIHJldHVybiBuZXcgQ29uc3RydWN0b3IoKTtcblx0ICAgIH0sXG5cdCAgICBjcmVhdGVNaWNyb3NvZnRYSFI6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSFRUUFwiKTtcblx0ICAgIH0sXG5cdCAgICBnZXROZXR3b3JrOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldF9pbmZvXzEuTmV0d29yaztcblx0ICAgIH0sXG5cdCAgICBjcmVhdGVXZWJTb2NrZXQ6IGZ1bmN0aW9uICh1cmwpIHtcblx0ICAgICAgICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzLmdldFdlYlNvY2tldEFQSSgpO1xuXHQgICAgICAgIHJldHVybiBuZXcgQ29uc3RydWN0b3IodXJsKTtcblx0ICAgIH0sXG5cdCAgICBjcmVhdGVTb2NrZXRSZXF1ZXN0OiBmdW5jdGlvbiAobWV0aG9kLCB1cmwpIHtcblx0ICAgICAgICBpZiAodGhpcy5pc1hIUlN1cHBvcnRlZCgpKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLkhUVFBGYWN0b3J5LmNyZWF0ZVhIUihtZXRob2QsIHVybCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2UgaWYgKHRoaXMuaXNYRFJTdXBwb3J0ZWQodXJsLmluZGV4T2YoXCJodHRwczpcIikgPT09IDApKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLkhUVFBGYWN0b3J5LmNyZWF0ZVhEUihtZXRob2QsIHVybCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICB0aHJvdyBcIkNyb3NzLW9yaWdpbiBIVFRQIHJlcXVlc3RzIGFyZSBub3Qgc3VwcG9ydGVkXCI7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0ICAgIGlzWEhSU3VwcG9ydGVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIENvbnN0cnVjdG9yID0gdGhpcy5nZXRYSFJBUEkoKTtcblx0ICAgICAgICByZXR1cm4gQm9vbGVhbihDb25zdHJ1Y3RvcikgJiYgKG5ldyBDb25zdHJ1Y3RvcigpKS53aXRoQ3JlZGVudGlhbHMgIT09IHVuZGVmaW5lZDtcblx0ICAgIH0sXG5cdCAgICBpc1hEUlN1cHBvcnRlZDogZnVuY3Rpb24gKGVuY3J5cHRlZCkge1xuXHQgICAgICAgIHZhciBwcm90b2NvbCA9IGVuY3J5cHRlZCA/IFwiaHR0cHM6XCIgOiBcImh0dHA6XCI7XG5cdCAgICAgICAgdmFyIGRvY3VtZW50UHJvdG9jb2wgPSB0aGlzLmdldFByb3RvY29sKCk7XG5cdCAgICAgICAgcmV0dXJuIEJvb2xlYW4oKHdpbmRvd1snWERvbWFpblJlcXVlc3QnXSkpICYmIGRvY3VtZW50UHJvdG9jb2wgPT09IHByb3RvY29sO1xuXHQgICAgfSxcblx0ICAgIGFkZFVubG9hZExpc3RlbmVyOiBmdW5jdGlvbiAobGlzdGVuZXIpIHtcblx0ICAgICAgICBpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInVubG9hZFwiLCBsaXN0ZW5lciwgZmFsc2UpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIGlmICh3aW5kb3cuYXR0YWNoRXZlbnQgIT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgICAgICB3aW5kb3cuYXR0YWNoRXZlbnQoXCJvbnVubG9hZFwiLCBsaXN0ZW5lcik7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0ICAgIHJlbW92ZVVubG9hZExpc3RlbmVyOiBmdW5jdGlvbiAobGlzdGVuZXIpIHtcblx0ICAgICAgICBpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInVubG9hZFwiLCBsaXN0ZW5lciwgZmFsc2UpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIGlmICh3aW5kb3cuZGV0YWNoRXZlbnQgIT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgICAgICB3aW5kb3cuZGV0YWNoRXZlbnQoXCJvbnVubG9hZFwiLCBsaXN0ZW5lcik7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHR9O1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IFJ1bnRpbWU7XG5cblxuLyoqKi8gfSksXG4vKiAzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBzY3JpcHRfcmVjZWl2ZXJfZmFjdG9yeV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcblx0dmFyIGRlZmF1bHRzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpO1xuXHR2YXIgZGVwZW5kZW5jeV9sb2FkZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XG5cdGV4cG9ydHMuRGVwZW5kZW5jaWVzUmVjZWl2ZXJzID0gbmV3IHNjcmlwdF9yZWNlaXZlcl9mYWN0b3J5XzEuU2NyaXB0UmVjZWl2ZXJGYWN0b3J5KFwiX3B1c2hlcl9kZXBlbmRlbmNpZXNcIiwgXCJQdXNoZXIuRGVwZW5kZW5jaWVzUmVjZWl2ZXJzXCIpO1xuXHRleHBvcnRzLkRlcGVuZGVuY2llcyA9IG5ldyBkZXBlbmRlbmN5X2xvYWRlcl8xW1wiZGVmYXVsdFwiXSh7XG5cdCAgICBjZG5faHR0cDogZGVmYXVsdHNfMVtcImRlZmF1bHRcIl0uY2RuX2h0dHAsXG5cdCAgICBjZG5faHR0cHM6IGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLmNkbl9odHRwcyxcblx0ICAgIHZlcnNpb246IGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLlZFUlNJT04sXG5cdCAgICBzdWZmaXg6IGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLmRlcGVuZGVuY3lfc3VmZml4LFxuXHQgICAgcmVjZWl2ZXJzOiBleHBvcnRzLkRlcGVuZGVuY2llc1JlY2VpdmVyc1xuXHR9KTtcblxuXG4vKioqLyB9KSxcbi8qIDQgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIFNjcmlwdFJlY2VpdmVyRmFjdG9yeSA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBTY3JpcHRSZWNlaXZlckZhY3RvcnkocHJlZml4LCBuYW1lKSB7XG5cdCAgICAgICAgdGhpcy5sYXN0SWQgPSAwO1xuXHQgICAgICAgIHRoaXMucHJlZml4ID0gcHJlZml4O1xuXHQgICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG5cdCAgICB9XG5cdCAgICBTY3JpcHRSZWNlaXZlckZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuXHQgICAgICAgIHRoaXMubGFzdElkKys7XG5cdCAgICAgICAgdmFyIG51bWJlciA9IHRoaXMubGFzdElkO1xuXHQgICAgICAgIHZhciBpZCA9IHRoaXMucHJlZml4ICsgbnVtYmVyO1xuXHQgICAgICAgIHZhciBuYW1lID0gdGhpcy5uYW1lICsgXCJbXCIgKyBudW1iZXIgKyBcIl1cIjtcblx0ICAgICAgICB2YXIgY2FsbGVkID0gZmFsc2U7XG5cdCAgICAgICAgdmFyIGNhbGxiYWNrV3JhcHBlciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgaWYgKCFjYWxsZWQpIHtcblx0ICAgICAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG5cdCAgICAgICAgICAgICAgICBjYWxsZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB0aGlzW251bWJlcl0gPSBjYWxsYmFja1dyYXBwZXI7XG5cdCAgICAgICAgcmV0dXJuIHsgbnVtYmVyOiBudW1iZXIsIGlkOiBpZCwgbmFtZTogbmFtZSwgY2FsbGJhY2s6IGNhbGxiYWNrV3JhcHBlciB9O1xuXHQgICAgfTtcblx0ICAgIFNjcmlwdFJlY2VpdmVyRmFjdG9yeS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKHJlY2VpdmVyKSB7XG5cdCAgICAgICAgZGVsZXRlIHRoaXNbcmVjZWl2ZXIubnVtYmVyXTtcblx0ICAgIH07XG5cdCAgICByZXR1cm4gU2NyaXB0UmVjZWl2ZXJGYWN0b3J5O1xuXHR9KCkpO1xuXHRleHBvcnRzLlNjcmlwdFJlY2VpdmVyRmFjdG9yeSA9IFNjcmlwdFJlY2VpdmVyRmFjdG9yeTtcblx0ZXhwb3J0cy5TY3JpcHRSZWNlaXZlcnMgPSBuZXcgU2NyaXB0UmVjZWl2ZXJGYWN0b3J5KFwiX3B1c2hlcl9zY3JpcHRfXCIsIFwiUHVzaGVyLlNjcmlwdFJlY2VpdmVyc1wiKTtcblxuXG4vKioqLyB9KSxcbi8qIDUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIERlZmF1bHRzID0ge1xuXHQgICAgVkVSU0lPTjogXCI0LjEuMFwiLFxuXHQgICAgUFJPVE9DT0w6IDcsXG5cdCAgICBob3N0OiAnd3MucHVzaGVyYXBwLmNvbScsXG5cdCAgICB3c19wb3J0OiA4MCxcblx0ICAgIHdzc19wb3J0OiA0NDMsXG5cdCAgICBzb2NranNfaG9zdDogJ3NvY2tqcy5wdXNoZXIuY29tJyxcblx0ICAgIHNvY2tqc19odHRwX3BvcnQ6IDgwLFxuXHQgICAgc29ja2pzX2h0dHBzX3BvcnQ6IDQ0Myxcblx0ICAgIHNvY2tqc19wYXRoOiBcIi9wdXNoZXJcIixcblx0ICAgIHN0YXRzX2hvc3Q6ICdzdGF0cy5wdXNoZXIuY29tJyxcblx0ICAgIGNoYW5uZWxfYXV0aF9lbmRwb2ludDogJy9wdXNoZXIvYXV0aCcsXG5cdCAgICBjaGFubmVsX2F1dGhfdHJhbnNwb3J0OiAnYWpheCcsXG5cdCAgICBhY3Rpdml0eV90aW1lb3V0OiAxMjAwMDAsXG5cdCAgICBwb25nX3RpbWVvdXQ6IDMwMDAwLFxuXHQgICAgdW5hdmFpbGFibGVfdGltZW91dDogMTAwMDAsXG5cdCAgICBjZG5faHR0cDogJ2h0dHA6Ly9qcy5wdXNoZXIuY29tJyxcblx0ICAgIGNkbl9odHRwczogJ2h0dHBzOi8vanMucHVzaGVyLmNvbScsXG5cdCAgICBkZXBlbmRlbmN5X3N1ZmZpeDogJydcblx0fTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBEZWZhdWx0cztcblxuXG4vKioqLyB9KSxcbi8qIDYgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIHNjcmlwdF9yZWNlaXZlcl9mYWN0b3J5XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXHR2YXIgcnVudGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIERlcGVuZGVuY3lMb2FkZXIgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gRGVwZW5kZW5jeUxvYWRlcihvcHRpb25zKSB7XG5cdCAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcblx0ICAgICAgICB0aGlzLnJlY2VpdmVycyA9IG9wdGlvbnMucmVjZWl2ZXJzIHx8IHNjcmlwdF9yZWNlaXZlcl9mYWN0b3J5XzEuU2NyaXB0UmVjZWl2ZXJzO1xuXHQgICAgICAgIHRoaXMubG9hZGluZyA9IHt9O1xuXHQgICAgfVxuXHQgICAgRGVwZW5kZW5jeUxvYWRlci5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChuYW1lLCBvcHRpb25zLCBjYWxsYmFjaykge1xuXHQgICAgICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgICAgICBpZiAoc2VsZi5sb2FkaW5nW25hbWVdICYmIHNlbGYubG9hZGluZ1tuYW1lXS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgIHNlbGYubG9hZGluZ1tuYW1lXS5wdXNoKGNhbGxiYWNrKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgIHNlbGYubG9hZGluZ1tuYW1lXSA9IFtjYWxsYmFja107XG5cdCAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gcnVudGltZV8xW1wiZGVmYXVsdFwiXS5jcmVhdGVTY3JpcHRSZXF1ZXN0KHNlbGYuZ2V0UGF0aChuYW1lLCBvcHRpb25zKSk7XG5cdCAgICAgICAgICAgIHZhciByZWNlaXZlciA9IHNlbGYucmVjZWl2ZXJzLmNyZWF0ZShmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgICAgICAgICAgIHNlbGYucmVjZWl2ZXJzLnJlbW92ZShyZWNlaXZlcik7XG5cdCAgICAgICAgICAgICAgICBpZiAoc2VsZi5sb2FkaW5nW25hbWVdKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGxiYWNrcyA9IHNlbGYubG9hZGluZ1tuYW1lXTtcblx0ICAgICAgICAgICAgICAgICAgICBkZWxldGUgc2VsZi5sb2FkaW5nW25hbWVdO1xuXHQgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzQ2FsbGJhY2sgPSBmdW5jdGlvbiAod2FzU3VjY2Vzc2Z1bCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXdhc1N1Y2Nlc3NmdWwpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3QuY2xlYW51cCgpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhbGxiYWNrcy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3NbaV0oZXJyb3IsIHN1Y2Nlc3NDYWxsYmFjayk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgcmVxdWVzdC5zZW5kKHJlY2VpdmVyKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgRGVwZW5kZW5jeUxvYWRlci5wcm90b3R5cGUuZ2V0Um9vdCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG5cdCAgICAgICAgdmFyIGNkbjtcblx0ICAgICAgICB2YXIgcHJvdG9jb2wgPSBydW50aW1lXzFbXCJkZWZhdWx0XCJdLmdldERvY3VtZW50KCkubG9jYXRpb24ucHJvdG9jb2w7XG5cdCAgICAgICAgaWYgKChvcHRpb25zICYmIG9wdGlvbnMuZW5jcnlwdGVkKSB8fCBwcm90b2NvbCA9PT0gXCJodHRwczpcIikge1xuXHQgICAgICAgICAgICBjZG4gPSB0aGlzLm9wdGlvbnMuY2RuX2h0dHBzO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgY2RuID0gdGhpcy5vcHRpb25zLmNkbl9odHRwO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gY2RuLnJlcGxhY2UoL1xcLyokLywgXCJcIikgKyBcIi9cIiArIHRoaXMub3B0aW9ucy52ZXJzaW9uO1xuXHQgICAgfTtcblx0ICAgIERlcGVuZGVuY3lMb2FkZXIucHJvdG90eXBlLmdldFBhdGggPSBmdW5jdGlvbiAobmFtZSwgb3B0aW9ucykge1xuXHQgICAgICAgIHJldHVybiB0aGlzLmdldFJvb3Qob3B0aW9ucykgKyAnLycgKyBuYW1lICsgdGhpcy5vcHRpb25zLnN1ZmZpeCArICcuanMnO1xuXHQgICAgfTtcblx0ICAgIDtcblx0ICAgIHJldHVybiBEZXBlbmRlbmN5TG9hZGVyO1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IERlcGVuZGVuY3lMb2FkZXI7XG5cblxuLyoqKi8gfSksXG4vKiA3ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBsb2dnZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cdHZhciBydW50aW1lXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHR2YXIgYWpheCA9IGZ1bmN0aW9uIChjb250ZXh0LCBzb2NrZXRJZCwgY2FsbGJhY2spIHtcblx0ICAgIHZhciBzZWxmID0gdGhpcywgeGhyO1xuXHQgICAgeGhyID0gcnVudGltZV8xW1wiZGVmYXVsdFwiXS5jcmVhdGVYSFIoKTtcblx0ICAgIHhoci5vcGVuKFwiUE9TVFwiLCBzZWxmLm9wdGlvbnMuYXV0aEVuZHBvaW50LCB0cnVlKTtcblx0ICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsIFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIpO1xuXHQgICAgZm9yICh2YXIgaGVhZGVyTmFtZSBpbiB0aGlzLmF1dGhPcHRpb25zLmhlYWRlcnMpIHtcblx0ICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihoZWFkZXJOYW1lLCB0aGlzLmF1dGhPcHRpb25zLmhlYWRlcnNbaGVhZGVyTmFtZV0pO1xuXHQgICAgfVxuXHQgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQpIHtcblx0ICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPT09IDIwMCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGRhdGEsIHBhcnNlZCA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTtcblx0ICAgICAgICAgICAgICAgICAgICBwYXJzZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcblx0ICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayh0cnVlLCAnSlNPTiByZXR1cm5lZCBmcm9tIHdlYmFwcCB3YXMgaW52YWxpZCwgeWV0IHN0YXR1cyBjb2RlIHdhcyAyMDAuIERhdGEgd2FzOiAnICsgeGhyLnJlc3BvbnNlVGV4dCk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICBpZiAocGFyc2VkKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZmFsc2UsIGRhdGEpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgbG9nZ2VyXzFbXCJkZWZhdWx0XCJdLndhcm4oXCJDb3VsZG4ndCBnZXQgYXV0aCBpbmZvIGZyb20geW91ciB3ZWJhcHBcIiwgeGhyLnN0YXR1cyk7XG5cdCAgICAgICAgICAgICAgICBjYWxsYmFjayh0cnVlLCB4aHIuc3RhdHVzKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICB4aHIuc2VuZCh0aGlzLmNvbXBvc2VRdWVyeShzb2NrZXRJZCkpO1xuXHQgICAgcmV0dXJuIHhocjtcblx0fTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBhamF4O1xuXG5cbi8qKiovIH0pLFxuLyogOCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgY29sbGVjdGlvbnNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cdHZhciBwdXNoZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdHZhciBMb2dnZXIgPSB7XG5cdCAgICBkZWJ1ZzogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciBhcmdzID0gW107XG5cdCAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcblx0ICAgICAgICAgICAgYXJnc1tfaSAtIDBdID0gYXJndW1lbnRzW19pXTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKCFwdXNoZXJfMVtcImRlZmF1bHRcIl0ubG9nKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcHVzaGVyXzFbXCJkZWZhdWx0XCJdLmxvZyhjb2xsZWN0aW9uc18xLnN0cmluZ2lmeS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcblx0ICAgIH0sXG5cdCAgICB3YXJuOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGFyZ3MgPSBbXTtcblx0ICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuXHQgICAgICAgICAgICBhcmdzW19pIC0gMF0gPSBhcmd1bWVudHNbX2ldO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB2YXIgbWVzc2FnZSA9IGNvbGxlY3Rpb25zXzEuc3RyaW5naWZ5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICAgICAgaWYgKCh3aW5kb3cpLmNvbnNvbGUpIHtcblx0ICAgICAgICAgICAgaWYgKCh3aW5kb3cpLmNvbnNvbGUud2Fybikge1xuXHQgICAgICAgICAgICAgICAgKHdpbmRvdykuY29uc29sZS53YXJuKG1lc3NhZ2UpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGVsc2UgaWYgKCh3aW5kb3cpLmNvbnNvbGUubG9nKSB7XG5cdCAgICAgICAgICAgICAgICAod2luZG93KS5jb25zb2xlLmxvZyhtZXNzYWdlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAocHVzaGVyXzFbXCJkZWZhdWx0XCJdLmxvZykge1xuXHQgICAgICAgICAgICBwdXNoZXJfMVtcImRlZmF1bHRcIl0ubG9nKG1lc3NhZ2UpO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0fTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBMb2dnZXI7XG5cblxuLyoqKi8gfSksXG4vKiA5ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBiYXNlNjRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTApO1xuXHR2YXIgdXRpbF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7XG5cdGZ1bmN0aW9uIGV4dGVuZCh0YXJnZXQpIHtcblx0ICAgIHZhciBzb3VyY2VzID0gW107XG5cdCAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuXHQgICAgICAgIHNvdXJjZXNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG5cdCAgICB9XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNvdXJjZXMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICB2YXIgZXh0ZW5zaW9ucyA9IHNvdXJjZXNbaV07XG5cdCAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gZXh0ZW5zaW9ucykge1xuXHQgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uc1twcm9wZXJ0eV0gJiYgZXh0ZW5zaW9uc1twcm9wZXJ0eV0uY29uc3RydWN0b3IgJiZcblx0ICAgICAgICAgICAgICAgIGV4dGVuc2lvbnNbcHJvcGVydHldLmNvbnN0cnVjdG9yID09PSBPYmplY3QpIHtcblx0ICAgICAgICAgICAgICAgIHRhcmdldFtwcm9wZXJ0eV0gPSBleHRlbmQodGFyZ2V0W3Byb3BlcnR5XSB8fCB7fSwgZXh0ZW5zaW9uc1twcm9wZXJ0eV0pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgdGFyZ2V0W3Byb3BlcnR5XSA9IGV4dGVuc2lvbnNbcHJvcGVydHldO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIHRhcmdldDtcblx0fVxuXHRleHBvcnRzLmV4dGVuZCA9IGV4dGVuZDtcblx0ZnVuY3Rpb24gc3RyaW5naWZ5KCkge1xuXHQgICAgdmFyIG0gPSBbXCJQdXNoZXJcIl07XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIGlmICh0eXBlb2YgYXJndW1lbnRzW2ldID09PSBcInN0cmluZ1wiKSB7XG5cdCAgICAgICAgICAgIG0ucHVzaChhcmd1bWVudHNbaV0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgbS5wdXNoKHNhZmVKU09OU3RyaW5naWZ5KGFyZ3VtZW50c1tpXSkpO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIHJldHVybiBtLmpvaW4oXCIgOiBcIik7XG5cdH1cblx0ZXhwb3J0cy5zdHJpbmdpZnkgPSBzdHJpbmdpZnk7XG5cdGZ1bmN0aW9uIGFycmF5SW5kZXhPZihhcnJheSwgaXRlbSkge1xuXHQgICAgdmFyIG5hdGl2ZUluZGV4T2YgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZjtcblx0ICAgIGlmIChhcnJheSA9PT0gbnVsbCkge1xuXHQgICAgICAgIHJldHVybiAtMTtcblx0ICAgIH1cblx0ICAgIGlmIChuYXRpdmVJbmRleE9mICYmIGFycmF5LmluZGV4T2YgPT09IG5hdGl2ZUluZGV4T2YpIHtcblx0ICAgICAgICByZXR1cm4gYXJyYXkuaW5kZXhPZihpdGVtKTtcblx0ICAgIH1cblx0ICAgIGZvciAodmFyIGkgPSAwLCBsID0gYXJyYXkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG5cdCAgICAgICAgaWYgKGFycmF5W2ldID09PSBpdGVtKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBpO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIHJldHVybiAtMTtcblx0fVxuXHRleHBvcnRzLmFycmF5SW5kZXhPZiA9IGFycmF5SW5kZXhPZjtcblx0ZnVuY3Rpb24gb2JqZWN0QXBwbHkob2JqZWN0LCBmKSB7XG5cdCAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG5cdCAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkpIHtcblx0ICAgICAgICAgICAgZihvYmplY3Rba2V5XSwga2V5LCBvYmplY3QpO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0fVxuXHRleHBvcnRzLm9iamVjdEFwcGx5ID0gb2JqZWN0QXBwbHk7XG5cdGZ1bmN0aW9uIGtleXMob2JqZWN0KSB7XG5cdCAgICB2YXIga2V5cyA9IFtdO1xuXHQgICAgb2JqZWN0QXBwbHkob2JqZWN0LCBmdW5jdGlvbiAoXywga2V5KSB7XG5cdCAgICAgICAga2V5cy5wdXNoKGtleSk7XG5cdCAgICB9KTtcblx0ICAgIHJldHVybiBrZXlzO1xuXHR9XG5cdGV4cG9ydHMua2V5cyA9IGtleXM7XG5cdGZ1bmN0aW9uIHZhbHVlcyhvYmplY3QpIHtcblx0ICAgIHZhciB2YWx1ZXMgPSBbXTtcblx0ICAgIG9iamVjdEFwcGx5KG9iamVjdCwgZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgdmFsdWVzLnB1c2godmFsdWUpO1xuXHQgICAgfSk7XG5cdCAgICByZXR1cm4gdmFsdWVzO1xuXHR9XG5cdGV4cG9ydHMudmFsdWVzID0gdmFsdWVzO1xuXHRmdW5jdGlvbiBhcHBseShhcnJheSwgZiwgY29udGV4dCkge1xuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIGYuY2FsbChjb250ZXh0IHx8ICh3aW5kb3cpLCBhcnJheVtpXSwgaSwgYXJyYXkpO1xuXHQgICAgfVxuXHR9XG5cdGV4cG9ydHMuYXBwbHkgPSBhcHBseTtcblx0ZnVuY3Rpb24gbWFwKGFycmF5LCBmKSB7XG5cdCAgICB2YXIgcmVzdWx0ID0gW107XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgcmVzdWx0LnB1c2goZihhcnJheVtpXSwgaSwgYXJyYXksIHJlc3VsdCkpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIHJlc3VsdDtcblx0fVxuXHRleHBvcnRzLm1hcCA9IG1hcDtcblx0ZnVuY3Rpb24gbWFwT2JqZWN0KG9iamVjdCwgZikge1xuXHQgICAgdmFyIHJlc3VsdCA9IHt9O1xuXHQgICAgb2JqZWN0QXBwbHkob2JqZWN0LCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuXHQgICAgICAgIHJlc3VsdFtrZXldID0gZih2YWx1ZSk7XG5cdCAgICB9KTtcblx0ICAgIHJldHVybiByZXN1bHQ7XG5cdH1cblx0ZXhwb3J0cy5tYXBPYmplY3QgPSBtYXBPYmplY3Q7XG5cdGZ1bmN0aW9uIGZpbHRlcihhcnJheSwgdGVzdCkge1xuXHQgICAgdGVzdCA9IHRlc3QgfHwgZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAhIXZhbHVlOyB9O1xuXHQgICAgdmFyIHJlc3VsdCA9IFtdO1xuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIGlmICh0ZXN0KGFycmF5W2ldLCBpLCBhcnJheSwgcmVzdWx0KSkge1xuXHQgICAgICAgICAgICByZXN1bHQucHVzaChhcnJheVtpXSk7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIHJlc3VsdDtcblx0fVxuXHRleHBvcnRzLmZpbHRlciA9IGZpbHRlcjtcblx0ZnVuY3Rpb24gZmlsdGVyT2JqZWN0KG9iamVjdCwgdGVzdCkge1xuXHQgICAgdmFyIHJlc3VsdCA9IHt9O1xuXHQgICAgb2JqZWN0QXBwbHkob2JqZWN0LCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuXHQgICAgICAgIGlmICgodGVzdCAmJiB0ZXN0KHZhbHVlLCBrZXksIG9iamVjdCwgcmVzdWx0KSkgfHwgQm9vbGVhbih2YWx1ZSkpIHtcblx0ICAgICAgICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcblx0ICAgICAgICB9XG5cdCAgICB9KTtcblx0ICAgIHJldHVybiByZXN1bHQ7XG5cdH1cblx0ZXhwb3J0cy5maWx0ZXJPYmplY3QgPSBmaWx0ZXJPYmplY3Q7XG5cdGZ1bmN0aW9uIGZsYXR0ZW4ob2JqZWN0KSB7XG5cdCAgICB2YXIgcmVzdWx0ID0gW107XG5cdCAgICBvYmplY3RBcHBseShvYmplY3QsIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG5cdCAgICAgICAgcmVzdWx0LnB1c2goW2tleSwgdmFsdWVdKTtcblx0ICAgIH0pO1xuXHQgICAgcmV0dXJuIHJlc3VsdDtcblx0fVxuXHRleHBvcnRzLmZsYXR0ZW4gPSBmbGF0dGVuO1xuXHRmdW5jdGlvbiBhbnkoYXJyYXksIHRlc3QpIHtcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICBpZiAodGVzdChhcnJheVtpXSwgaSwgYXJyYXkpKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIHJldHVybiBmYWxzZTtcblx0fVxuXHRleHBvcnRzLmFueSA9IGFueTtcblx0ZnVuY3Rpb24gYWxsKGFycmF5LCB0ZXN0KSB7XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgaWYgKCF0ZXN0KGFycmF5W2ldLCBpLCBhcnJheSkpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIHJldHVybiB0cnVlO1xuXHR9XG5cdGV4cG9ydHMuYWxsID0gYWxsO1xuXHRmdW5jdGlvbiBlbmNvZGVQYXJhbXNPYmplY3QoZGF0YSkge1xuXHQgICAgcmV0dXJuIG1hcE9iamVjdChkYXRhLCBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiKSB7XG5cdCAgICAgICAgICAgIHZhbHVlID0gc2FmZUpTT05TdHJpbmdpZnkodmFsdWUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGJhc2U2NF8xW1wiZGVmYXVsdFwiXSh2YWx1ZS50b1N0cmluZygpKSk7XG5cdCAgICB9KTtcblx0fVxuXHRleHBvcnRzLmVuY29kZVBhcmFtc09iamVjdCA9IGVuY29kZVBhcmFtc09iamVjdDtcblx0ZnVuY3Rpb24gYnVpbGRRdWVyeVN0cmluZyhkYXRhKSB7XG5cdCAgICB2YXIgcGFyYW1zID0gZmlsdGVyT2JqZWN0KGRhdGEsIGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkO1xuXHQgICAgfSk7XG5cdCAgICB2YXIgcXVlcnkgPSBtYXAoZmxhdHRlbihlbmNvZGVQYXJhbXNPYmplY3QocGFyYW1zKSksIHV0aWxfMVtcImRlZmF1bHRcIl0ubWV0aG9kKFwiam9pblwiLCBcIj1cIikpLmpvaW4oXCImXCIpO1xuXHQgICAgcmV0dXJuIHF1ZXJ5O1xuXHR9XG5cdGV4cG9ydHMuYnVpbGRRdWVyeVN0cmluZyA9IGJ1aWxkUXVlcnlTdHJpbmc7XG5cdGZ1bmN0aW9uIGRlY3ljbGVPYmplY3Qob2JqZWN0KSB7XG5cdCAgICB2YXIgb2JqZWN0cyA9IFtdLCBwYXRocyA9IFtdO1xuXHQgICAgcmV0dXJuIChmdW5jdGlvbiBkZXJleih2YWx1ZSwgcGF0aCkge1xuXHQgICAgICAgIHZhciBpLCBuYW1lLCBudTtcblx0ICAgICAgICBzd2l0Y2ggKHR5cGVvZiB2YWx1ZSkge1xuXHQgICAgICAgICAgICBjYXNlICdvYmplY3QnOlxuXHQgICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG9iamVjdHMubGVuZ3RoOyBpICs9IDEpIHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAob2JqZWN0c1tpXSA9PT0gdmFsdWUpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgJHJlZjogcGF0aHNbaV0gfTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICBvYmplY3RzLnB1c2godmFsdWUpO1xuXHQgICAgICAgICAgICAgICAgcGF0aHMucHVzaChwYXRoKTtcblx0ICAgICAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KHZhbHVlKSA9PT0gJ1tvYmplY3QgQXJyYXldJykge1xuXHQgICAgICAgICAgICAgICAgICAgIG51ID0gW107XG5cdCAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSArPSAxKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIG51W2ldID0gZGVyZXoodmFsdWVbaV0sIHBhdGggKyAnWycgKyBpICsgJ10nKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICBudSA9IHt9O1xuXHQgICAgICAgICAgICAgICAgICAgIGZvciAobmFtZSBpbiB2YWx1ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCBuYW1lKSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVbbmFtZV0gPSBkZXJleih2YWx1ZVtuYW1lXSwgcGF0aCArICdbJyArIEpTT04uc3RyaW5naWZ5KG5hbWUpICsgJ10nKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIHJldHVybiBudTtcblx0ICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzpcblx0ICAgICAgICAgICAgY2FzZSAnc3RyaW5nJzpcblx0ICAgICAgICAgICAgY2FzZSAnYm9vbGVhbic6XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG5cdCAgICAgICAgfVxuXHQgICAgfShvYmplY3QsICckJykpO1xuXHR9XG5cdGV4cG9ydHMuZGVjeWNsZU9iamVjdCA9IGRlY3ljbGVPYmplY3Q7XG5cdGZ1bmN0aW9uIHNhZmVKU09OU3RyaW5naWZ5KHNvdXJjZSkge1xuXHQgICAgdHJ5IHtcblx0ICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoc291cmNlKTtcblx0ICAgIH1cblx0ICAgIGNhdGNoIChlKSB7XG5cdCAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRlY3ljbGVPYmplY3Qoc291cmNlKSk7XG5cdCAgICB9XG5cdH1cblx0ZXhwb3J0cy5zYWZlSlNPTlN0cmluZ2lmeSA9IHNhZmVKU09OU3RyaW5naWZ5O1xuXG5cbi8qKiovIH0pLFxuLyogMTAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0ZnVuY3Rpb24gZW5jb2RlKHMpIHtcblx0ICAgIHJldHVybiBidG9hKHV0b2IocykpO1xuXHR9XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZW5jb2RlO1xuXHR2YXIgZnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZTtcblx0dmFyIGI2NGNoYXJzID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nO1xuXHR2YXIgYjY0dGFiID0ge307XG5cdGZvciAodmFyIGkgPSAwLCBsID0gYjY0Y2hhcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG5cdCAgICBiNjR0YWJbYjY0Y2hhcnMuY2hhckF0KGkpXSA9IGk7XG5cdH1cblx0dmFyIGNiX3V0b2IgPSBmdW5jdGlvbiAoYykge1xuXHQgICAgdmFyIGNjID0gYy5jaGFyQ29kZUF0KDApO1xuXHQgICAgcmV0dXJuIGNjIDwgMHg4MCA/IGNcblx0ICAgICAgICA6IGNjIDwgMHg4MDAgPyBmcm9tQ2hhckNvZGUoMHhjMCB8IChjYyA+Pj4gNikpICtcblx0ICAgICAgICAgICAgZnJvbUNoYXJDb2RlKDB4ODAgfCAoY2MgJiAweDNmKSlcblx0ICAgICAgICAgICAgOiBmcm9tQ2hhckNvZGUoMHhlMCB8ICgoY2MgPj4+IDEyKSAmIDB4MGYpKSArXG5cdCAgICAgICAgICAgICAgICBmcm9tQ2hhckNvZGUoMHg4MCB8ICgoY2MgPj4+IDYpICYgMHgzZikpICtcblx0ICAgICAgICAgICAgICAgIGZyb21DaGFyQ29kZSgweDgwIHwgKGNjICYgMHgzZikpO1xuXHR9O1xuXHR2YXIgdXRvYiA9IGZ1bmN0aW9uICh1KSB7XG5cdCAgICByZXR1cm4gdS5yZXBsYWNlKC9bXlxceDAwLVxceDdGXS9nLCBjYl91dG9iKTtcblx0fTtcblx0dmFyIGNiX2VuY29kZSA9IGZ1bmN0aW9uIChjY2MpIHtcblx0ICAgIHZhciBwYWRsZW4gPSBbMCwgMiwgMV1bY2NjLmxlbmd0aCAlIDNdO1xuXHQgICAgdmFyIG9yZCA9IGNjYy5jaGFyQ29kZUF0KDApIDw8IDE2XG5cdCAgICAgICAgfCAoKGNjYy5sZW5ndGggPiAxID8gY2NjLmNoYXJDb2RlQXQoMSkgOiAwKSA8PCA4KVxuXHQgICAgICAgIHwgKChjY2MubGVuZ3RoID4gMiA/IGNjYy5jaGFyQ29kZUF0KDIpIDogMCkpO1xuXHQgICAgdmFyIGNoYXJzID0gW1xuXHQgICAgICAgIGI2NGNoYXJzLmNoYXJBdChvcmQgPj4+IDE4KSxcblx0ICAgICAgICBiNjRjaGFycy5jaGFyQXQoKG9yZCA+Pj4gMTIpICYgNjMpLFxuXHQgICAgICAgIHBhZGxlbiA+PSAyID8gJz0nIDogYjY0Y2hhcnMuY2hhckF0KChvcmQgPj4+IDYpICYgNjMpLFxuXHQgICAgICAgIHBhZGxlbiA+PSAxID8gJz0nIDogYjY0Y2hhcnMuY2hhckF0KG9yZCAmIDYzKVxuXHQgICAgXTtcblx0ICAgIHJldHVybiBjaGFycy5qb2luKCcnKTtcblx0fTtcblx0dmFyIGJ0b2EgPSAod2luZG93KS5idG9hIHx8IGZ1bmN0aW9uIChiKSB7XG5cdCAgICByZXR1cm4gYi5yZXBsYWNlKC9bXFxzXFxTXXsxLDN9L2csIGNiX2VuY29kZSk7XG5cdH07XG5cblxuLyoqKi8gfSksXG4vKiAxMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgdGltZXJzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKTtcblx0dmFyIFV0aWwgPSB7XG5cdCAgICBub3c6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoRGF0ZS5ub3cpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIERhdGUubm93KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoKS52YWx1ZU9mKCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0ICAgIGRlZmVyOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcblx0ICAgICAgICByZXR1cm4gbmV3IHRpbWVyc18xLk9uZU9mZlRpbWVyKDAsIGNhbGxiYWNrKTtcblx0ICAgIH0sXG5cdCAgICBtZXRob2Q6IGZ1bmN0aW9uIChuYW1lKSB7XG5cdCAgICAgICAgdmFyIGFyZ3MgPSBbXTtcblx0ICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuXHQgICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB2YXIgYm91bmRBcmd1bWVudHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuXHQgICAgICAgIHJldHVybiBmdW5jdGlvbiAob2JqZWN0KSB7XG5cdCAgICAgICAgICAgIHJldHVybiBvYmplY3RbbmFtZV0uYXBwbHkob2JqZWN0LCBib3VuZEFyZ3VtZW50cy5jb25jYXQoYXJndW1lbnRzKSk7XG5cdCAgICAgICAgfTtcblx0ICAgIH1cblx0fTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBVdGlsO1xuXG5cbi8qKiovIH0pLFxuLyogMTIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xuXHQgICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07XG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cblx0ICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcblx0fTtcblx0dmFyIGFic3RyYWN0X3RpbWVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTtcblx0ZnVuY3Rpb24gY2xlYXJUaW1lb3V0KHRpbWVyKSB7XG5cdCAgICAod2luZG93KS5jbGVhclRpbWVvdXQodGltZXIpO1xuXHR9XG5cdGZ1bmN0aW9uIGNsZWFySW50ZXJ2YWwodGltZXIpIHtcblx0ICAgICh3aW5kb3cpLmNsZWFySW50ZXJ2YWwodGltZXIpO1xuXHR9XG5cdHZhciBPbmVPZmZUaW1lciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG5cdCAgICBfX2V4dGVuZHMoT25lT2ZmVGltZXIsIF9zdXBlcik7XG5cdCAgICBmdW5jdGlvbiBPbmVPZmZUaW1lcihkZWxheSwgY2FsbGJhY2spIHtcblx0ICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBzZXRUaW1lb3V0LCBjbGVhclRpbWVvdXQsIGRlbGF5LCBmdW5jdGlvbiAodGltZXIpIHtcblx0ICAgICAgICAgICAgY2FsbGJhY2soKTtcblx0ICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICAgICAgfSk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gT25lT2ZmVGltZXI7XG5cdH0oYWJzdHJhY3RfdGltZXJfMVtcImRlZmF1bHRcIl0pKTtcblx0ZXhwb3J0cy5PbmVPZmZUaW1lciA9IE9uZU9mZlRpbWVyO1xuXHR2YXIgUGVyaW9kaWNUaW1lciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG5cdCAgICBfX2V4dGVuZHMoUGVyaW9kaWNUaW1lciwgX3N1cGVyKTtcblx0ICAgIGZ1bmN0aW9uIFBlcmlvZGljVGltZXIoZGVsYXksIGNhbGxiYWNrKSB7XG5cdCAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgc2V0SW50ZXJ2YWwsIGNsZWFySW50ZXJ2YWwsIGRlbGF5LCBmdW5jdGlvbiAodGltZXIpIHtcblx0ICAgICAgICAgICAgY2FsbGJhY2soKTtcblx0ICAgICAgICAgICAgcmV0dXJuIHRpbWVyO1xuXHQgICAgICAgIH0pO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIFBlcmlvZGljVGltZXI7XG5cdH0oYWJzdHJhY3RfdGltZXJfMVtcImRlZmF1bHRcIl0pKTtcblx0ZXhwb3J0cy5QZXJpb2RpY1RpbWVyID0gUGVyaW9kaWNUaW1lcjtcblxuXG4vKioqLyB9KSxcbi8qIDEzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBUaW1lciA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBUaW1lcihzZXQsIGNsZWFyLCBkZWxheSwgY2FsbGJhY2spIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIHRoaXMuY2xlYXIgPSBjbGVhcjtcblx0ICAgICAgICB0aGlzLnRpbWVyID0gc2V0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgaWYgKF90aGlzLnRpbWVyKSB7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy50aW1lciA9IGNhbGxiYWNrKF90aGlzLnRpbWVyKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0sIGRlbGF5KTtcblx0ICAgIH1cblx0ICAgIFRpbWVyLnByb3RvdHlwZS5pc1J1bm5pbmcgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMudGltZXIgIT09IG51bGw7XG5cdCAgICB9O1xuXHQgICAgVGltZXIucHJvdG90eXBlLmVuc3VyZUFib3J0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKHRoaXMudGltZXIpIHtcblx0ICAgICAgICAgICAgdGhpcy5jbGVhcih0aGlzLnRpbWVyKTtcblx0ICAgICAgICAgICAgdGhpcy50aW1lciA9IG51bGw7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIHJldHVybiBUaW1lcjtcblx0fSgpKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBUaW1lcjtcblxuXG4vKioqLyB9KSxcbi8qIDE0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBsb2dnZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cdHZhciBqc29ucCA9IGZ1bmN0aW9uIChjb250ZXh0LCBzb2NrZXRJZCwgY2FsbGJhY2spIHtcblx0ICAgIGlmICh0aGlzLmF1dGhPcHRpb25zLmhlYWRlcnMgIT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgIGxvZ2dlcl8xW1wiZGVmYXVsdFwiXS53YXJuKFwiV2FyblwiLCBcIlRvIHNlbmQgaGVhZGVycyB3aXRoIHRoZSBhdXRoIHJlcXVlc3QsIHlvdSBtdXN0IHVzZSBBSkFYLCByYXRoZXIgdGhhbiBKU09OUC5cIik7XG5cdCAgICB9XG5cdCAgICB2YXIgY2FsbGJhY2tOYW1lID0gY29udGV4dC5uZXh0QXV0aENhbGxiYWNrSUQudG9TdHJpbmcoKTtcblx0ICAgIGNvbnRleHQubmV4dEF1dGhDYWxsYmFja0lEKys7XG5cdCAgICB2YXIgZG9jdW1lbnQgPSBjb250ZXh0LmdldERvY3VtZW50KCk7XG5cdCAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcblx0ICAgIGNvbnRleHQuYXV0aF9jYWxsYmFja3NbY2FsbGJhY2tOYW1lXSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdCAgICAgICAgY2FsbGJhY2soZmFsc2UsIGRhdGEpO1xuXHQgICAgfTtcblx0ICAgIHZhciBjYWxsYmFja19uYW1lID0gXCJQdXNoZXIuYXV0aF9jYWxsYmFja3NbJ1wiICsgY2FsbGJhY2tOYW1lICsgXCInXVwiO1xuXHQgICAgc2NyaXB0LnNyYyA9IHRoaXMub3B0aW9ucy5hdXRoRW5kcG9pbnQgK1xuXHQgICAgICAgICc/Y2FsbGJhY2s9JyArXG5cdCAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KGNhbGxiYWNrX25hbWUpICtcblx0ICAgICAgICAnJicgK1xuXHQgICAgICAgIHRoaXMuY29tcG9zZVF1ZXJ5KHNvY2tldElkKTtcblx0ICAgIHZhciBoZWFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcblx0ICAgIGhlYWQuaW5zZXJ0QmVmb3JlKHNjcmlwdCwgaGVhZC5maXJzdENoaWxkKTtcblx0fTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBqc29ucDtcblxuXG4vKioqLyB9KSxcbi8qIDE1ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBTY3JpcHRSZXF1ZXN0ID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIFNjcmlwdFJlcXVlc3Qoc3JjKSB7XG5cdCAgICAgICAgdGhpcy5zcmMgPSBzcmM7XG5cdCAgICB9XG5cdCAgICBTY3JpcHRSZXF1ZXN0LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKHJlY2VpdmVyKSB7XG5cdCAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHQgICAgICAgIHZhciBlcnJvclN0cmluZyA9IFwiRXJyb3IgbG9hZGluZyBcIiArIHNlbGYuc3JjO1xuXHQgICAgICAgIHNlbGYuc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcblx0ICAgICAgICBzZWxmLnNjcmlwdC5pZCA9IHJlY2VpdmVyLmlkO1xuXHQgICAgICAgIHNlbGYuc2NyaXB0LnNyYyA9IHNlbGYuc3JjO1xuXHQgICAgICAgIHNlbGYuc2NyaXB0LnR5cGUgPSBcInRleHQvamF2YXNjcmlwdFwiO1xuXHQgICAgICAgIHNlbGYuc2NyaXB0LmNoYXJzZXQgPSBcIlVURi04XCI7XG5cdCAgICAgICAgaWYgKHNlbGYuc2NyaXB0LmFkZEV2ZW50TGlzdGVuZXIpIHtcblx0ICAgICAgICAgICAgc2VsZi5zY3JpcHQub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIHJlY2VpdmVyLmNhbGxiYWNrKGVycm9yU3RyaW5nKTtcblx0ICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgc2VsZi5zY3JpcHQub25sb2FkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgcmVjZWl2ZXIuY2FsbGJhY2sobnVsbCk7XG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICBzZWxmLnNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoc2VsZi5zY3JpcHQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRlZCcgfHxcblx0ICAgICAgICAgICAgICAgICAgICBzZWxmLnNjcmlwdC5yZWFkeVN0YXRlID09PSAnY29tcGxldGUnKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmVjZWl2ZXIuY2FsbGJhY2sobnVsbCk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChzZWxmLnNjcmlwdC5hc3luYyA9PT0gdW5kZWZpbmVkICYmIGRvY3VtZW50LmF0dGFjaEV2ZW50ICYmXG5cdCAgICAgICAgICAgIC9vcGVyYS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcblx0ICAgICAgICAgICAgc2VsZi5lcnJvclNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG5cdCAgICAgICAgICAgIHNlbGYuZXJyb3JTY3JpcHQuaWQgPSByZWNlaXZlci5pZCArIFwiX2Vycm9yXCI7XG5cdCAgICAgICAgICAgIHNlbGYuZXJyb3JTY3JpcHQudGV4dCA9IHJlY2VpdmVyLm5hbWUgKyBcIignXCIgKyBlcnJvclN0cmluZyArIFwiJyk7XCI7XG5cdCAgICAgICAgICAgIHNlbGYuc2NyaXB0LmFzeW5jID0gc2VsZi5lcnJvclNjcmlwdC5hc3luYyA9IGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgc2VsZi5zY3JpcHQuYXN5bmMgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB2YXIgaGVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF07XG5cdCAgICAgICAgaGVhZC5pbnNlcnRCZWZvcmUoc2VsZi5zY3JpcHQsIGhlYWQuZmlyc3RDaGlsZCk7XG5cdCAgICAgICAgaWYgKHNlbGYuZXJyb3JTY3JpcHQpIHtcblx0ICAgICAgICAgICAgaGVhZC5pbnNlcnRCZWZvcmUoc2VsZi5lcnJvclNjcmlwdCwgc2VsZi5zY3JpcHQubmV4dFNpYmxpbmcpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBTY3JpcHRSZXF1ZXN0LnByb3RvdHlwZS5jbGVhbnVwID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICh0aGlzLnNjcmlwdCkge1xuXHQgICAgICAgICAgICB0aGlzLnNjcmlwdC5vbmxvYWQgPSB0aGlzLnNjcmlwdC5vbmVycm9yID0gbnVsbDtcblx0ICAgICAgICAgICAgdGhpcy5zY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKHRoaXMuc2NyaXB0ICYmIHRoaXMuc2NyaXB0LnBhcmVudE5vZGUpIHtcblx0ICAgICAgICAgICAgdGhpcy5zY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNjcmlwdCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmICh0aGlzLmVycm9yU2NyaXB0ICYmIHRoaXMuZXJyb3JTY3JpcHQucGFyZW50Tm9kZSkge1xuXHQgICAgICAgICAgICB0aGlzLmVycm9yU2NyaXB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lcnJvclNjcmlwdCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMuc2NyaXB0ID0gbnVsbDtcblx0ICAgICAgICB0aGlzLmVycm9yU2NyaXB0ID0gbnVsbDtcblx0ICAgIH07XG5cdCAgICByZXR1cm4gU2NyaXB0UmVxdWVzdDtcblx0fSgpKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBTY3JpcHRSZXF1ZXN0O1xuXG5cbi8qKiovIH0pLFxuLyogMTYgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIENvbGxlY3Rpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0dmFyIHJ1bnRpbWVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdHZhciBKU09OUFJlcXVlc3QgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gSlNPTlBSZXF1ZXN0KHVybCwgZGF0YSkge1xuXHQgICAgICAgIHRoaXMudXJsID0gdXJsO1xuXHQgICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG5cdCAgICB9XG5cdCAgICBKU09OUFJlcXVlc3QucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAocmVjZWl2ZXIpIHtcblx0ICAgICAgICBpZiAodGhpcy5yZXF1ZXN0KSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyIHF1ZXJ5ID0gQ29sbGVjdGlvbnMuYnVpbGRRdWVyeVN0cmluZyh0aGlzLmRhdGEpO1xuXHQgICAgICAgIHZhciB1cmwgPSB0aGlzLnVybCArIFwiL1wiICsgcmVjZWl2ZXIubnVtYmVyICsgXCI/XCIgKyBxdWVyeTtcblx0ICAgICAgICB0aGlzLnJlcXVlc3QgPSBydW50aW1lXzFbXCJkZWZhdWx0XCJdLmNyZWF0ZVNjcmlwdFJlcXVlc3QodXJsKTtcblx0ICAgICAgICB0aGlzLnJlcXVlc3Quc2VuZChyZWNlaXZlcik7XG5cdCAgICB9O1xuXHQgICAgSlNPTlBSZXF1ZXN0LnByb3RvdHlwZS5jbGVhbnVwID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICh0aGlzLnJlcXVlc3QpIHtcblx0ICAgICAgICAgICAgdGhpcy5yZXF1ZXN0LmNsZWFudXAoKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgcmV0dXJuIEpTT05QUmVxdWVzdDtcblx0fSgpKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBKU09OUFJlcXVlc3Q7XG5cblxuLyoqKi8gfSksXG4vKiAxNyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgcnVudGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIHNjcmlwdF9yZWNlaXZlcl9mYWN0b3J5XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXHR2YXIgZ2V0QWdlbnQgPSBmdW5jdGlvbiAoc2VuZGVyLCBlbmNyeXB0ZWQpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcblx0ICAgICAgICB2YXIgc2NoZW1lID0gXCJodHRwXCIgKyAoZW5jcnlwdGVkID8gXCJzXCIgOiBcIlwiKSArIFwiOi8vXCI7XG5cdCAgICAgICAgdmFyIHVybCA9IHNjaGVtZSArIChzZW5kZXIuaG9zdCB8fCBzZW5kZXIub3B0aW9ucy5ob3N0KSArIHNlbmRlci5vcHRpb25zLnBhdGg7XG5cdCAgICAgICAgdmFyIHJlcXVlc3QgPSBydW50aW1lXzFbXCJkZWZhdWx0XCJdLmNyZWF0ZUpTT05QUmVxdWVzdCh1cmwsIGRhdGEpO1xuXHQgICAgICAgIHZhciByZWNlaXZlciA9IHJ1bnRpbWVfMVtcImRlZmF1bHRcIl0uU2NyaXB0UmVjZWl2ZXJzLmNyZWF0ZShmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdCkge1xuXHQgICAgICAgICAgICBzY3JpcHRfcmVjZWl2ZXJfZmFjdG9yeV8xLlNjcmlwdFJlY2VpdmVycy5yZW1vdmUocmVjZWl2ZXIpO1xuXHQgICAgICAgICAgICByZXF1ZXN0LmNsZWFudXAoKTtcblx0ICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQuaG9zdCkge1xuXHQgICAgICAgICAgICAgICAgc2VuZGVyLmhvc3QgPSByZXN1bHQuaG9zdDtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcblx0ICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCByZXN1bHQpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgcmVxdWVzdC5zZW5kKHJlY2VpdmVyKTtcblx0ICAgIH07XG5cdH07XG5cdHZhciBqc29ucCA9IHtcblx0ICAgIG5hbWU6ICdqc29ucCcsXG5cdCAgICBnZXRBZ2VudDogZ2V0QWdlbnRcblx0fTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBqc29ucDtcblxuXG4vKioqLyB9KSxcbi8qIDE4ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciB0cmFuc3BvcnRzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KTtcblx0dmFyIHRyYW5zcG9ydF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSk7XG5cdHZhciBVUkxTY2hlbWVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7XG5cdHZhciBydW50aW1lXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHR2YXIgZGVwZW5kZW5jaWVzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXHR2YXIgQ29sbGVjdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXHR2YXIgU29ja0pTVHJhbnNwb3J0ID0gbmV3IHRyYW5zcG9ydF8xW1wiZGVmYXVsdFwiXSh7XG5cdCAgICBmaWxlOiBcInNvY2tqc1wiLFxuXHQgICAgdXJsczogVVJMU2NoZW1lcy5zb2NranMsXG5cdCAgICBoYW5kbGVzQWN0aXZpdHlDaGVja3M6IHRydWUsXG5cdCAgICBzdXBwb3J0c1Bpbmc6IGZhbHNlLFxuXHQgICAgaXNTdXBwb3J0ZWQ6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgIH0sXG5cdCAgICBpc0luaXRpYWxpemVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHdpbmRvdy5Tb2NrSlMgIT09IHVuZGVmaW5lZDtcblx0ICAgIH0sXG5cdCAgICBnZXRTb2NrZXQ6IGZ1bmN0aW9uICh1cmwsIG9wdGlvbnMpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IHdpbmRvdy5Tb2NrSlModXJsLCBudWxsLCB7XG5cdCAgICAgICAgICAgIGpzX3BhdGg6IGRlcGVuZGVuY2llc18xLkRlcGVuZGVuY2llcy5nZXRQYXRoKFwic29ja2pzXCIsIHtcblx0ICAgICAgICAgICAgICAgIGVuY3J5cHRlZDogb3B0aW9ucy5lbmNyeXB0ZWRcblx0ICAgICAgICAgICAgfSksXG5cdCAgICAgICAgICAgIGlnbm9yZV9udWxsX29yaWdpbjogb3B0aW9ucy5pZ25vcmVOdWxsT3JpZ2luXG5cdCAgICAgICAgfSk7XG5cdCAgICB9LFxuXHQgICAgYmVmb3JlT3BlbjogZnVuY3Rpb24gKHNvY2tldCwgcGF0aCkge1xuXHQgICAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtcblx0ICAgICAgICAgICAgcGF0aDogcGF0aFxuXHQgICAgICAgIH0pKTtcblx0ICAgIH1cblx0fSk7XG5cdHZhciB4ZHJDb25maWd1cmF0aW9uID0ge1xuXHQgICAgaXNTdXBwb3J0ZWQ6IGZ1bmN0aW9uIChlbnZpcm9ubWVudCkge1xuXHQgICAgICAgIHZhciB5ZXMgPSBydW50aW1lXzFbXCJkZWZhdWx0XCJdLmlzWERSU3VwcG9ydGVkKGVudmlyb25tZW50LmVuY3J5cHRlZCk7XG5cdCAgICAgICAgcmV0dXJuIHllcztcblx0ICAgIH1cblx0fTtcblx0dmFyIFhEUlN0cmVhbWluZ1RyYW5zcG9ydCA9IG5ldyB0cmFuc3BvcnRfMVtcImRlZmF1bHRcIl0oQ29sbGVjdGlvbnMuZXh0ZW5kKHt9LCB0cmFuc3BvcnRzXzEuc3RyZWFtaW5nQ29uZmlndXJhdGlvbiwgeGRyQ29uZmlndXJhdGlvbikpO1xuXHR2YXIgWERSUG9sbGluZ1RyYW5zcG9ydCA9IG5ldyB0cmFuc3BvcnRfMVtcImRlZmF1bHRcIl0oQ29sbGVjdGlvbnMuZXh0ZW5kKHt9LCB0cmFuc3BvcnRzXzEucG9sbGluZ0NvbmZpZ3VyYXRpb24sIHhkckNvbmZpZ3VyYXRpb24pKTtcblx0dHJhbnNwb3J0c18xW1wiZGVmYXVsdFwiXS54ZHJfc3RyZWFtaW5nID0gWERSU3RyZWFtaW5nVHJhbnNwb3J0O1xuXHR0cmFuc3BvcnRzXzFbXCJkZWZhdWx0XCJdLnhkcl9wb2xsaW5nID0gWERSUG9sbGluZ1RyYW5zcG9ydDtcblx0dHJhbnNwb3J0c18xW1wiZGVmYXVsdFwiXS5zb2NranMgPSBTb2NrSlNUcmFuc3BvcnQ7XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gdHJhbnNwb3J0c18xW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqLyB9KSxcbi8qIDE5ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBVUkxTY2hlbWVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7XG5cdHZhciB0cmFuc3BvcnRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpO1xuXHR2YXIgQ29sbGVjdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXHR2YXIgcnVudGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIFdTVHJhbnNwb3J0ID0gbmV3IHRyYW5zcG9ydF8xW1wiZGVmYXVsdFwiXSh7XG5cdCAgICB1cmxzOiBVUkxTY2hlbWVzLndzLFxuXHQgICAgaGFuZGxlc0FjdGl2aXR5Q2hlY2tzOiBmYWxzZSxcblx0ICAgIHN1cHBvcnRzUGluZzogZmFsc2UsXG5cdCAgICBpc0luaXRpYWxpemVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIEJvb2xlYW4ocnVudGltZV8xW1wiZGVmYXVsdFwiXS5nZXRXZWJTb2NrZXRBUEkoKSk7XG5cdCAgICB9LFxuXHQgICAgaXNTdXBwb3J0ZWQ6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gQm9vbGVhbihydW50aW1lXzFbXCJkZWZhdWx0XCJdLmdldFdlYlNvY2tldEFQSSgpKTtcblx0ICAgIH0sXG5cdCAgICBnZXRTb2NrZXQ6IGZ1bmN0aW9uICh1cmwpIHtcblx0ICAgICAgICByZXR1cm4gcnVudGltZV8xW1wiZGVmYXVsdFwiXS5jcmVhdGVXZWJTb2NrZXQodXJsKTtcblx0ICAgIH1cblx0fSk7XG5cdHZhciBodHRwQ29uZmlndXJhdGlvbiA9IHtcblx0ICAgIHVybHM6IFVSTFNjaGVtZXMuaHR0cCxcblx0ICAgIGhhbmRsZXNBY3Rpdml0eUNoZWNrczogZmFsc2UsXG5cdCAgICBzdXBwb3J0c1Bpbmc6IHRydWUsXG5cdCAgICBpc0luaXRpYWxpemVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9XG5cdH07XG5cdGV4cG9ydHMuc3RyZWFtaW5nQ29uZmlndXJhdGlvbiA9IENvbGxlY3Rpb25zLmV4dGVuZCh7IGdldFNvY2tldDogZnVuY3Rpb24gKHVybCkge1xuXHQgICAgICAgIHJldHVybiBydW50aW1lXzFbXCJkZWZhdWx0XCJdLkhUVFBGYWN0b3J5LmNyZWF0ZVN0cmVhbWluZ1NvY2tldCh1cmwpO1xuXHQgICAgfVxuXHR9LCBodHRwQ29uZmlndXJhdGlvbik7XG5cdGV4cG9ydHMucG9sbGluZ0NvbmZpZ3VyYXRpb24gPSBDb2xsZWN0aW9ucy5leHRlbmQoeyBnZXRTb2NrZXQ6IGZ1bmN0aW9uICh1cmwpIHtcblx0ICAgICAgICByZXR1cm4gcnVudGltZV8xW1wiZGVmYXVsdFwiXS5IVFRQRmFjdG9yeS5jcmVhdGVQb2xsaW5nU29ja2V0KHVybCk7XG5cdCAgICB9XG5cdH0sIGh0dHBDb25maWd1cmF0aW9uKTtcblx0dmFyIHhockNvbmZpZ3VyYXRpb24gPSB7XG5cdCAgICBpc1N1cHBvcnRlZDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiBydW50aW1lXzFbXCJkZWZhdWx0XCJdLmlzWEhSU3VwcG9ydGVkKCk7XG5cdCAgICB9XG5cdH07XG5cdHZhciBYSFJTdHJlYW1pbmdUcmFuc3BvcnQgPSBuZXcgdHJhbnNwb3J0XzFbXCJkZWZhdWx0XCJdKENvbGxlY3Rpb25zLmV4dGVuZCh7fSwgZXhwb3J0cy5zdHJlYW1pbmdDb25maWd1cmF0aW9uLCB4aHJDb25maWd1cmF0aW9uKSk7XG5cdHZhciBYSFJQb2xsaW5nVHJhbnNwb3J0ID0gbmV3IHRyYW5zcG9ydF8xW1wiZGVmYXVsdFwiXShDb2xsZWN0aW9ucy5leHRlbmQoe30sIGV4cG9ydHMucG9sbGluZ0NvbmZpZ3VyYXRpb24sIHhockNvbmZpZ3VyYXRpb24pKTtcblx0dmFyIFRyYW5zcG9ydHMgPSB7XG5cdCAgICB3czogV1NUcmFuc3BvcnQsXG5cdCAgICB4aHJfc3RyZWFtaW5nOiBYSFJTdHJlYW1pbmdUcmFuc3BvcnQsXG5cdCAgICB4aHJfcG9sbGluZzogWEhSUG9sbGluZ1RyYW5zcG9ydFxuXHR9O1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IFRyYW5zcG9ydHM7XG5cblxuLyoqKi8gfSksXG4vKiAyMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgZGVmYXVsdHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG5cdGZ1bmN0aW9uIGdldEdlbmVyaWNVUkwoYmFzZVNjaGVtZSwgcGFyYW1zLCBwYXRoKSB7XG5cdCAgICB2YXIgc2NoZW1lID0gYmFzZVNjaGVtZSArIChwYXJhbXMuZW5jcnlwdGVkID8gXCJzXCIgOiBcIlwiKTtcblx0ICAgIHZhciBob3N0ID0gcGFyYW1zLmVuY3J5cHRlZCA/IHBhcmFtcy5ob3N0RW5jcnlwdGVkIDogcGFyYW1zLmhvc3RVbmVuY3J5cHRlZDtcblx0ICAgIHJldHVybiBzY2hlbWUgKyBcIjovL1wiICsgaG9zdCArIHBhdGg7XG5cdH1cblx0ZnVuY3Rpb24gZ2V0R2VuZXJpY1BhdGgoa2V5LCBxdWVyeVN0cmluZykge1xuXHQgICAgdmFyIHBhdGggPSBcIi9hcHAvXCIgKyBrZXk7XG5cdCAgICB2YXIgcXVlcnkgPSBcIj9wcm90b2NvbD1cIiArIGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLlBST1RPQ09MICtcblx0ICAgICAgICBcIiZjbGllbnQ9anNcIiArXG5cdCAgICAgICAgXCImdmVyc2lvbj1cIiArIGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLlZFUlNJT04gK1xuXHQgICAgICAgIChxdWVyeVN0cmluZyA/IChcIiZcIiArIHF1ZXJ5U3RyaW5nKSA6IFwiXCIpO1xuXHQgICAgcmV0dXJuIHBhdGggKyBxdWVyeTtcblx0fVxuXHRleHBvcnRzLndzID0ge1xuXHQgICAgZ2V0SW5pdGlhbDogZnVuY3Rpb24gKGtleSwgcGFyYW1zKSB7XG5cdCAgICAgICAgcmV0dXJuIGdldEdlbmVyaWNVUkwoXCJ3c1wiLCBwYXJhbXMsIGdldEdlbmVyaWNQYXRoKGtleSwgXCJmbGFzaD1mYWxzZVwiKSk7XG5cdCAgICB9XG5cdH07XG5cdGV4cG9ydHMuaHR0cCA9IHtcblx0ICAgIGdldEluaXRpYWw6IGZ1bmN0aW9uIChrZXksIHBhcmFtcykge1xuXHQgICAgICAgIHZhciBwYXRoID0gKHBhcmFtcy5odHRwUGF0aCB8fCBcIi9wdXNoZXJcIikgKyBnZXRHZW5lcmljUGF0aChrZXkpO1xuXHQgICAgICAgIHJldHVybiBnZXRHZW5lcmljVVJMKFwiaHR0cFwiLCBwYXJhbXMsIHBhdGgpO1xuXHQgICAgfVxuXHR9O1xuXHRleHBvcnRzLnNvY2tqcyA9IHtcblx0ICAgIGdldEluaXRpYWw6IGZ1bmN0aW9uIChrZXksIHBhcmFtcykge1xuXHQgICAgICAgIHJldHVybiBnZXRHZW5lcmljVVJMKFwiaHR0cFwiLCBwYXJhbXMsIHBhcmFtcy5odHRwUGF0aCB8fCBcIi9wdXNoZXJcIik7XG5cdCAgICB9LFxuXHQgICAgZ2V0UGF0aDogZnVuY3Rpb24gKGtleSwgcGFyYW1zKSB7XG5cdCAgICAgICAgcmV0dXJuIGdldEdlbmVyaWNQYXRoKGtleSk7XG5cdCAgICB9XG5cdH07XG5cblxuLyoqKi8gfSksXG4vKiAyMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgdHJhbnNwb3J0X2Nvbm5lY3Rpb25fMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpO1xuXHR2YXIgVHJhbnNwb3J0ID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIFRyYW5zcG9ydChob29rcykge1xuXHQgICAgICAgIHRoaXMuaG9va3MgPSBob29rcztcblx0ICAgIH1cblx0ICAgIFRyYW5zcG9ydC5wcm90b3R5cGUuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoZW52aXJvbm1lbnQpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5ob29rcy5pc1N1cHBvcnRlZChlbnZpcm9ubWVudCk7XG5cdCAgICB9O1xuXHQgICAgVHJhbnNwb3J0LnByb3RvdHlwZS5jcmVhdGVDb25uZWN0aW9uID0gZnVuY3Rpb24gKG5hbWUsIHByaW9yaXR5LCBrZXksIG9wdGlvbnMpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IHRyYW5zcG9ydF9jb25uZWN0aW9uXzFbXCJkZWZhdWx0XCJdKHRoaXMuaG9va3MsIG5hbWUsIHByaW9yaXR5LCBrZXksIG9wdGlvbnMpO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBUcmFuc3BvcnQ7XG5cdH0oKSk7XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gVHJhbnNwb3J0O1xuXG5cbi8qKiovIH0pLFxuLyogMjIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xuXHQgICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07XG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cblx0ICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcblx0fTtcblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXHR2YXIgQ29sbGVjdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXHR2YXIgZGlzcGF0Y2hlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7XG5cdHZhciBsb2dnZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cdHZhciBydW50aW1lXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHR2YXIgVHJhbnNwb3J0Q29ubmVjdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG5cdCAgICBfX2V4dGVuZHMoVHJhbnNwb3J0Q29ubmVjdGlvbiwgX3N1cGVyKTtcblx0ICAgIGZ1bmN0aW9uIFRyYW5zcG9ydENvbm5lY3Rpb24oaG9va3MsIG5hbWUsIHByaW9yaXR5LCBrZXksIG9wdGlvbnMpIHtcblx0ICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTtcblx0ICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBydW50aW1lXzFbXCJkZWZhdWx0XCJdLnRyYW5zcG9ydENvbm5lY3Rpb25Jbml0aWFsaXplcjtcblx0ICAgICAgICB0aGlzLmhvb2tzID0gaG9va3M7XG5cdCAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcblx0ICAgICAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XG5cdCAgICAgICAgdGhpcy5rZXkgPSBrZXk7XG5cdCAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcblx0ICAgICAgICB0aGlzLnN0YXRlID0gXCJuZXdcIjtcblx0ICAgICAgICB0aGlzLnRpbWVsaW5lID0gb3B0aW9ucy50aW1lbGluZTtcblx0ICAgICAgICB0aGlzLmFjdGl2aXR5VGltZW91dCA9IG9wdGlvbnMuYWN0aXZpdHlUaW1lb3V0O1xuXHQgICAgICAgIHRoaXMuaWQgPSB0aGlzLnRpbWVsaW5lLmdlbmVyYXRlVW5pcXVlSUQoKTtcblx0ICAgIH1cblx0ICAgIFRyYW5zcG9ydENvbm5lY3Rpb24ucHJvdG90eXBlLmhhbmRsZXNBY3Rpdml0eUNoZWNrcyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gQm9vbGVhbih0aGlzLmhvb2tzLmhhbmRsZXNBY3Rpdml0eUNoZWNrcyk7XG5cdCAgICB9O1xuXHQgICAgVHJhbnNwb3J0Q29ubmVjdGlvbi5wcm90b3R5cGUuc3VwcG9ydHNQaW5nID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiBCb29sZWFuKHRoaXMuaG9va3Muc3VwcG9ydHNQaW5nKTtcblx0ICAgIH07XG5cdCAgICBUcmFuc3BvcnRDb25uZWN0aW9uLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdCAgICAgICAgaWYgKHRoaXMuc29ja2V0IHx8IHRoaXMuc3RhdGUgIT09IFwiaW5pdGlhbGl6ZWRcIikge1xuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHZhciB1cmwgPSB0aGlzLmhvb2tzLnVybHMuZ2V0SW5pdGlhbCh0aGlzLmtleSwgdGhpcy5vcHRpb25zKTtcblx0ICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICB0aGlzLnNvY2tldCA9IHRoaXMuaG9va3MuZ2V0U29ja2V0KHVybCwgdGhpcy5vcHRpb25zKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgY2F0Y2ggKGUpIHtcblx0ICAgICAgICAgICAgdXRpbF8xW1wiZGVmYXVsdFwiXS5kZWZlcihmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5vbkVycm9yKGUpO1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuY2hhbmdlU3RhdGUoXCJjbG9zZWRcIik7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMuYmluZExpc3RlbmVycygpO1xuXHQgICAgICAgIGxvZ2dlcl8xW1wiZGVmYXVsdFwiXS5kZWJ1ZyhcIkNvbm5lY3RpbmdcIiwgeyB0cmFuc3BvcnQ6IHRoaXMubmFtZSwgdXJsOiB1cmwgfSk7XG5cdCAgICAgICAgdGhpcy5jaGFuZ2VTdGF0ZShcImNvbm5lY3RpbmdcIik7XG5cdCAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9O1xuXHQgICAgVHJhbnNwb3J0Q29ubmVjdGlvbi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKHRoaXMuc29ja2V0KSB7XG5cdCAgICAgICAgICAgIHRoaXMuc29ja2V0LmNsb3NlKCk7XG5cdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBUcmFuc3BvcnRDb25uZWN0aW9uLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKGRhdGEpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBcIm9wZW5cIikge1xuXHQgICAgICAgICAgICB1dGlsXzFbXCJkZWZhdWx0XCJdLmRlZmVyKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIGlmIChfdGhpcy5zb2NrZXQpIHtcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpcy5zb2NrZXQuc2VuZChkYXRhKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBUcmFuc3BvcnRDb25uZWN0aW9uLnByb3RvdHlwZS5waW5nID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBcIm9wZW5cIiAmJiB0aGlzLnN1cHBvcnRzUGluZygpKSB7XG5cdCAgICAgICAgICAgIHRoaXMuc29ja2V0LnBpbmcoKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgVHJhbnNwb3J0Q29ubmVjdGlvbi5wcm90b3R5cGUub25PcGVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICh0aGlzLmhvb2tzLmJlZm9yZU9wZW4pIHtcblx0ICAgICAgICAgICAgdGhpcy5ob29rcy5iZWZvcmVPcGVuKHRoaXMuc29ja2V0LCB0aGlzLmhvb2tzLnVybHMuZ2V0UGF0aCh0aGlzLmtleSwgdGhpcy5vcHRpb25zKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMuY2hhbmdlU3RhdGUoXCJvcGVuXCIpO1xuXHQgICAgICAgIHRoaXMuc29ja2V0Lm9ub3BlbiA9IHVuZGVmaW5lZDtcblx0ICAgIH07XG5cdCAgICBUcmFuc3BvcnRDb25uZWN0aW9uLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgdGhpcy5lbWl0KFwiZXJyb3JcIiwgeyB0eXBlOiAnV2ViU29ja2V0RXJyb3InLCBlcnJvcjogZXJyb3IgfSk7XG5cdCAgICAgICAgdGhpcy50aW1lbGluZS5lcnJvcih0aGlzLmJ1aWxkVGltZWxpbmVNZXNzYWdlKHsgZXJyb3I6IGVycm9yLnRvU3RyaW5nKCkgfSkpO1xuXHQgICAgfTtcblx0ICAgIFRyYW5zcG9ydENvbm5lY3Rpb24ucHJvdG90eXBlLm9uQ2xvc2UgPSBmdW5jdGlvbiAoY2xvc2VFdmVudCkge1xuXHQgICAgICAgIGlmIChjbG9zZUV2ZW50KSB7XG5cdCAgICAgICAgICAgIHRoaXMuY2hhbmdlU3RhdGUoXCJjbG9zZWRcIiwge1xuXHQgICAgICAgICAgICAgICAgY29kZTogY2xvc2VFdmVudC5jb2RlLFxuXHQgICAgICAgICAgICAgICAgcmVhc29uOiBjbG9zZUV2ZW50LnJlYXNvbixcblx0ICAgICAgICAgICAgICAgIHdhc0NsZWFuOiBjbG9zZUV2ZW50Lndhc0NsZWFuXG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgdGhpcy5jaGFuZ2VTdGF0ZShcImNsb3NlZFwiKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy51bmJpbmRMaXN0ZW5lcnMoKTtcblx0ICAgICAgICB0aGlzLnNvY2tldCA9IHVuZGVmaW5lZDtcblx0ICAgIH07XG5cdCAgICBUcmFuc3BvcnRDb25uZWN0aW9uLnByb3RvdHlwZS5vbk1lc3NhZ2UgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuXHQgICAgICAgIHRoaXMuZW1pdChcIm1lc3NhZ2VcIiwgbWVzc2FnZSk7XG5cdCAgICB9O1xuXHQgICAgVHJhbnNwb3J0Q29ubmVjdGlvbi5wcm90b3R5cGUub25BY3Rpdml0eSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLmVtaXQoXCJhY3Rpdml0eVwiKTtcblx0ICAgIH07XG5cdCAgICBUcmFuc3BvcnRDb25uZWN0aW9uLnByb3RvdHlwZS5iaW5kTGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdCAgICAgICAgdGhpcy5zb2NrZXQub25vcGVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICBfdGhpcy5vbk9wZW4oKTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHRoaXMuc29ja2V0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgICAgICAgX3RoaXMub25FcnJvcihlcnJvcik7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB0aGlzLnNvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24gKGNsb3NlRXZlbnQpIHtcblx0ICAgICAgICAgICAgX3RoaXMub25DbG9zZShjbG9zZUV2ZW50KTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHRoaXMuc29ja2V0Lm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG5cdCAgICAgICAgICAgIF90aGlzLm9uTWVzc2FnZShtZXNzYWdlKTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIGlmICh0aGlzLnN1cHBvcnRzUGluZygpKSB7XG5cdCAgICAgICAgICAgIHRoaXMuc29ja2V0Lm9uYWN0aXZpdHkgPSBmdW5jdGlvbiAoKSB7IF90aGlzLm9uQWN0aXZpdHkoKTsgfTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgVHJhbnNwb3J0Q29ubmVjdGlvbi5wcm90b3R5cGUudW5iaW5kTGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICh0aGlzLnNvY2tldCkge1xuXHQgICAgICAgICAgICB0aGlzLnNvY2tldC5vbm9wZW4gPSB1bmRlZmluZWQ7XG5cdCAgICAgICAgICAgIHRoaXMuc29ja2V0Lm9uZXJyb3IgPSB1bmRlZmluZWQ7XG5cdCAgICAgICAgICAgIHRoaXMuc29ja2V0Lm9uY2xvc2UgPSB1bmRlZmluZWQ7XG5cdCAgICAgICAgICAgIHRoaXMuc29ja2V0Lm9ubWVzc2FnZSA9IHVuZGVmaW5lZDtcblx0ICAgICAgICAgICAgaWYgKHRoaXMuc3VwcG9ydHNQaW5nKCkpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuc29ja2V0Lm9uYWN0aXZpdHkgPSB1bmRlZmluZWQ7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgVHJhbnNwb3J0Q29ubmVjdGlvbi5wcm90b3R5cGUuY2hhbmdlU3RhdGUgPSBmdW5jdGlvbiAoc3RhdGUsIHBhcmFtcykge1xuXHQgICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcblx0ICAgICAgICB0aGlzLnRpbWVsaW5lLmluZm8odGhpcy5idWlsZFRpbWVsaW5lTWVzc2FnZSh7XG5cdCAgICAgICAgICAgIHN0YXRlOiBzdGF0ZSxcblx0ICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXNcblx0ICAgICAgICB9KSk7XG5cdCAgICAgICAgdGhpcy5lbWl0KHN0YXRlLCBwYXJhbXMpO1xuXHQgICAgfTtcblx0ICAgIFRyYW5zcG9ydENvbm5lY3Rpb24ucHJvdG90eXBlLmJ1aWxkVGltZWxpbmVNZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcblx0ICAgICAgICByZXR1cm4gQ29sbGVjdGlvbnMuZXh0ZW5kKHsgY2lkOiB0aGlzLmlkIH0sIG1lc3NhZ2UpO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBUcmFuc3BvcnRDb25uZWN0aW9uO1xuXHR9KGRpc3BhdGNoZXJfMVtcImRlZmF1bHRcIl0pKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBUcmFuc3BvcnRDb25uZWN0aW9uO1xuXG5cbi8qKiovIH0pLFxuLyogMjMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIENvbGxlY3Rpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0dmFyIGNhbGxiYWNrX3JlZ2lzdHJ5XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTtcblx0dmFyIERpc3BhdGNoZXIgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gRGlzcGF0Y2hlcihmYWlsVGhyb3VnaCkge1xuXHQgICAgICAgIHRoaXMuY2FsbGJhY2tzID0gbmV3IGNhbGxiYWNrX3JlZ2lzdHJ5XzFbXCJkZWZhdWx0XCJdKCk7XG5cdCAgICAgICAgdGhpcy5nbG9iYWxfY2FsbGJhY2tzID0gW107XG5cdCAgICAgICAgdGhpcy5mYWlsVGhyb3VnaCA9IGZhaWxUaHJvdWdoO1xuXHQgICAgfVxuXHQgICAgRGlzcGF0Y2hlci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG5cdCAgICAgICAgdGhpcy5jYWxsYmFja3MuYWRkKGV2ZW50TmFtZSwgY2FsbGJhY2ssIGNvbnRleHQpO1xuXHQgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfTtcblx0ICAgIERpc3BhdGNoZXIucHJvdG90eXBlLmJpbmRfZ2xvYmFsID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG5cdCAgICAgICAgdGhpcy5nbG9iYWxfY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuXHQgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfTtcblx0ICAgIERpc3BhdGNoZXIucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG5cdCAgICAgICAgdGhpcy5jYWxsYmFja3MucmVtb3ZlKGV2ZW50TmFtZSwgY2FsbGJhY2ssIGNvbnRleHQpO1xuXHQgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfTtcblx0ICAgIERpc3BhdGNoZXIucHJvdG90eXBlLnVuYmluZF9nbG9iYWwgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcblx0ICAgICAgICBpZiAoIWNhbGxiYWNrKSB7XG5cdCAgICAgICAgICAgIHRoaXMuZ2xvYmFsX2NhbGxiYWNrcyA9IFtdO1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcztcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5nbG9iYWxfY2FsbGJhY2tzID0gQ29sbGVjdGlvbnMuZmlsdGVyKHRoaXMuZ2xvYmFsX2NhbGxiYWNrcyB8fCBbXSwgZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGMgIT09IGNhbGxiYWNrOyB9KTtcblx0ICAgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH07XG5cdCAgICBEaXNwYXRjaGVyLnByb3RvdHlwZS51bmJpbmRfYWxsID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRoaXMudW5iaW5kKCk7XG5cdCAgICAgICAgdGhpcy51bmJpbmRfZ2xvYmFsKCk7XG5cdCAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9O1xuXHQgICAgRGlzcGF0Y2hlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGRhdGEpIHtcblx0ICAgICAgICB2YXIgaTtcblx0ICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5nbG9iYWxfY2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICAgIHRoaXMuZ2xvYmFsX2NhbGxiYWNrc1tpXShldmVudE5hbWUsIGRhdGEpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB2YXIgY2FsbGJhY2tzID0gdGhpcy5jYWxsYmFja3MuZ2V0KGV2ZW50TmFtZSk7XG5cdCAgICAgICAgaWYgKGNhbGxiYWNrcyAmJiBjYWxsYmFja3MubGVuZ3RoID4gMCkge1xuXHQgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICAgICAgICBjYWxsYmFja3NbaV0uZm4uY2FsbChjYWxsYmFja3NbaV0uY29udGV4dCB8fCAod2luZG93KSwgZGF0YSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSBpZiAodGhpcy5mYWlsVGhyb3VnaCkge1xuXHQgICAgICAgICAgICB0aGlzLmZhaWxUaHJvdWdoKGV2ZW50TmFtZSwgZGF0YSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBEaXNwYXRjaGVyO1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IERpc3BhdGNoZXI7XG5cblxuLyoqKi8gfSksXG4vKiAyNCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgQ29sbGVjdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXHR2YXIgQ2FsbGJhY2tSZWdpc3RyeSA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBDYWxsYmFja1JlZ2lzdHJ5KCkge1xuXHQgICAgICAgIHRoaXMuX2NhbGxiYWNrcyA9IHt9O1xuXHQgICAgfVxuXHQgICAgQ2FsbGJhY2tSZWdpc3RyeS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKG5hbWUpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5fY2FsbGJhY2tzW3ByZWZpeChuYW1lKV07XG5cdCAgICB9O1xuXHQgICAgQ2FsbGJhY2tSZWdpc3RyeS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKG5hbWUsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG5cdCAgICAgICAgdmFyIHByZWZpeGVkRXZlbnROYW1lID0gcHJlZml4KG5hbWUpO1xuXHQgICAgICAgIHRoaXMuX2NhbGxiYWNrc1twcmVmaXhlZEV2ZW50TmFtZV0gPSB0aGlzLl9jYWxsYmFja3NbcHJlZml4ZWRFdmVudE5hbWVdIHx8IFtdO1xuXHQgICAgICAgIHRoaXMuX2NhbGxiYWNrc1twcmVmaXhlZEV2ZW50TmFtZV0ucHVzaCh7XG5cdCAgICAgICAgICAgIGZuOiBjYWxsYmFjayxcblx0ICAgICAgICAgICAgY29udGV4dDogY29udGV4dFxuXHQgICAgICAgIH0pO1xuXHQgICAgfTtcblx0ICAgIENhbGxiYWNrUmVnaXN0cnkucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChuYW1lLCBjYWxsYmFjaywgY29udGV4dCkge1xuXHQgICAgICAgIGlmICghbmFtZSAmJiAhY2FsbGJhY2sgJiYgIWNvbnRleHQpIHtcblx0ICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2tzID0ge307XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyIG5hbWVzID0gbmFtZSA/IFtwcmVmaXgobmFtZSldIDogQ29sbGVjdGlvbnMua2V5cyh0aGlzLl9jYWxsYmFja3MpO1xuXHQgICAgICAgIGlmIChjYWxsYmFjayB8fCBjb250ZXh0KSB7XG5cdCAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2FsbGJhY2sobmFtZXMsIGNhbGxiYWNrLCBjb250ZXh0KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsQ2FsbGJhY2tzKG5hbWVzKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgQ2FsbGJhY2tSZWdpc3RyeS5wcm90b3R5cGUucmVtb3ZlQ2FsbGJhY2sgPSBmdW5jdGlvbiAobmFtZXMsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG5cdCAgICAgICAgQ29sbGVjdGlvbnMuYXBwbHkobmFtZXMsIGZ1bmN0aW9uIChuYW1lKSB7XG5cdCAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrc1tuYW1lXSA9IENvbGxlY3Rpb25zLmZpbHRlcih0aGlzLl9jYWxsYmFja3NbbmFtZV0gfHwgW10sIGZ1bmN0aW9uIChiaW5kaW5nKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gKGNhbGxiYWNrICYmIGNhbGxiYWNrICE9PSBiaW5kaW5nLmZuKSB8fFxuXHQgICAgICAgICAgICAgICAgICAgIChjb250ZXh0ICYmIGNvbnRleHQgIT09IGJpbmRpbmcuY29udGV4dCk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICBpZiAodGhpcy5fY2FsbGJhY2tzW25hbWVdLmxlbmd0aCA9PT0gMCkge1xuXHQgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2NhbGxiYWNrc1tuYW1lXTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0sIHRoaXMpO1xuXHQgICAgfTtcblx0ICAgIENhbGxiYWNrUmVnaXN0cnkucHJvdG90eXBlLnJlbW92ZUFsbENhbGxiYWNrcyA9IGZ1bmN0aW9uIChuYW1lcykge1xuXHQgICAgICAgIENvbGxlY3Rpb25zLmFwcGx5KG5hbWVzLCBmdW5jdGlvbiAobmFtZSkge1xuXHQgICAgICAgICAgICBkZWxldGUgdGhpcy5fY2FsbGJhY2tzW25hbWVdO1xuXHQgICAgICAgIH0sIHRoaXMpO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBDYWxsYmFja1JlZ2lzdHJ5O1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IENhbGxiYWNrUmVnaXN0cnk7XG5cdGZ1bmN0aW9uIHByZWZpeChuYW1lKSB7XG5cdCAgICByZXR1cm4gXCJfXCIgKyBuYW1lO1xuXHR9XG5cblxuLyoqKi8gfSksXG4vKiAyNSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XG5cdCAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcblx0ICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuXHQgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuXHR9O1xuXHR2YXIgZGlzcGF0Y2hlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7XG5cdHZhciBOZXRJbmZvID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcblx0ICAgIF9fZXh0ZW5kcyhOZXRJbmZvLCBfc3VwZXIpO1xuXHQgICAgZnVuY3Rpb24gTmV0SW5mbygpIHtcblx0ICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTtcblx0ICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICAgICAgaWYgKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyICE9PSB1bmRlZmluZWQpIHtcblx0ICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvbmxpbmVcIiwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgc2VsZi5lbWl0KCdvbmxpbmUnKTtcblx0ICAgICAgICAgICAgfSwgZmFsc2UpO1xuXHQgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9mZmxpbmVcIiwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgc2VsZi5lbWl0KCdvZmZsaW5lJyk7XG5cdCAgICAgICAgICAgIH0sIGZhbHNlKTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdCAgICBOZXRJbmZvLnByb3RvdHlwZS5pc09ubGluZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAod2luZG93Lm5hdmlnYXRvci5vbkxpbmUgPT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgIHJldHVybiB3aW5kb3cubmF2aWdhdG9yLm9uTGluZTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgcmV0dXJuIE5ldEluZm87XG5cdH0oZGlzcGF0Y2hlcl8xW1wiZGVmYXVsdFwiXSkpO1xuXHRleHBvcnRzLk5ldEluZm8gPSBOZXRJbmZvO1xuXHRleHBvcnRzLk5ldHdvcmsgPSBuZXcgTmV0SW5mbygpO1xuXG5cbi8qKiovIH0pLFxuLyogMjYgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIGdldERlZmF1bHRTdHJhdGVneSA9IGZ1bmN0aW9uIChjb25maWcpIHtcblx0ICAgIHZhciB3c1N0cmF0ZWd5O1xuXHQgICAgaWYgKGNvbmZpZy5lbmNyeXB0ZWQpIHtcblx0ICAgICAgICB3c1N0cmF0ZWd5ID0gW1xuXHQgICAgICAgICAgICBcIjpiZXN0X2Nvbm5lY3RlZF9ldmVyXCIsXG5cdCAgICAgICAgICAgIFwiOndzX2xvb3BcIixcblx0ICAgICAgICAgICAgW1wiOmRlbGF5ZWRcIiwgMjAwMCwgW1wiOmh0dHBfZmFsbGJhY2tfbG9vcFwiXV1cblx0ICAgICAgICBdO1xuXHQgICAgfVxuXHQgICAgZWxzZSB7XG5cdCAgICAgICAgd3NTdHJhdGVneSA9IFtcblx0ICAgICAgICAgICAgXCI6YmVzdF9jb25uZWN0ZWRfZXZlclwiLFxuXHQgICAgICAgICAgICBcIjp3c19sb29wXCIsXG5cdCAgICAgICAgICAgIFtcIjpkZWxheWVkXCIsIDIwMDAsIFtcIjp3c3NfbG9vcFwiXV0sXG5cdCAgICAgICAgICAgIFtcIjpkZWxheWVkXCIsIDUwMDAsIFtcIjpodHRwX2ZhbGxiYWNrX2xvb3BcIl1dXG5cdCAgICAgICAgXTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBbXG5cdCAgICAgICAgW1wiOmRlZlwiLCBcIndzX29wdGlvbnNcIiwge1xuXHQgICAgICAgICAgICAgICAgaG9zdFVuZW5jcnlwdGVkOiBjb25maWcud3NIb3N0ICsgXCI6XCIgKyBjb25maWcud3NQb3J0LFxuXHQgICAgICAgICAgICAgICAgaG9zdEVuY3J5cHRlZDogY29uZmlnLndzSG9zdCArIFwiOlwiICsgY29uZmlnLndzc1BvcnRcblx0ICAgICAgICAgICAgfV0sXG5cdCAgICAgICAgW1wiOmRlZlwiLCBcIndzc19vcHRpb25zXCIsIFtcIjpleHRlbmRcIiwgXCI6d3Nfb3B0aW9uc1wiLCB7XG5cdCAgICAgICAgICAgICAgICAgICAgZW5jcnlwdGVkOiB0cnVlXG5cdCAgICAgICAgICAgICAgICB9XV0sXG5cdCAgICAgICAgW1wiOmRlZlwiLCBcInNvY2tqc19vcHRpb25zXCIsIHtcblx0ICAgICAgICAgICAgICAgIGhvc3RVbmVuY3J5cHRlZDogY29uZmlnLmh0dHBIb3N0ICsgXCI6XCIgKyBjb25maWcuaHR0cFBvcnQsXG5cdCAgICAgICAgICAgICAgICBob3N0RW5jcnlwdGVkOiBjb25maWcuaHR0cEhvc3QgKyBcIjpcIiArIGNvbmZpZy5odHRwc1BvcnQsXG5cdCAgICAgICAgICAgICAgICBodHRwUGF0aDogY29uZmlnLmh0dHBQYXRoXG5cdCAgICAgICAgICAgIH1dLFxuXHQgICAgICAgIFtcIjpkZWZcIiwgXCJ0aW1lb3V0c1wiLCB7XG5cdCAgICAgICAgICAgICAgICBsb29wOiB0cnVlLFxuXHQgICAgICAgICAgICAgICAgdGltZW91dDogMTUwMDAsXG5cdCAgICAgICAgICAgICAgICB0aW1lb3V0TGltaXQ6IDYwMDAwXG5cdCAgICAgICAgICAgIH1dLFxuXHQgICAgICAgIFtcIjpkZWZcIiwgXCJ3c19tYW5hZ2VyXCIsIFtcIjp0cmFuc3BvcnRfbWFuYWdlclwiLCB7XG5cdCAgICAgICAgICAgICAgICAgICAgbGl2ZXM6IDIsXG5cdCAgICAgICAgICAgICAgICAgICAgbWluUGluZ0RlbGF5OiAxMDAwMCxcblx0ICAgICAgICAgICAgICAgICAgICBtYXhQaW5nRGVsYXk6IGNvbmZpZy5hY3Rpdml0eV90aW1lb3V0XG5cdCAgICAgICAgICAgICAgICB9XV0sXG5cdCAgICAgICAgW1wiOmRlZlwiLCBcInN0cmVhbWluZ19tYW5hZ2VyXCIsIFtcIjp0cmFuc3BvcnRfbWFuYWdlclwiLCB7XG5cdCAgICAgICAgICAgICAgICAgICAgbGl2ZXM6IDIsXG5cdCAgICAgICAgICAgICAgICAgICAgbWluUGluZ0RlbGF5OiAxMDAwMCxcblx0ICAgICAgICAgICAgICAgICAgICBtYXhQaW5nRGVsYXk6IGNvbmZpZy5hY3Rpdml0eV90aW1lb3V0XG5cdCAgICAgICAgICAgICAgICB9XV0sXG5cdCAgICAgICAgW1wiOmRlZl90cmFuc3BvcnRcIiwgXCJ3c1wiLCBcIndzXCIsIDMsIFwiOndzX29wdGlvbnNcIiwgXCI6d3NfbWFuYWdlclwiXSxcblx0ICAgICAgICBbXCI6ZGVmX3RyYW5zcG9ydFwiLCBcIndzc1wiLCBcIndzXCIsIDMsIFwiOndzc19vcHRpb25zXCIsIFwiOndzX21hbmFnZXJcIl0sXG5cdCAgICAgICAgW1wiOmRlZl90cmFuc3BvcnRcIiwgXCJzb2NranNcIiwgXCJzb2NranNcIiwgMSwgXCI6c29ja2pzX29wdGlvbnNcIl0sXG5cdCAgICAgICAgW1wiOmRlZl90cmFuc3BvcnRcIiwgXCJ4aHJfc3RyZWFtaW5nXCIsIFwieGhyX3N0cmVhbWluZ1wiLCAxLCBcIjpzb2NranNfb3B0aW9uc1wiLCBcIjpzdHJlYW1pbmdfbWFuYWdlclwiXSxcblx0ICAgICAgICBbXCI6ZGVmX3RyYW5zcG9ydFwiLCBcInhkcl9zdHJlYW1pbmdcIiwgXCJ4ZHJfc3RyZWFtaW5nXCIsIDEsIFwiOnNvY2tqc19vcHRpb25zXCIsIFwiOnN0cmVhbWluZ19tYW5hZ2VyXCJdLFxuXHQgICAgICAgIFtcIjpkZWZfdHJhbnNwb3J0XCIsIFwieGhyX3BvbGxpbmdcIiwgXCJ4aHJfcG9sbGluZ1wiLCAxLCBcIjpzb2NranNfb3B0aW9uc1wiXSxcblx0ICAgICAgICBbXCI6ZGVmX3RyYW5zcG9ydFwiLCBcInhkcl9wb2xsaW5nXCIsIFwieGRyX3BvbGxpbmdcIiwgMSwgXCI6c29ja2pzX29wdGlvbnNcIl0sXG5cdCAgICAgICAgW1wiOmRlZlwiLCBcIndzX2xvb3BcIiwgW1wiOnNlcXVlbnRpYWxcIiwgXCI6dGltZW91dHNcIiwgXCI6d3NcIl1dLFxuXHQgICAgICAgIFtcIjpkZWZcIiwgXCJ3c3NfbG9vcFwiLCBbXCI6c2VxdWVudGlhbFwiLCBcIjp0aW1lb3V0c1wiLCBcIjp3c3NcIl1dLFxuXHQgICAgICAgIFtcIjpkZWZcIiwgXCJzb2NranNfbG9vcFwiLCBbXCI6c2VxdWVudGlhbFwiLCBcIjp0aW1lb3V0c1wiLCBcIjpzb2NranNcIl1dLFxuXHQgICAgICAgIFtcIjpkZWZcIiwgXCJzdHJlYW1pbmdfbG9vcFwiLCBbXCI6c2VxdWVudGlhbFwiLCBcIjp0aW1lb3V0c1wiLFxuXHQgICAgICAgICAgICAgICAgW1wiOmlmXCIsIFtcIjppc19zdXBwb3J0ZWRcIiwgXCI6eGhyX3N0cmVhbWluZ1wiXSxcblx0ICAgICAgICAgICAgICAgICAgICBcIjp4aHJfc3RyZWFtaW5nXCIsXG5cdCAgICAgICAgICAgICAgICAgICAgXCI6eGRyX3N0cmVhbWluZ1wiXG5cdCAgICAgICAgICAgICAgICBdXG5cdCAgICAgICAgICAgIF1dLFxuXHQgICAgICAgIFtcIjpkZWZcIiwgXCJwb2xsaW5nX2xvb3BcIiwgW1wiOnNlcXVlbnRpYWxcIiwgXCI6dGltZW91dHNcIixcblx0ICAgICAgICAgICAgICAgIFtcIjppZlwiLCBbXCI6aXNfc3VwcG9ydGVkXCIsIFwiOnhocl9wb2xsaW5nXCJdLFxuXHQgICAgICAgICAgICAgICAgICAgIFwiOnhocl9wb2xsaW5nXCIsXG5cdCAgICAgICAgICAgICAgICAgICAgXCI6eGRyX3BvbGxpbmdcIlxuXHQgICAgICAgICAgICAgICAgXVxuXHQgICAgICAgICAgICBdXSxcblx0ICAgICAgICBbXCI6ZGVmXCIsIFwiaHR0cF9sb29wXCIsIFtcIjppZlwiLCBbXCI6aXNfc3VwcG9ydGVkXCIsIFwiOnN0cmVhbWluZ19sb29wXCJdLCBbXG5cdCAgICAgICAgICAgICAgICAgICAgXCI6YmVzdF9jb25uZWN0ZWRfZXZlclwiLFxuXHQgICAgICAgICAgICAgICAgICAgIFwiOnN0cmVhbWluZ19sb29wXCIsXG5cdCAgICAgICAgICAgICAgICAgICAgW1wiOmRlbGF5ZWRcIiwgNDAwMCwgW1wiOnBvbGxpbmdfbG9vcFwiXV1cblx0ICAgICAgICAgICAgICAgIF0sIFtcblx0ICAgICAgICAgICAgICAgICAgICBcIjpwb2xsaW5nX2xvb3BcIlxuXHQgICAgICAgICAgICAgICAgXV1dLFxuXHQgICAgICAgIFtcIjpkZWZcIiwgXCJodHRwX2ZhbGxiYWNrX2xvb3BcIixcblx0ICAgICAgICAgICAgW1wiOmlmXCIsIFtcIjppc19zdXBwb3J0ZWRcIiwgXCI6aHR0cF9sb29wXCJdLCBbXG5cdCAgICAgICAgICAgICAgICAgICAgXCI6aHR0cF9sb29wXCJcblx0ICAgICAgICAgICAgICAgIF0sIFtcblx0ICAgICAgICAgICAgICAgICAgICBcIjpzb2NranNfbG9vcFwiXG5cdCAgICAgICAgICAgICAgICBdXVxuXHQgICAgICAgIF0sXG5cdCAgICAgICAgW1wiOmRlZlwiLCBcInN0cmF0ZWd5XCIsXG5cdCAgICAgICAgICAgIFtcIjpjYWNoZWRcIiwgMTgwMDAwMCxcblx0ICAgICAgICAgICAgICAgIFtcIjpmaXJzdF9jb25uZWN0ZWRcIixcblx0ICAgICAgICAgICAgICAgICAgICBbXCI6aWZcIiwgW1wiOmlzX3N1cHBvcnRlZFwiLCBcIjp3c1wiXSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgd3NTdHJhdGVneSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgXCI6aHR0cF9mYWxsYmFja19sb29wXCJcblx0ICAgICAgICAgICAgICAgICAgICBdXG5cdCAgICAgICAgICAgICAgICBdXG5cdCAgICAgICAgICAgIF1cblx0ICAgICAgICBdXG5cdCAgICBdO1xuXHR9O1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IGdldERlZmF1bHRTdHJhdGVneTtcblxuXG4vKioqLyB9KSxcbi8qIDI3ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBkZXBlbmRlbmNpZXNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cdGZ1bmN0aW9uIGRlZmF1bHRfMSgpIHtcblx0ICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgIHNlbGYudGltZWxpbmUuaW5mbyhzZWxmLmJ1aWxkVGltZWxpbmVNZXNzYWdlKHtcblx0ICAgICAgICB0cmFuc3BvcnQ6IHNlbGYubmFtZSArIChzZWxmLm9wdGlvbnMuZW5jcnlwdGVkID8gXCJzXCIgOiBcIlwiKVxuXHQgICAgfSkpO1xuXHQgICAgaWYgKHNlbGYuaG9va3MuaXNJbml0aWFsaXplZCgpKSB7XG5cdCAgICAgICAgc2VsZi5jaGFuZ2VTdGF0ZShcImluaXRpYWxpemVkXCIpO1xuXHQgICAgfVxuXHQgICAgZWxzZSBpZiAoc2VsZi5ob29rcy5maWxlKSB7XG5cdCAgICAgICAgc2VsZi5jaGFuZ2VTdGF0ZShcImluaXRpYWxpemluZ1wiKTtcblx0ICAgICAgICBkZXBlbmRlbmNpZXNfMS5EZXBlbmRlbmNpZXMubG9hZChzZWxmLmhvb2tzLmZpbGUsIHsgZW5jcnlwdGVkOiBzZWxmLm9wdGlvbnMuZW5jcnlwdGVkIH0sIGZ1bmN0aW9uIChlcnJvciwgY2FsbGJhY2spIHtcblx0ICAgICAgICAgICAgaWYgKHNlbGYuaG9va3MuaXNJbml0aWFsaXplZCgpKSB7XG5cdCAgICAgICAgICAgICAgICBzZWxmLmNoYW5nZVN0YXRlKFwiaW5pdGlhbGl6ZWRcIik7XG5cdCAgICAgICAgICAgICAgICBjYWxsYmFjayh0cnVlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuXHQgICAgICAgICAgICAgICAgICAgIHNlbGYub25FcnJvcihlcnJvcik7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICBzZWxmLm9uQ2xvc2UoKTtcblx0ICAgICAgICAgICAgICAgIGNhbGxiYWNrKGZhbHNlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgfVxuXHQgICAgZWxzZSB7XG5cdCAgICAgICAgc2VsZi5vbkNsb3NlKCk7XG5cdCAgICB9XG5cdH1cblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBkZWZhdWx0XzE7XG5cblxuLyoqKi8gfSksXG4vKiAyOCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgaHR0cF94ZG9tYWluX3JlcXVlc3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpO1xuXHR2YXIgaHR0cF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSk7XG5cdGh0dHBfMVtcImRlZmF1bHRcIl0uY3JlYXRlWERSID0gZnVuY3Rpb24gKG1ldGhvZCwgdXJsKSB7XG5cdCAgICByZXR1cm4gdGhpcy5jcmVhdGVSZXF1ZXN0KGh0dHBfeGRvbWFpbl9yZXF1ZXN0XzFbXCJkZWZhdWx0XCJdLCBtZXRob2QsIHVybCk7XG5cdH07XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gaHR0cF8xW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqLyB9KSxcbi8qIDI5ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBFcnJvcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKTtcblx0dmFyIGhvb2tzID0ge1xuXHQgICAgZ2V0UmVxdWVzdDogZnVuY3Rpb24gKHNvY2tldCkge1xuXHQgICAgICAgIHZhciB4ZHIgPSBuZXcgd2luZG93LlhEb21haW5SZXF1ZXN0KCk7XG5cdCAgICAgICAgeGRyLm9udGltZW91dCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgc29ja2V0LmVtaXQoXCJlcnJvclwiLCBuZXcgRXJyb3JzLlJlcXVlc3RUaW1lZE91dCgpKTtcblx0ICAgICAgICAgICAgc29ja2V0LmNsb3NlKCk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB4ZHIub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgICAgIHNvY2tldC5lbWl0KFwiZXJyb3JcIiwgZSk7XG5cdCAgICAgICAgICAgIHNvY2tldC5jbG9zZSgpO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgeGRyLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIGlmICh4ZHIucmVzcG9uc2VUZXh0ICYmIHhkci5yZXNwb25zZVRleHQubGVuZ3RoID4gMCkge1xuXHQgICAgICAgICAgICAgICAgc29ja2V0Lm9uQ2h1bmsoMjAwLCB4ZHIucmVzcG9uc2VUZXh0KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdCAgICAgICAgeGRyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgaWYgKHhkci5yZXNwb25zZVRleHQgJiYgeGRyLnJlc3BvbnNlVGV4dC5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgICAgICBzb2NrZXQub25DaHVuaygyMDAsIHhkci5yZXNwb25zZVRleHQpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHNvY2tldC5lbWl0KFwiZmluaXNoZWRcIiwgMjAwKTtcblx0ICAgICAgICAgICAgc29ja2V0LmNsb3NlKCk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICByZXR1cm4geGRyO1xuXHQgICAgfSxcblx0ICAgIGFib3J0UmVxdWVzdDogZnVuY3Rpb24gKHhkcikge1xuXHQgICAgICAgIHhkci5vbnRpbWVvdXQgPSB4ZHIub25lcnJvciA9IHhkci5vbnByb2dyZXNzID0geGRyLm9ubG9hZCA9IG51bGw7XG5cdCAgICAgICAgeGRyLmFib3J0KCk7XG5cdCAgICB9XG5cdH07XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gaG9va3M7XG5cblxuLyoqKi8gfSksXG4vKiAzMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XG5cdCAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcblx0ICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuXHQgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuXHR9O1xuXHR2YXIgQmFkRXZlbnROYW1lID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcblx0ICAgIF9fZXh0ZW5kcyhCYWRFdmVudE5hbWUsIF9zdXBlcik7XG5cdCAgICBmdW5jdGlvbiBCYWRFdmVudE5hbWUoKSB7XG5cdCAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gQmFkRXZlbnROYW1lO1xuXHR9KEVycm9yKSk7XG5cdGV4cG9ydHMuQmFkRXZlbnROYW1lID0gQmFkRXZlbnROYW1lO1xuXHR2YXIgUmVxdWVzdFRpbWVkT3V0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcblx0ICAgIF9fZXh0ZW5kcyhSZXF1ZXN0VGltZWRPdXQsIF9zdXBlcik7XG5cdCAgICBmdW5jdGlvbiBSZXF1ZXN0VGltZWRPdXQoKSB7XG5cdCAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gUmVxdWVzdFRpbWVkT3V0O1xuXHR9KEVycm9yKSk7XG5cdGV4cG9ydHMuUmVxdWVzdFRpbWVkT3V0ID0gUmVxdWVzdFRpbWVkT3V0O1xuXHR2YXIgVHJhbnNwb3J0UHJpb3JpdHlUb29Mb3cgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuXHQgICAgX19leHRlbmRzKFRyYW5zcG9ydFByaW9yaXR5VG9vTG93LCBfc3VwZXIpO1xuXHQgICAgZnVuY3Rpb24gVHJhbnNwb3J0UHJpb3JpdHlUb29Mb3coKSB7XG5cdCAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gVHJhbnNwb3J0UHJpb3JpdHlUb29Mb3c7XG5cdH0oRXJyb3IpKTtcblx0ZXhwb3J0cy5UcmFuc3BvcnRQcmlvcml0eVRvb0xvdyA9IFRyYW5zcG9ydFByaW9yaXR5VG9vTG93O1xuXHR2YXIgVHJhbnNwb3J0Q2xvc2VkID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcblx0ICAgIF9fZXh0ZW5kcyhUcmFuc3BvcnRDbG9zZWQsIF9zdXBlcik7XG5cdCAgICBmdW5jdGlvbiBUcmFuc3BvcnRDbG9zZWQoKSB7XG5cdCAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gVHJhbnNwb3J0Q2xvc2VkO1xuXHR9KEVycm9yKSk7XG5cdGV4cG9ydHMuVHJhbnNwb3J0Q2xvc2VkID0gVHJhbnNwb3J0Q2xvc2VkO1xuXHR2YXIgVW5zdXBwb3J0ZWRUcmFuc3BvcnQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuXHQgICAgX19leHRlbmRzKFVuc3VwcG9ydGVkVHJhbnNwb3J0LCBfc3VwZXIpO1xuXHQgICAgZnVuY3Rpb24gVW5zdXBwb3J0ZWRUcmFuc3BvcnQoKSB7XG5cdCAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gVW5zdXBwb3J0ZWRUcmFuc3BvcnQ7XG5cdH0oRXJyb3IpKTtcblx0ZXhwb3J0cy5VbnN1cHBvcnRlZFRyYW5zcG9ydCA9IFVuc3VwcG9ydGVkVHJhbnNwb3J0O1xuXHR2YXIgVW5zdXBwb3J0ZWRTdHJhdGVneSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG5cdCAgICBfX2V4dGVuZHMoVW5zdXBwb3J0ZWRTdHJhdGVneSwgX3N1cGVyKTtcblx0ICAgIGZ1bmN0aW9uIFVuc3VwcG9ydGVkU3RyYXRlZ3koKSB7XG5cdCAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gVW5zdXBwb3J0ZWRTdHJhdGVneTtcblx0fShFcnJvcikpO1xuXHRleHBvcnRzLlVuc3VwcG9ydGVkU3RyYXRlZ3kgPSBVbnN1cHBvcnRlZFN0cmF0ZWd5O1xuXG5cbi8qKiovIH0pLFxuLyogMzEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIGh0dHBfcmVxdWVzdF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMik7XG5cdHZhciBodHRwX3NvY2tldF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMyk7XG5cdHZhciBodHRwX3N0cmVhbWluZ19zb2NrZXRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpO1xuXHR2YXIgaHR0cF9wb2xsaW5nX3NvY2tldF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNik7XG5cdHZhciBodHRwX3hocl9yZXF1ZXN0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM3KTtcblx0dmFyIEhUVFAgPSB7XG5cdCAgICBjcmVhdGVTdHJlYW1pbmdTb2NrZXQ6IGZ1bmN0aW9uICh1cmwpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVTb2NrZXQoaHR0cF9zdHJlYW1pbmdfc29ja2V0XzFbXCJkZWZhdWx0XCJdLCB1cmwpO1xuXHQgICAgfSxcblx0ICAgIGNyZWF0ZVBvbGxpbmdTb2NrZXQ6IGZ1bmN0aW9uICh1cmwpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVTb2NrZXQoaHR0cF9wb2xsaW5nX3NvY2tldF8xW1wiZGVmYXVsdFwiXSwgdXJsKTtcblx0ICAgIH0sXG5cdCAgICBjcmVhdGVTb2NrZXQ6IGZ1bmN0aW9uIChob29rcywgdXJsKSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBodHRwX3NvY2tldF8xW1wiZGVmYXVsdFwiXShob29rcywgdXJsKTtcblx0ICAgIH0sXG5cdCAgICBjcmVhdGVYSFI6IGZ1bmN0aW9uIChtZXRob2QsIHVybCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlcXVlc3QoaHR0cF94aHJfcmVxdWVzdF8xW1wiZGVmYXVsdFwiXSwgbWV0aG9kLCB1cmwpO1xuXHQgICAgfSxcblx0ICAgIGNyZWF0ZVJlcXVlc3Q6IGZ1bmN0aW9uIChob29rcywgbWV0aG9kLCB1cmwpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IGh0dHBfcmVxdWVzdF8xW1wiZGVmYXVsdFwiXShob29rcywgbWV0aG9kLCB1cmwpO1xuXHQgICAgfVxuXHR9O1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IEhUVFA7XG5cblxuLyoqKi8gfSksXG4vKiAzMiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XG5cdCAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcblx0ICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuXHQgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuXHR9O1xuXHR2YXIgcnVudGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIGRpc3BhdGNoZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpO1xuXHR2YXIgTUFYX0JVRkZFUl9MRU5HVEggPSAyNTYgKiAxMDI0O1xuXHR2YXIgSFRUUFJlcXVlc3QgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuXHQgICAgX19leHRlbmRzKEhUVFBSZXF1ZXN0LCBfc3VwZXIpO1xuXHQgICAgZnVuY3Rpb24gSFRUUFJlcXVlc3QoaG9va3MsIG1ldGhvZCwgdXJsKSB7XG5cdCAgICAgICAgX3N1cGVyLmNhbGwodGhpcyk7XG5cdCAgICAgICAgdGhpcy5ob29rcyA9IGhvb2tzO1xuXHQgICAgICAgIHRoaXMubWV0aG9kID0gbWV0aG9kO1xuXHQgICAgICAgIHRoaXMudXJsID0gdXJsO1xuXHQgICAgfVxuXHQgICAgSFRUUFJlcXVlc3QucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKHBheWxvYWQpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIHRoaXMucG9zaXRpb24gPSAwO1xuXHQgICAgICAgIHRoaXMueGhyID0gdGhpcy5ob29rcy5nZXRSZXF1ZXN0KHRoaXMpO1xuXHQgICAgICAgIHRoaXMudW5sb2FkZXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIF90aGlzLmNsb3NlKCk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICBydW50aW1lXzFbXCJkZWZhdWx0XCJdLmFkZFVubG9hZExpc3RlbmVyKHRoaXMudW5sb2FkZXIpO1xuXHQgICAgICAgIHRoaXMueGhyLm9wZW4odGhpcy5tZXRob2QsIHRoaXMudXJsLCB0cnVlKTtcblx0ICAgICAgICBpZiAodGhpcy54aHIuc2V0UmVxdWVzdEhlYWRlcikge1xuXHQgICAgICAgICAgICB0aGlzLnhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsIFwiYXBwbGljYXRpb24vanNvblwiKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy54aHIuc2VuZChwYXlsb2FkKTtcblx0ICAgIH07XG5cdCAgICBIVFRQUmVxdWVzdC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKHRoaXMudW5sb2FkZXIpIHtcblx0ICAgICAgICAgICAgcnVudGltZV8xW1wiZGVmYXVsdFwiXS5yZW1vdmVVbmxvYWRMaXN0ZW5lcih0aGlzLnVubG9hZGVyKTtcblx0ICAgICAgICAgICAgdGhpcy51bmxvYWRlciA9IG51bGw7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmICh0aGlzLnhocikge1xuXHQgICAgICAgICAgICB0aGlzLmhvb2tzLmFib3J0UmVxdWVzdCh0aGlzLnhocik7XG5cdCAgICAgICAgICAgIHRoaXMueGhyID0gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgSFRUUFJlcXVlc3QucHJvdG90eXBlLm9uQ2h1bmsgPSBmdW5jdGlvbiAoc3RhdHVzLCBkYXRhKSB7XG5cdCAgICAgICAgd2hpbGUgKHRydWUpIHtcblx0ICAgICAgICAgICAgdmFyIGNodW5rID0gdGhpcy5hZHZhbmNlQnVmZmVyKGRhdGEpO1xuXHQgICAgICAgICAgICBpZiAoY2h1bmspIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuZW1pdChcImNodW5rXCIsIHsgc3RhdHVzOiBzdGF0dXMsIGRhdGE6IGNodW5rIH0pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKHRoaXMuaXNCdWZmZXJUb29Mb25nKGRhdGEpKSB7XG5cdCAgICAgICAgICAgIHRoaXMuZW1pdChcImJ1ZmZlcl90b29fbG9uZ1wiKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgSFRUUFJlcXVlc3QucHJvdG90eXBlLmFkdmFuY2VCdWZmZXIgPSBmdW5jdGlvbiAoYnVmZmVyKSB7XG5cdCAgICAgICAgdmFyIHVucmVhZERhdGEgPSBidWZmZXIuc2xpY2UodGhpcy5wb3NpdGlvbik7XG5cdCAgICAgICAgdmFyIGVuZE9mTGluZVBvc2l0aW9uID0gdW5yZWFkRGF0YS5pbmRleE9mKFwiXFxuXCIpO1xuXHQgICAgICAgIGlmIChlbmRPZkxpbmVQb3NpdGlvbiAhPT0gLTEpIHtcblx0ICAgICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSBlbmRPZkxpbmVQb3NpdGlvbiArIDE7XG5cdCAgICAgICAgICAgIHJldHVybiB1bnJlYWREYXRhLnNsaWNlKDAsIGVuZE9mTGluZVBvc2l0aW9uKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBIVFRQUmVxdWVzdC5wcm90b3R5cGUuaXNCdWZmZXJUb29Mb25nID0gZnVuY3Rpb24gKGJ1ZmZlcikge1xuXHQgICAgICAgIHJldHVybiB0aGlzLnBvc2l0aW9uID09PSBidWZmZXIubGVuZ3RoICYmIGJ1ZmZlci5sZW5ndGggPiBNQVhfQlVGRkVSX0xFTkdUSDtcblx0ICAgIH07XG5cdCAgICByZXR1cm4gSFRUUFJlcXVlc3Q7XG5cdH0oZGlzcGF0Y2hlcl8xW1wiZGVmYXVsdFwiXSkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IEhUVFBSZXF1ZXN0O1xuXG5cbi8qKiovIH0pLFxuLyogMzMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIHN0YXRlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTtcblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXHR2YXIgcnVudGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIGF1dG9JbmNyZW1lbnQgPSAxO1xuXHR2YXIgSFRUUFNvY2tldCA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBIVFRQU29ja2V0KGhvb2tzLCB1cmwpIHtcblx0ICAgICAgICB0aGlzLmhvb2tzID0gaG9va3M7XG5cdCAgICAgICAgdGhpcy5zZXNzaW9uID0gcmFuZG9tTnVtYmVyKDEwMDApICsgXCIvXCIgKyByYW5kb21TdHJpbmcoOCk7XG5cdCAgICAgICAgdGhpcy5sb2NhdGlvbiA9IGdldExvY2F0aW9uKHVybCk7XG5cdCAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gc3RhdGVfMVtcImRlZmF1bHRcIl0uQ09OTkVDVElORztcblx0ICAgICAgICB0aGlzLm9wZW5TdHJlYW0oKTtcblx0ICAgIH1cblx0ICAgIEhUVFBTb2NrZXQucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAocGF5bG9hZCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLnNlbmRSYXcoSlNPTi5zdHJpbmdpZnkoW3BheWxvYWRdKSk7XG5cdCAgICB9O1xuXHQgICAgSFRUUFNvY2tldC5wcm90b3R5cGUucGluZyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLmhvb2tzLnNlbmRIZWFydGJlYXQodGhpcyk7XG5cdCAgICB9O1xuXHQgICAgSFRUUFNvY2tldC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoY29kZSwgcmVhc29uKSB7XG5cdCAgICAgICAgdGhpcy5vbkNsb3NlKGNvZGUsIHJlYXNvbiwgdHJ1ZSk7XG5cdCAgICB9O1xuXHQgICAgSFRUUFNvY2tldC5wcm90b3R5cGUuc2VuZFJhdyA9IGZ1bmN0aW9uIChwYXlsb2FkKSB7XG5cdCAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gc3RhdGVfMVtcImRlZmF1bHRcIl0uT1BFTikge1xuXHQgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgICAgcnVudGltZV8xW1wiZGVmYXVsdFwiXS5jcmVhdGVTb2NrZXRSZXF1ZXN0KFwiUE9TVFwiLCBnZXRVbmlxdWVVUkwoZ2V0U2VuZFVSTCh0aGlzLmxvY2F0aW9uLCB0aGlzLnNlc3Npb24pKSkuc3RhcnQocGF5bG9hZCk7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIEhUVFBTb2NrZXQucHJvdG90eXBlLnJlY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLmNsb3NlU3RyZWFtKCk7XG5cdCAgICAgICAgdGhpcy5vcGVuU3RyZWFtKCk7XG5cdCAgICB9O1xuXHQgICAgO1xuXHQgICAgSFRUUFNvY2tldC5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uIChjb2RlLCByZWFzb24sIHdhc0NsZWFuKSB7XG5cdCAgICAgICAgdGhpcy5jbG9zZVN0cmVhbSgpO1xuXHQgICAgICAgIHRoaXMucmVhZHlTdGF0ZSA9IHN0YXRlXzFbXCJkZWZhdWx0XCJdLkNMT1NFRDtcblx0ICAgICAgICBpZiAodGhpcy5vbmNsb3NlKSB7XG5cdCAgICAgICAgICAgIHRoaXMub25jbG9zZSh7XG5cdCAgICAgICAgICAgICAgICBjb2RlOiBjb2RlLFxuXHQgICAgICAgICAgICAgICAgcmVhc29uOiByZWFzb24sXG5cdCAgICAgICAgICAgICAgICB3YXNDbGVhbjogd2FzQ2xlYW5cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIEhUVFBTb2NrZXQucHJvdG90eXBlLm9uQ2h1bmsgPSBmdW5jdGlvbiAoY2h1bmspIHtcblx0ICAgICAgICBpZiAoY2h1bmsuc3RhdHVzICE9PSAyMDApIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSBzdGF0ZV8xW1wiZGVmYXVsdFwiXS5PUEVOKSB7XG5cdCAgICAgICAgICAgIHRoaXMub25BY3Rpdml0eSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB2YXIgcGF5bG9hZDtcblx0ICAgICAgICB2YXIgdHlwZSA9IGNodW5rLmRhdGEuc2xpY2UoMCwgMSk7XG5cdCAgICAgICAgc3dpdGNoICh0eXBlKSB7XG5cdCAgICAgICAgICAgIGNhc2UgJ28nOlxuXHQgICAgICAgICAgICAgICAgcGF5bG9hZCA9IEpTT04ucGFyc2UoY2h1bmsuZGF0YS5zbGljZSgxKSB8fCAne30nKTtcblx0ICAgICAgICAgICAgICAgIHRoaXMub25PcGVuKHBheWxvYWQpO1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIGNhc2UgJ2EnOlxuXHQgICAgICAgICAgICAgICAgcGF5bG9hZCA9IEpTT04ucGFyc2UoY2h1bmsuZGF0YS5zbGljZSgxKSB8fCAnW10nKTtcblx0ICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGF5bG9hZC5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChwYXlsb2FkW2ldKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICBjYXNlICdtJzpcblx0ICAgICAgICAgICAgICAgIHBheWxvYWQgPSBKU09OLnBhcnNlKGNodW5rLmRhdGEuc2xpY2UoMSkgfHwgJ251bGwnKTtcblx0ICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChwYXlsb2FkKTtcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICBjYXNlICdoJzpcblx0ICAgICAgICAgICAgICAgIHRoaXMuaG9va3Mub25IZWFydGJlYXQodGhpcyk7XG5cdCAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgY2FzZSAnYyc6XG5cdCAgICAgICAgICAgICAgICBwYXlsb2FkID0gSlNPTi5wYXJzZShjaHVuay5kYXRhLnNsaWNlKDEpIHx8ICdbXScpO1xuXHQgICAgICAgICAgICAgICAgdGhpcy5vbkNsb3NlKHBheWxvYWRbMF0sIHBheWxvYWRbMV0sIHRydWUpO1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIEhUVFBTb2NrZXQucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG5cdCAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gc3RhdGVfMVtcImRlZmF1bHRcIl0uQ09OTkVDVElORykge1xuXHQgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmhvc3RuYW1lKSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLmxvY2F0aW9uLmJhc2UgPSByZXBsYWNlSG9zdCh0aGlzLmxvY2F0aW9uLmJhc2UsIG9wdGlvbnMuaG9zdG5hbWUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHRoaXMucmVhZHlTdGF0ZSA9IHN0YXRlXzFbXCJkZWZhdWx0XCJdLk9QRU47XG5cdCAgICAgICAgICAgIGlmICh0aGlzLm9ub3Blbikge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5vbm9wZW4oKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgdGhpcy5vbkNsb3NlKDEwMDYsIFwiU2VydmVyIGxvc3Qgc2Vzc2lvblwiLCB0cnVlKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgSFRUUFNvY2tldC5wcm90b3R5cGUub25FdmVudCA9IGZ1bmN0aW9uIChldmVudCkge1xuXHQgICAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IHN0YXRlXzFbXCJkZWZhdWx0XCJdLk9QRU4gJiYgdGhpcy5vbm1lc3NhZ2UpIHtcblx0ICAgICAgICAgICAgdGhpcy5vbm1lc3NhZ2UoeyBkYXRhOiBldmVudCB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgSFRUUFNvY2tldC5wcm90b3R5cGUub25BY3Rpdml0eSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAodGhpcy5vbmFjdGl2aXR5KSB7XG5cdCAgICAgICAgICAgIHRoaXMub25hY3Rpdml0eSgpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBIVFRQU29ja2V0LnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgaWYgKHRoaXMub25lcnJvcikge1xuXHQgICAgICAgICAgICB0aGlzLm9uZXJyb3IoZXJyb3IpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBIVFRQU29ja2V0LnByb3RvdHlwZS5vcGVuU3RyZWFtID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdCAgICAgICAgdGhpcy5zdHJlYW0gPSBydW50aW1lXzFbXCJkZWZhdWx0XCJdLmNyZWF0ZVNvY2tldFJlcXVlc3QoXCJQT1NUXCIsIGdldFVuaXF1ZVVSTCh0aGlzLmhvb2tzLmdldFJlY2VpdmVVUkwodGhpcy5sb2NhdGlvbiwgdGhpcy5zZXNzaW9uKSkpO1xuXHQgICAgICAgIHRoaXMuc3RyZWFtLmJpbmQoXCJjaHVua1wiLCBmdW5jdGlvbiAoY2h1bmspIHtcblx0ICAgICAgICAgICAgX3RoaXMub25DaHVuayhjaHVuayk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgdGhpcy5zdHJlYW0uYmluZChcImZpbmlzaGVkXCIsIGZ1bmN0aW9uIChzdGF0dXMpIHtcblx0ICAgICAgICAgICAgX3RoaXMuaG9va3Mub25GaW5pc2hlZChfdGhpcywgc3RhdHVzKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgICB0aGlzLnN0cmVhbS5iaW5kKFwiYnVmZmVyX3Rvb19sb25nXCIsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgX3RoaXMucmVjb25uZWN0KCk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgdGhpcy5zdHJlYW0uc3RhcnQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG5cdCAgICAgICAgICAgIHV0aWxfMVtcImRlZmF1bHRcIl0uZGVmZXIoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMub25FcnJvcihlcnJvcik7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5vbkNsb3NlKDEwMDYsIFwiQ291bGQgbm90IHN0YXJ0IHN0cmVhbWluZ1wiLCBmYWxzZSk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBIVFRQU29ja2V0LnByb3RvdHlwZS5jbG9zZVN0cmVhbSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAodGhpcy5zdHJlYW0pIHtcblx0ICAgICAgICAgICAgdGhpcy5zdHJlYW0udW5iaW5kX2FsbCgpO1xuXHQgICAgICAgICAgICB0aGlzLnN0cmVhbS5jbG9zZSgpO1xuXHQgICAgICAgICAgICB0aGlzLnN0cmVhbSA9IG51bGw7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIHJldHVybiBIVFRQU29ja2V0O1xuXHR9KCkpO1xuXHRmdW5jdGlvbiBnZXRMb2NhdGlvbih1cmwpIHtcblx0ICAgIHZhciBwYXJ0cyA9IC8oW15cXD9dKilcXC8qKFxcPz8uKikvLmV4ZWModXJsKTtcblx0ICAgIHJldHVybiB7XG5cdCAgICAgICAgYmFzZTogcGFydHNbMV0sXG5cdCAgICAgICAgcXVlcnlTdHJpbmc6IHBhcnRzWzJdXG5cdCAgICB9O1xuXHR9XG5cdGZ1bmN0aW9uIGdldFNlbmRVUkwodXJsLCBzZXNzaW9uKSB7XG5cdCAgICByZXR1cm4gdXJsLmJhc2UgKyBcIi9cIiArIHNlc3Npb24gKyBcIi94aHJfc2VuZFwiO1xuXHR9XG5cdGZ1bmN0aW9uIGdldFVuaXF1ZVVSTCh1cmwpIHtcblx0ICAgIHZhciBzZXBhcmF0b3IgPSAodXJsLmluZGV4T2YoJz8nKSA9PT0gLTEpID8gXCI/XCIgOiBcIiZcIjtcblx0ICAgIHJldHVybiB1cmwgKyBzZXBhcmF0b3IgKyBcInQ9XCIgKyAoK25ldyBEYXRlKCkpICsgXCImbj1cIiArIGF1dG9JbmNyZW1lbnQrKztcblx0fVxuXHRmdW5jdGlvbiByZXBsYWNlSG9zdCh1cmwsIGhvc3RuYW1lKSB7XG5cdCAgICB2YXIgdXJsUGFydHMgPSAvKGh0dHBzPzpcXC9cXC8pKFteXFwvOl0rKSgoXFwvfDopPy4qKS8uZXhlYyh1cmwpO1xuXHQgICAgcmV0dXJuIHVybFBhcnRzWzFdICsgaG9zdG5hbWUgKyB1cmxQYXJ0c1szXTtcblx0fVxuXHRmdW5jdGlvbiByYW5kb21OdW1iZXIobWF4KSB7XG5cdCAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWF4KTtcblx0fVxuXHRmdW5jdGlvbiByYW5kb21TdHJpbmcobGVuZ3RoKSB7XG5cdCAgICB2YXIgcmVzdWx0ID0gW107XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgcmVzdWx0LnB1c2gocmFuZG9tTnVtYmVyKDMyKS50b1N0cmluZygzMikpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIHJlc3VsdC5qb2luKCcnKTtcblx0fVxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IEhUVFBTb2NrZXQ7XG5cblxuLyoqKi8gfSksXG4vKiAzNCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgU3RhdGU7XG5cdChmdW5jdGlvbiAoU3RhdGUpIHtcblx0ICAgIFN0YXRlW1N0YXRlW1wiQ09OTkVDVElOR1wiXSA9IDBdID0gXCJDT05ORUNUSU5HXCI7XG5cdCAgICBTdGF0ZVtTdGF0ZVtcIk9QRU5cIl0gPSAxXSA9IFwiT1BFTlwiO1xuXHQgICAgU3RhdGVbU3RhdGVbXCJDTE9TRURcIl0gPSAzXSA9IFwiQ0xPU0VEXCI7XG5cdH0pKFN0YXRlIHx8IChTdGF0ZSA9IHt9KSk7XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gU3RhdGU7XG5cblxuLyoqKi8gfSksXG4vKiAzNSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgaG9va3MgPSB7XG5cdCAgICBnZXRSZWNlaXZlVVJMOiBmdW5jdGlvbiAodXJsLCBzZXNzaW9uKSB7XG5cdCAgICAgICAgcmV0dXJuIHVybC5iYXNlICsgXCIvXCIgKyBzZXNzaW9uICsgXCIveGhyX3N0cmVhbWluZ1wiICsgdXJsLnF1ZXJ5U3RyaW5nO1xuXHQgICAgfSxcblx0ICAgIG9uSGVhcnRiZWF0OiBmdW5jdGlvbiAoc29ja2V0KSB7XG5cdCAgICAgICAgc29ja2V0LnNlbmRSYXcoXCJbXVwiKTtcblx0ICAgIH0sXG5cdCAgICBzZW5kSGVhcnRiZWF0OiBmdW5jdGlvbiAoc29ja2V0KSB7XG5cdCAgICAgICAgc29ja2V0LnNlbmRSYXcoXCJbXVwiKTtcblx0ICAgIH0sXG5cdCAgICBvbkZpbmlzaGVkOiBmdW5jdGlvbiAoc29ja2V0LCBzdGF0dXMpIHtcblx0ICAgICAgICBzb2NrZXQub25DbG9zZSgxMDA2LCBcIkNvbm5lY3Rpb24gaW50ZXJydXB0ZWQgKFwiICsgc3RhdHVzICsgXCIpXCIsIGZhbHNlKTtcblx0ICAgIH1cblx0fTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBob29rcztcblxuXG4vKioqLyB9KSxcbi8qIDM2ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBob29rcyA9IHtcblx0ICAgIGdldFJlY2VpdmVVUkw6IGZ1bmN0aW9uICh1cmwsIHNlc3Npb24pIHtcblx0ICAgICAgICByZXR1cm4gdXJsLmJhc2UgKyBcIi9cIiArIHNlc3Npb24gKyBcIi94aHJcIiArIHVybC5xdWVyeVN0cmluZztcblx0ICAgIH0sXG5cdCAgICBvbkhlYXJ0YmVhdDogZnVuY3Rpb24gKCkge1xuXHQgICAgfSxcblx0ICAgIHNlbmRIZWFydGJlYXQ6IGZ1bmN0aW9uIChzb2NrZXQpIHtcblx0ICAgICAgICBzb2NrZXQuc2VuZFJhdyhcIltdXCIpO1xuXHQgICAgfSxcblx0ICAgIG9uRmluaXNoZWQ6IGZ1bmN0aW9uIChzb2NrZXQsIHN0YXR1cykge1xuXHQgICAgICAgIGlmIChzdGF0dXMgPT09IDIwMCkge1xuXHQgICAgICAgICAgICBzb2NrZXQucmVjb25uZWN0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICBzb2NrZXQub25DbG9zZSgxMDA2LCBcIkNvbm5lY3Rpb24gaW50ZXJydXB0ZWQgKFwiICsgc3RhdHVzICsgXCIpXCIsIGZhbHNlKTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdH07XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gaG9va3M7XG5cblxuLyoqKi8gfSksXG4vKiAzNyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgcnVudGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIGhvb2tzID0ge1xuXHQgICAgZ2V0UmVxdWVzdDogZnVuY3Rpb24gKHNvY2tldCkge1xuXHQgICAgICAgIHZhciBDb25zdHJ1Y3RvciA9IHJ1bnRpbWVfMVtcImRlZmF1bHRcIl0uZ2V0WEhSQVBJKCk7XG5cdCAgICAgICAgdmFyIHhociA9IG5ldyBDb25zdHJ1Y3RvcigpO1xuXHQgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSB4aHIub25wcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgc3dpdGNoICh4aHIucmVhZHlTdGF0ZSkge1xuXHQgICAgICAgICAgICAgICAgY2FzZSAzOlxuXHQgICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VUZXh0ICYmIHhoci5yZXNwb25zZVRleHQubGVuZ3RoID4gMCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXQub25DaHVuayh4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VUZXh0KTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIDQ6XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZVRleHQgJiYgeGhyLnJlc3BvbnNlVGV4dC5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldC5vbkNodW5rKHhoci5zdGF0dXMsIHhoci5yZXNwb25zZVRleHQpO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICBzb2NrZXQuZW1pdChcImZpbmlzaGVkXCIsIHhoci5zdGF0dXMpO1xuXHQgICAgICAgICAgICAgICAgICAgIHNvY2tldC5jbG9zZSgpO1xuXHQgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfTtcblx0ICAgICAgICByZXR1cm4geGhyO1xuXHQgICAgfSxcblx0ICAgIGFib3J0UmVxdWVzdDogZnVuY3Rpb24gKHhocikge1xuXHQgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuXHQgICAgICAgIHhoci5hYm9ydCgpO1xuXHQgICAgfVxuXHR9O1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IGhvb2tzO1xuXG5cbi8qKiovIH0pLFxuLyogMzggKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIENvbGxlY3Rpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXHR2YXIgbGV2ZWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMzkpO1xuXHR2YXIgVGltZWxpbmUgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gVGltZWxpbmUoa2V5LCBzZXNzaW9uLCBvcHRpb25zKSB7XG5cdCAgICAgICAgdGhpcy5rZXkgPSBrZXk7XG5cdCAgICAgICAgdGhpcy5zZXNzaW9uID0gc2Vzc2lvbjtcblx0ICAgICAgICB0aGlzLmV2ZW50cyA9IFtdO1xuXHQgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICAgICAgdGhpcy5zZW50ID0gMDtcblx0ICAgICAgICB0aGlzLnVuaXF1ZUlEID0gMDtcblx0ICAgIH1cblx0ICAgIFRpbWVsaW5lLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAobGV2ZWwsIGV2ZW50KSB7XG5cdCAgICAgICAgaWYgKGxldmVsIDw9IHRoaXMub3B0aW9ucy5sZXZlbCkge1xuXHQgICAgICAgICAgICB0aGlzLmV2ZW50cy5wdXNoKENvbGxlY3Rpb25zLmV4dGVuZCh7fSwgZXZlbnQsIHsgdGltZXN0YW1wOiB1dGlsXzFbXCJkZWZhdWx0XCJdLm5vdygpIH0pKTtcblx0ICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5saW1pdCAmJiB0aGlzLmV2ZW50cy5sZW5ndGggPiB0aGlzLm9wdGlvbnMubGltaXQpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRzLnNoaWZ0KCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgVGltZWxpbmUucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cdCAgICAgICAgdGhpcy5sb2cobGV2ZWxfMVtcImRlZmF1bHRcIl0uRVJST1IsIGV2ZW50KTtcblx0ICAgIH07XG5cdCAgICBUaW1lbGluZS5wcm90b3R5cGUuaW5mbyA9IGZ1bmN0aW9uIChldmVudCkge1xuXHQgICAgICAgIHRoaXMubG9nKGxldmVsXzFbXCJkZWZhdWx0XCJdLklORk8sIGV2ZW50KTtcblx0ICAgIH07XG5cdCAgICBUaW1lbGluZS5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbiAoZXZlbnQpIHtcblx0ICAgICAgICB0aGlzLmxvZyhsZXZlbF8xW1wiZGVmYXVsdFwiXS5ERUJVRywgZXZlbnQpO1xuXHQgICAgfTtcblx0ICAgIFRpbWVsaW5lLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLmV2ZW50cy5sZW5ndGggPT09IDA7XG5cdCAgICB9O1xuXHQgICAgVGltZWxpbmUucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAoc2VuZGZuLCBjYWxsYmFjaykge1xuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdCAgICAgICAgdmFyIGRhdGEgPSBDb2xsZWN0aW9ucy5leHRlbmQoe1xuXHQgICAgICAgICAgICBzZXNzaW9uOiB0aGlzLnNlc3Npb24sXG5cdCAgICAgICAgICAgIGJ1bmRsZTogdGhpcy5zZW50ICsgMSxcblx0ICAgICAgICAgICAga2V5OiB0aGlzLmtleSxcblx0ICAgICAgICAgICAgbGliOiBcImpzXCIsXG5cdCAgICAgICAgICAgIHZlcnNpb246IHRoaXMub3B0aW9ucy52ZXJzaW9uLFxuXHQgICAgICAgICAgICBjbHVzdGVyOiB0aGlzLm9wdGlvbnMuY2x1c3Rlcixcblx0ICAgICAgICAgICAgZmVhdHVyZXM6IHRoaXMub3B0aW9ucy5mZWF0dXJlcyxcblx0ICAgICAgICAgICAgdGltZWxpbmU6IHRoaXMuZXZlbnRzXG5cdCAgICAgICAgfSwgdGhpcy5vcHRpb25zLnBhcmFtcyk7XG5cdCAgICAgICAgdGhpcy5ldmVudHMgPSBbXTtcblx0ICAgICAgICBzZW5kZm4oZGF0YSwgZnVuY3Rpb24gKGVycm9yLCByZXN1bHQpIHtcblx0ICAgICAgICAgICAgaWYgKCFlcnJvcikge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuc2VudCsrO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuXHQgICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIHJlc3VsdCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgIH07XG5cdCAgICBUaW1lbGluZS5wcm90b3R5cGUuZ2VuZXJhdGVVbmlxdWVJRCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLnVuaXF1ZUlEKys7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMudW5pcXVlSUQ7XG5cdCAgICB9O1xuXHQgICAgcmV0dXJuIFRpbWVsaW5lO1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IFRpbWVsaW5lO1xuXG5cbi8qKiovIH0pLFxuLyogMzkgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIFRpbWVsaW5lTGV2ZWw7XG5cdChmdW5jdGlvbiAoVGltZWxpbmVMZXZlbCkge1xuXHQgICAgVGltZWxpbmVMZXZlbFtUaW1lbGluZUxldmVsW1wiRVJST1JcIl0gPSAzXSA9IFwiRVJST1JcIjtcblx0ICAgIFRpbWVsaW5lTGV2ZWxbVGltZWxpbmVMZXZlbFtcIklORk9cIl0gPSA2XSA9IFwiSU5GT1wiO1xuXHQgICAgVGltZWxpbmVMZXZlbFtUaW1lbGluZUxldmVsW1wiREVCVUdcIl0gPSA3XSA9IFwiREVCVUdcIjtcblx0fSkoVGltZWxpbmVMZXZlbCB8fCAoVGltZWxpbmVMZXZlbCA9IHt9KSk7XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gVGltZWxpbmVMZXZlbDtcblxuXG4vKioqLyB9KSxcbi8qIDQwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBDb2xsZWN0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cdHZhciB1dGlsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTtcblx0dmFyIHRyYW5zcG9ydF9tYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQxKTtcblx0dmFyIEVycm9ycyA9IF9fd2VicGFja19yZXF1aXJlX18oMzApO1xuXHR2YXIgdHJhbnNwb3J0X3N0cmF0ZWd5XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KTtcblx0dmFyIHNlcXVlbnRpYWxfc3RyYXRlZ3lfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpO1xuXHR2YXIgYmVzdF9jb25uZWN0ZWRfZXZlcl9zdHJhdGVneV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1Nyk7XG5cdHZhciBjYWNoZWRfc3RyYXRlZ3lfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpO1xuXHR2YXIgZGVsYXllZF9zdHJhdGVneV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OSk7XG5cdHZhciBpZl9zdHJhdGVneV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MCk7XG5cdHZhciBmaXJzdF9jb25uZWN0ZWRfc3RyYXRlZ3lfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNjEpO1xuXHR2YXIgcnVudGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIFRyYW5zcG9ydHMgPSBydW50aW1lXzFbXCJkZWZhdWx0XCJdLlRyYW5zcG9ydHM7XG5cdGV4cG9ydHMuYnVpbGQgPSBmdW5jdGlvbiAoc2NoZW1lLCBvcHRpb25zKSB7XG5cdCAgICB2YXIgY29udGV4dCA9IENvbGxlY3Rpb25zLmV4dGVuZCh7fSwgZ2xvYmFsQ29udGV4dCwgb3B0aW9ucyk7XG5cdCAgICByZXR1cm4gZXZhbHVhdGUoc2NoZW1lLCBjb250ZXh0KVsxXS5zdHJhdGVneTtcblx0fTtcblx0dmFyIFVuc3VwcG9ydGVkU3RyYXRlZ3kgPSB7XG5cdCAgICBpc1N1cHBvcnRlZDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH0sXG5cdCAgICBjb25uZWN0OiBmdW5jdGlvbiAoXywgY2FsbGJhY2spIHtcblx0ICAgICAgICB2YXIgZGVmZXJyZWQgPSB1dGlsXzFbXCJkZWZhdWx0XCJdLmRlZmVyKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9ycy5VbnN1cHBvcnRlZFN0cmF0ZWd5KCkpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgIGFib3J0OiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBkZWZlcnJlZC5lbnN1cmVBYm9ydGVkKCk7XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIGZvcmNlTWluUHJpb3JpdHk6IGZ1bmN0aW9uICgpIHsgfVxuXHQgICAgICAgIH07XG5cdCAgICB9XG5cdH07XG5cdGZ1bmN0aW9uIHJldHVybldpdGhPcmlnaW5hbENvbnRleHQoZikge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uIChjb250ZXh0KSB7XG5cdCAgICAgICAgcmV0dXJuIFtmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIGNvbnRleHRdO1xuXHQgICAgfTtcblx0fVxuXHR2YXIgZ2xvYmFsQ29udGV4dCA9IHtcblx0ICAgIGV4dGVuZDogZnVuY3Rpb24gKGNvbnRleHQsIGZpcnN0LCBzZWNvbmQpIHtcblx0ICAgICAgICByZXR1cm4gW0NvbGxlY3Rpb25zLmV4dGVuZCh7fSwgZmlyc3QsIHNlY29uZCksIGNvbnRleHRdO1xuXHQgICAgfSxcblx0ICAgIGRlZjogZnVuY3Rpb24gKGNvbnRleHQsIG5hbWUsIHZhbHVlKSB7XG5cdCAgICAgICAgaWYgKGNvbnRleHRbbmFtZV0gIT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgICAgICB0aHJvdyBcIlJlZGVmaW5pbmcgc3ltYm9sIFwiICsgbmFtZTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgY29udGV4dFtuYW1lXSA9IHZhbHVlO1xuXHQgICAgICAgIHJldHVybiBbdW5kZWZpbmVkLCBjb250ZXh0XTtcblx0ICAgIH0sXG5cdCAgICBkZWZfdHJhbnNwb3J0OiBmdW5jdGlvbiAoY29udGV4dCwgbmFtZSwgdHlwZSwgcHJpb3JpdHksIG9wdGlvbnMsIG1hbmFnZXIpIHtcblx0ICAgICAgICB2YXIgdHJhbnNwb3J0Q2xhc3MgPSBUcmFuc3BvcnRzW3R5cGVdO1xuXHQgICAgICAgIGlmICghdHJhbnNwb3J0Q2xhc3MpIHtcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9ycy5VbnN1cHBvcnRlZFRyYW5zcG9ydCh0eXBlKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyIGVuYWJsZWQgPSAoIWNvbnRleHQuZW5hYmxlZFRyYW5zcG9ydHMgfHxcblx0ICAgICAgICAgICAgQ29sbGVjdGlvbnMuYXJyYXlJbmRleE9mKGNvbnRleHQuZW5hYmxlZFRyYW5zcG9ydHMsIG5hbWUpICE9PSAtMSkgJiZcblx0ICAgICAgICAgICAgKCFjb250ZXh0LmRpc2FibGVkVHJhbnNwb3J0cyB8fFxuXHQgICAgICAgICAgICAgICAgQ29sbGVjdGlvbnMuYXJyYXlJbmRleE9mKGNvbnRleHQuZGlzYWJsZWRUcmFuc3BvcnRzLCBuYW1lKSA9PT0gLTEpO1xuXHQgICAgICAgIHZhciB0cmFuc3BvcnQ7XG5cdCAgICAgICAgaWYgKGVuYWJsZWQpIHtcblx0ICAgICAgICAgICAgdHJhbnNwb3J0ID0gbmV3IHRyYW5zcG9ydF9zdHJhdGVneV8xW1wiZGVmYXVsdFwiXShuYW1lLCBwcmlvcml0eSwgbWFuYWdlciA/IG1hbmFnZXIuZ2V0QXNzaXN0YW50KHRyYW5zcG9ydENsYXNzKSA6IHRyYW5zcG9ydENsYXNzLCBDb2xsZWN0aW9ucy5leHRlbmQoe1xuXHQgICAgICAgICAgICAgICAga2V5OiBjb250ZXh0LmtleSxcblx0ICAgICAgICAgICAgICAgIGVuY3J5cHRlZDogY29udGV4dC5lbmNyeXB0ZWQsXG5cdCAgICAgICAgICAgICAgICB0aW1lbGluZTogY29udGV4dC50aW1lbGluZSxcblx0ICAgICAgICAgICAgICAgIGlnbm9yZU51bGxPcmlnaW46IGNvbnRleHQuaWdub3JlTnVsbE9yaWdpblxuXHQgICAgICAgICAgICB9LCBvcHRpb25zKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICB0cmFuc3BvcnQgPSBVbnN1cHBvcnRlZFN0cmF0ZWd5O1xuXHQgICAgICAgIH1cblx0ICAgICAgICB2YXIgbmV3Q29udGV4dCA9IGNvbnRleHQuZGVmKGNvbnRleHQsIG5hbWUsIHRyYW5zcG9ydClbMV07XG5cdCAgICAgICAgbmV3Q29udGV4dC5UcmFuc3BvcnRzID0gY29udGV4dC5UcmFuc3BvcnRzIHx8IHt9O1xuXHQgICAgICAgIG5ld0NvbnRleHQuVHJhbnNwb3J0c1tuYW1lXSA9IHRyYW5zcG9ydDtcblx0ICAgICAgICByZXR1cm4gW3VuZGVmaW5lZCwgbmV3Q29udGV4dF07XG5cdCAgICB9LFxuXHQgICAgdHJhbnNwb3J0X21hbmFnZXI6IHJldHVybldpdGhPcmlnaW5hbENvbnRleHQoZnVuY3Rpb24gKF8sIG9wdGlvbnMpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IHRyYW5zcG9ydF9tYW5hZ2VyXzFbXCJkZWZhdWx0XCJdKG9wdGlvbnMpO1xuXHQgICAgfSksXG5cdCAgICBzZXF1ZW50aWFsOiByZXR1cm5XaXRoT3JpZ2luYWxDb250ZXh0KGZ1bmN0aW9uIChfLCBvcHRpb25zKSB7XG5cdCAgICAgICAgdmFyIHN0cmF0ZWdpZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuXHQgICAgICAgIHJldHVybiBuZXcgc2VxdWVudGlhbF9zdHJhdGVneV8xW1wiZGVmYXVsdFwiXShzdHJhdGVnaWVzLCBvcHRpb25zKTtcblx0ICAgIH0pLFxuXHQgICAgY2FjaGVkOiByZXR1cm5XaXRoT3JpZ2luYWxDb250ZXh0KGZ1bmN0aW9uIChjb250ZXh0LCB0dGwsIHN0cmF0ZWd5KSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBjYWNoZWRfc3RyYXRlZ3lfMVtcImRlZmF1bHRcIl0oc3RyYXRlZ3ksIGNvbnRleHQuVHJhbnNwb3J0cywge1xuXHQgICAgICAgICAgICB0dGw6IHR0bCxcblx0ICAgICAgICAgICAgdGltZWxpbmU6IGNvbnRleHQudGltZWxpbmUsXG5cdCAgICAgICAgICAgIGVuY3J5cHRlZDogY29udGV4dC5lbmNyeXB0ZWRcblx0ICAgICAgICB9KTtcblx0ICAgIH0pLFxuXHQgICAgZmlyc3RfY29ubmVjdGVkOiByZXR1cm5XaXRoT3JpZ2luYWxDb250ZXh0KGZ1bmN0aW9uIChfLCBzdHJhdGVneSkge1xuXHQgICAgICAgIHJldHVybiBuZXcgZmlyc3RfY29ubmVjdGVkX3N0cmF0ZWd5XzFbXCJkZWZhdWx0XCJdKHN0cmF0ZWd5KTtcblx0ICAgIH0pLFxuXHQgICAgYmVzdF9jb25uZWN0ZWRfZXZlcjogcmV0dXJuV2l0aE9yaWdpbmFsQ29udGV4dChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIHN0cmF0ZWdpZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuXHQgICAgICAgIHJldHVybiBuZXcgYmVzdF9jb25uZWN0ZWRfZXZlcl9zdHJhdGVneV8xW1wiZGVmYXVsdFwiXShzdHJhdGVnaWVzKTtcblx0ICAgIH0pLFxuXHQgICAgZGVsYXllZDogcmV0dXJuV2l0aE9yaWdpbmFsQ29udGV4dChmdW5jdGlvbiAoXywgZGVsYXksIHN0cmF0ZWd5KSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBkZWxheWVkX3N0cmF0ZWd5XzFbXCJkZWZhdWx0XCJdKHN0cmF0ZWd5LCB7IGRlbGF5OiBkZWxheSB9KTtcblx0ICAgIH0pLFxuXHQgICAgXCJpZlwiOiByZXR1cm5XaXRoT3JpZ2luYWxDb250ZXh0KGZ1bmN0aW9uIChfLCB0ZXN0LCB0cnVlQnJhbmNoLCBmYWxzZUJyYW5jaCkge1xuXHQgICAgICAgIHJldHVybiBuZXcgaWZfc3RyYXRlZ3lfMVtcImRlZmF1bHRcIl0odGVzdCwgdHJ1ZUJyYW5jaCwgZmFsc2VCcmFuY2gpO1xuXHQgICAgfSksXG5cdCAgICBpc19zdXBwb3J0ZWQ6IHJldHVybldpdGhPcmlnaW5hbENvbnRleHQoZnVuY3Rpb24gKF8sIHN0cmF0ZWd5KSB7XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHN0cmF0ZWd5LmlzU3VwcG9ydGVkKCk7XG5cdCAgICAgICAgfTtcblx0ICAgIH0pXG5cdH07XG5cdGZ1bmN0aW9uIGlzU3ltYm9sKGV4cHJlc3Npb24pIHtcblx0ICAgIHJldHVybiAodHlwZW9mIGV4cHJlc3Npb24gPT09IFwic3RyaW5nXCIpICYmIGV4cHJlc3Npb24uY2hhckF0KDApID09PSBcIjpcIjtcblx0fVxuXHRmdW5jdGlvbiBnZXRTeW1ib2xWYWx1ZShleHByZXNzaW9uLCBjb250ZXh0KSB7XG5cdCAgICByZXR1cm4gY29udGV4dFtleHByZXNzaW9uLnNsaWNlKDEpXTtcblx0fVxuXHRmdW5jdGlvbiBldmFsdWF0ZUxpc3RPZkV4cHJlc3Npb25zKGV4cHJlc3Npb25zLCBjb250ZXh0KSB7XG5cdCAgICBpZiAoZXhwcmVzc2lvbnMubGVuZ3RoID09PSAwKSB7XG5cdCAgICAgICAgcmV0dXJuIFtbXSwgY29udGV4dF07XG5cdCAgICB9XG5cdCAgICB2YXIgaGVhZCA9IGV2YWx1YXRlKGV4cHJlc3Npb25zWzBdLCBjb250ZXh0KTtcblx0ICAgIHZhciB0YWlsID0gZXZhbHVhdGVMaXN0T2ZFeHByZXNzaW9ucyhleHByZXNzaW9ucy5zbGljZSgxKSwgaGVhZFsxXSk7XG5cdCAgICByZXR1cm4gW1toZWFkWzBdXS5jb25jYXQodGFpbFswXSksIHRhaWxbMV1dO1xuXHR9XG5cdGZ1bmN0aW9uIGV2YWx1YXRlU3RyaW5nKGV4cHJlc3Npb24sIGNvbnRleHQpIHtcblx0ICAgIGlmICghaXNTeW1ib2woZXhwcmVzc2lvbikpIHtcblx0ICAgICAgICByZXR1cm4gW2V4cHJlc3Npb24sIGNvbnRleHRdO1xuXHQgICAgfVxuXHQgICAgdmFyIHZhbHVlID0gZ2V0U3ltYm9sVmFsdWUoZXhwcmVzc2lvbiwgY29udGV4dCk7XG5cdCAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgIHRocm93IFwiVW5kZWZpbmVkIHN5bWJvbCBcIiArIGV4cHJlc3Npb247XG5cdCAgICB9XG5cdCAgICByZXR1cm4gW3ZhbHVlLCBjb250ZXh0XTtcblx0fVxuXHRmdW5jdGlvbiBldmFsdWF0ZUFycmF5KGV4cHJlc3Npb24sIGNvbnRleHQpIHtcblx0ICAgIGlmIChpc1N5bWJvbChleHByZXNzaW9uWzBdKSkge1xuXHQgICAgICAgIHZhciBmID0gZ2V0U3ltYm9sVmFsdWUoZXhwcmVzc2lvblswXSwgY29udGV4dCk7XG5cdCAgICAgICAgaWYgKGV4cHJlc3Npb24ubGVuZ3RoID4gMSkge1xuXHQgICAgICAgICAgICBpZiAodHlwZW9mIGYgIT09IFwiZnVuY3Rpb25cIikge1xuXHQgICAgICAgICAgICAgICAgdGhyb3cgXCJDYWxsaW5nIG5vbi1mdW5jdGlvbiBcIiArIGV4cHJlc3Npb25bMF07XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgdmFyIGFyZ3MgPSBbQ29sbGVjdGlvbnMuZXh0ZW5kKHt9LCBjb250ZXh0KV0uY29uY2F0KENvbGxlY3Rpb25zLm1hcChleHByZXNzaW9uLnNsaWNlKDEpLCBmdW5jdGlvbiAoYXJnKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gZXZhbHVhdGUoYXJnLCBDb2xsZWN0aW9ucy5leHRlbmQoe30sIGNvbnRleHQpKVswXTtcblx0ICAgICAgICAgICAgfSkpO1xuXHQgICAgICAgICAgICByZXR1cm4gZi5hcHBseSh0aGlzLCBhcmdzKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgIHJldHVybiBbZiwgY29udGV4dF07XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHQgICAgZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIGV2YWx1YXRlTGlzdE9mRXhwcmVzc2lvbnMoZXhwcmVzc2lvbiwgY29udGV4dCk7XG5cdCAgICB9XG5cdH1cblx0ZnVuY3Rpb24gZXZhbHVhdGUoZXhwcmVzc2lvbiwgY29udGV4dCkge1xuXHQgICAgaWYgKHR5cGVvZiBleHByZXNzaW9uID09PSBcInN0cmluZ1wiKSB7XG5cdCAgICAgICAgcmV0dXJuIGV2YWx1YXRlU3RyaW5nKGV4cHJlc3Npb24sIGNvbnRleHQpO1xuXHQgICAgfVxuXHQgICAgZWxzZSBpZiAodHlwZW9mIGV4cHJlc3Npb24gPT09IFwib2JqZWN0XCIpIHtcblx0ICAgICAgICBpZiAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFycmF5ICYmIGV4cHJlc3Npb24ubGVuZ3RoID4gMCkge1xuXHQgICAgICAgICAgICByZXR1cm4gZXZhbHVhdGVBcnJheShleHByZXNzaW9uLCBjb250ZXh0KTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gW2V4cHJlc3Npb24sIGNvbnRleHRdO1xuXHR9XG5cblxuLyoqKi8gfSksXG4vKiA0MSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgZmFjdG9yeV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Mik7XG5cdHZhciBUcmFuc3BvcnRNYW5hZ2VyID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIFRyYW5zcG9ydE1hbmFnZXIob3B0aW9ucykge1xuXHQgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICAgICAgdGhpcy5saXZlc0xlZnQgPSB0aGlzLm9wdGlvbnMubGl2ZXMgfHwgSW5maW5pdHk7XG5cdCAgICB9XG5cdCAgICBUcmFuc3BvcnRNYW5hZ2VyLnByb3RvdHlwZS5nZXRBc3Npc3RhbnQgPSBmdW5jdGlvbiAodHJhbnNwb3J0KSB7XG5cdCAgICAgICAgcmV0dXJuIGZhY3RvcnlfMVtcImRlZmF1bHRcIl0uY3JlYXRlQXNzaXN0YW50VG9UaGVUcmFuc3BvcnRNYW5hZ2VyKHRoaXMsIHRyYW5zcG9ydCwge1xuXHQgICAgICAgICAgICBtaW5QaW5nRGVsYXk6IHRoaXMub3B0aW9ucy5taW5QaW5nRGVsYXksXG5cdCAgICAgICAgICAgIG1heFBpbmdEZWxheTogdGhpcy5vcHRpb25zLm1heFBpbmdEZWxheVxuXHQgICAgICAgIH0pO1xuXHQgICAgfTtcblx0ICAgIFRyYW5zcG9ydE1hbmFnZXIucHJvdG90eXBlLmlzQWxpdmUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMubGl2ZXNMZWZ0ID4gMDtcblx0ICAgIH07XG5cdCAgICBUcmFuc3BvcnRNYW5hZ2VyLnByb3RvdHlwZS5yZXBvcnREZWF0aCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLmxpdmVzTGVmdCAtPSAxO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBUcmFuc3BvcnRNYW5hZ2VyO1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IFRyYW5zcG9ydE1hbmFnZXI7XG5cblxuLyoqKi8gfSksXG4vKiA0MiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgYXNzaXN0YW50X3RvX3RoZV90cmFuc3BvcnRfbWFuYWdlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7XG5cdHZhciBoYW5kc2hha2VfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpO1xuXHR2YXIgcHVzaGVyX2F1dGhvcml6ZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpO1xuXHR2YXIgdGltZWxpbmVfc2VuZGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4KTtcblx0dmFyIHByZXNlbmNlX2NoYW5uZWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpO1xuXHR2YXIgcHJpdmF0ZV9jaGFubmVsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTtcblx0dmFyIGNoYW5uZWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNTEpO1xuXHR2YXIgY29ubmVjdGlvbl9tYW5hZ2VyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUzKTtcblx0dmFyIGNoYW5uZWxzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KTtcblx0dmFyIEZhY3RvcnkgPSB7XG5cdCAgICBjcmVhdGVDaGFubmVsczogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiBuZXcgY2hhbm5lbHNfMVtcImRlZmF1bHRcIl0oKTtcblx0ICAgIH0sXG5cdCAgICBjcmVhdGVDb25uZWN0aW9uTWFuYWdlcjogZnVuY3Rpb24gKGtleSwgb3B0aW9ucykge1xuXHQgICAgICAgIHJldHVybiBuZXcgY29ubmVjdGlvbl9tYW5hZ2VyXzFbXCJkZWZhdWx0XCJdKGtleSwgb3B0aW9ucyk7XG5cdCAgICB9LFxuXHQgICAgY3JlYXRlQ2hhbm5lbDogZnVuY3Rpb24gKG5hbWUsIHB1c2hlcikge1xuXHQgICAgICAgIHJldHVybiBuZXcgY2hhbm5lbF8xW1wiZGVmYXVsdFwiXShuYW1lLCBwdXNoZXIpO1xuXHQgICAgfSxcblx0ICAgIGNyZWF0ZVByaXZhdGVDaGFubmVsOiBmdW5jdGlvbiAobmFtZSwgcHVzaGVyKSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBwcml2YXRlX2NoYW5uZWxfMVtcImRlZmF1bHRcIl0obmFtZSwgcHVzaGVyKTtcblx0ICAgIH0sXG5cdCAgICBjcmVhdGVQcmVzZW5jZUNoYW5uZWw6IGZ1bmN0aW9uIChuYW1lLCBwdXNoZXIpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IHByZXNlbmNlX2NoYW5uZWxfMVtcImRlZmF1bHRcIl0obmFtZSwgcHVzaGVyKTtcblx0ICAgIH0sXG5cdCAgICBjcmVhdGVUaW1lbGluZVNlbmRlcjogZnVuY3Rpb24gKHRpbWVsaW5lLCBvcHRpb25zKSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyB0aW1lbGluZV9zZW5kZXJfMVtcImRlZmF1bHRcIl0odGltZWxpbmUsIG9wdGlvbnMpO1xuXHQgICAgfSxcblx0ICAgIGNyZWF0ZUF1dGhvcml6ZXI6IGZ1bmN0aW9uIChjaGFubmVsLCBvcHRpb25zKSB7XG5cdCAgICAgICAgaWYgKG9wdGlvbnMuYXV0aG9yaXplcikge1xuXHQgICAgICAgICAgICByZXR1cm4gb3B0aW9ucy5hdXRob3JpemVyKGNoYW5uZWwsIG9wdGlvbnMpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gbmV3IHB1c2hlcl9hdXRob3JpemVyXzFbXCJkZWZhdWx0XCJdKGNoYW5uZWwsIG9wdGlvbnMpO1xuXHQgICAgfSxcblx0ICAgIGNyZWF0ZUhhbmRzaGFrZTogZnVuY3Rpb24gKHRyYW5zcG9ydCwgY2FsbGJhY2spIHtcblx0ICAgICAgICByZXR1cm4gbmV3IGhhbmRzaGFrZV8xW1wiZGVmYXVsdFwiXSh0cmFuc3BvcnQsIGNhbGxiYWNrKTtcblx0ICAgIH0sXG5cdCAgICBjcmVhdGVBc3Npc3RhbnRUb1RoZVRyYW5zcG9ydE1hbmFnZXI6IGZ1bmN0aW9uIChtYW5hZ2VyLCB0cmFuc3BvcnQsIG9wdGlvbnMpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IGFzc2lzdGFudF90b190aGVfdHJhbnNwb3J0X21hbmFnZXJfMVtcImRlZmF1bHRcIl0obWFuYWdlciwgdHJhbnNwb3J0LCBvcHRpb25zKTtcblx0ICAgIH1cblx0fTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBGYWN0b3J5O1xuXG5cbi8qKiovIH0pLFxuLyogNDMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXHR2YXIgQ29sbGVjdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXHR2YXIgQXNzaXN0YW50VG9UaGVUcmFuc3BvcnRNYW5hZ2VyID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIEFzc2lzdGFudFRvVGhlVHJhbnNwb3J0TWFuYWdlcihtYW5hZ2VyLCB0cmFuc3BvcnQsIG9wdGlvbnMpIHtcblx0ICAgICAgICB0aGlzLm1hbmFnZXIgPSBtYW5hZ2VyO1xuXHQgICAgICAgIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0O1xuXHQgICAgICAgIHRoaXMubWluUGluZ0RlbGF5ID0gb3B0aW9ucy5taW5QaW5nRGVsYXk7XG5cdCAgICAgICAgdGhpcy5tYXhQaW5nRGVsYXkgPSBvcHRpb25zLm1heFBpbmdEZWxheTtcblx0ICAgICAgICB0aGlzLnBpbmdEZWxheSA9IHVuZGVmaW5lZDtcblx0ICAgIH1cblx0ICAgIEFzc2lzdGFudFRvVGhlVHJhbnNwb3J0TWFuYWdlci5wcm90b3R5cGUuY3JlYXRlQ29ubmVjdGlvbiA9IGZ1bmN0aW9uIChuYW1lLCBwcmlvcml0eSwga2V5LCBvcHRpb25zKSB7XG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0ICAgICAgICBvcHRpb25zID0gQ29sbGVjdGlvbnMuZXh0ZW5kKHt9LCBvcHRpb25zLCB7XG5cdCAgICAgICAgICAgIGFjdGl2aXR5VGltZW91dDogdGhpcy5waW5nRGVsYXlcblx0ICAgICAgICB9KTtcblx0ICAgICAgICB2YXIgY29ubmVjdGlvbiA9IHRoaXMudHJhbnNwb3J0LmNyZWF0ZUNvbm5lY3Rpb24obmFtZSwgcHJpb3JpdHksIGtleSwgb3B0aW9ucyk7XG5cdCAgICAgICAgdmFyIG9wZW5UaW1lc3RhbXAgPSBudWxsO1xuXHQgICAgICAgIHZhciBvbk9wZW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIGNvbm5lY3Rpb24udW5iaW5kKFwib3BlblwiLCBvbk9wZW4pO1xuXHQgICAgICAgICAgICBjb25uZWN0aW9uLmJpbmQoXCJjbG9zZWRcIiwgb25DbG9zZWQpO1xuXHQgICAgICAgICAgICBvcGVuVGltZXN0YW1wID0gdXRpbF8xW1wiZGVmYXVsdFwiXS5ub3coKTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHZhciBvbkNsb3NlZCA9IGZ1bmN0aW9uIChjbG9zZUV2ZW50KSB7XG5cdCAgICAgICAgICAgIGNvbm5lY3Rpb24udW5iaW5kKFwiY2xvc2VkXCIsIG9uQ2xvc2VkKTtcblx0ICAgICAgICAgICAgaWYgKGNsb3NlRXZlbnQuY29kZSA9PT0gMTAwMiB8fCBjbG9zZUV2ZW50LmNvZGUgPT09IDEwMDMpIHtcblx0ICAgICAgICAgICAgICAgIF90aGlzLm1hbmFnZXIucmVwb3J0RGVhdGgoKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBlbHNlIGlmICghY2xvc2VFdmVudC53YXNDbGVhbiAmJiBvcGVuVGltZXN0YW1wKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgbGlmZXNwYW4gPSB1dGlsXzFbXCJkZWZhdWx0XCJdLm5vdygpIC0gb3BlblRpbWVzdGFtcDtcblx0ICAgICAgICAgICAgICAgIGlmIChsaWZlc3BhbiA8IDIgKiBfdGhpcy5tYXhQaW5nRGVsYXkpIHtcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpcy5tYW5hZ2VyLnJlcG9ydERlYXRoKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXMucGluZ0RlbGF5ID0gTWF0aC5tYXgobGlmZXNwYW4gLyAyLCBfdGhpcy5taW5QaW5nRGVsYXkpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfTtcblx0ICAgICAgICBjb25uZWN0aW9uLmJpbmQoXCJvcGVuXCIsIG9uT3Blbik7XG5cdCAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb247XG5cdCAgICB9O1xuXHQgICAgQXNzaXN0YW50VG9UaGVUcmFuc3BvcnRNYW5hZ2VyLnByb3RvdHlwZS5pc1N1cHBvcnRlZCA9IGZ1bmN0aW9uIChlbnZpcm9ubWVudCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLm1hbmFnZXIuaXNBbGl2ZSgpICYmIHRoaXMudHJhbnNwb3J0LmlzU3VwcG9ydGVkKGVudmlyb25tZW50KTtcblx0ICAgIH07XG5cdCAgICByZXR1cm4gQXNzaXN0YW50VG9UaGVUcmFuc3BvcnRNYW5hZ2VyO1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IEFzc2lzdGFudFRvVGhlVHJhbnNwb3J0TWFuYWdlcjtcblxuXG4vKioqLyB9KSxcbi8qIDQ0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBDb2xsZWN0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cdHZhciBQcm90b2NvbCA9IF9fd2VicGFja19yZXF1aXJlX18oNDUpO1xuXHR2YXIgY29ubmVjdGlvbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nik7XG5cdHZhciBIYW5kc2hha2UgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gSGFuZHNoYWtlKHRyYW5zcG9ydCwgY2FsbGJhY2spIHtcblx0ICAgICAgICB0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDtcblx0ICAgICAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG5cdCAgICAgICAgdGhpcy5iaW5kTGlzdGVuZXJzKCk7XG5cdCAgICB9XG5cdCAgICBIYW5kc2hha2UucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRoaXMudW5iaW5kTGlzdGVuZXJzKCk7XG5cdCAgICAgICAgdGhpcy50cmFuc3BvcnQuY2xvc2UoKTtcblx0ICAgIH07XG5cdCAgICBIYW5kc2hha2UucHJvdG90eXBlLmJpbmRMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0ICAgICAgICB0aGlzLm9uTWVzc2FnZSA9IGZ1bmN0aW9uIChtKSB7XG5cdCAgICAgICAgICAgIF90aGlzLnVuYmluZExpc3RlbmVycygpO1xuXHQgICAgICAgICAgICB2YXIgcmVzdWx0O1xuXHQgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgICAgcmVzdWx0ID0gUHJvdG9jb2wucHJvY2Vzc0hhbmRzaGFrZShtKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuZmluaXNoKFwiZXJyb3JcIiwgeyBlcnJvcjogZSB9KTtcblx0ICAgICAgICAgICAgICAgIF90aGlzLnRyYW5zcG9ydC5jbG9zZSgpO1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGlmIChyZXN1bHQuYWN0aW9uID09PSBcImNvbm5lY3RlZFwiKSB7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5maW5pc2goXCJjb25uZWN0ZWRcIiwge1xuXHQgICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb246IG5ldyBjb25uZWN0aW9uXzFbXCJkZWZhdWx0XCJdKHJlc3VsdC5pZCwgX3RoaXMudHJhbnNwb3J0KSxcblx0ICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eVRpbWVvdXQ6IHJlc3VsdC5hY3Rpdml0eVRpbWVvdXRcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuZmluaXNoKHJlc3VsdC5hY3Rpb24sIHsgZXJyb3I6IHJlc3VsdC5lcnJvciB9KTtcblx0ICAgICAgICAgICAgICAgIF90aGlzLnRyYW5zcG9ydC5jbG9zZSgpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB0aGlzLm9uQ2xvc2VkID0gZnVuY3Rpb24gKGNsb3NlRXZlbnQpIHtcblx0ICAgICAgICAgICAgX3RoaXMudW5iaW5kTGlzdGVuZXJzKCk7XG5cdCAgICAgICAgICAgIHZhciBhY3Rpb24gPSBQcm90b2NvbC5nZXRDbG9zZUFjdGlvbihjbG9zZUV2ZW50KSB8fCBcImJhY2tvZmZcIjtcblx0ICAgICAgICAgICAgdmFyIGVycm9yID0gUHJvdG9jb2wuZ2V0Q2xvc2VFcnJvcihjbG9zZUV2ZW50KTtcblx0ICAgICAgICAgICAgX3RoaXMuZmluaXNoKGFjdGlvbiwgeyBlcnJvcjogZXJyb3IgfSk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB0aGlzLnRyYW5zcG9ydC5iaW5kKFwibWVzc2FnZVwiLCB0aGlzLm9uTWVzc2FnZSk7XG5cdCAgICAgICAgdGhpcy50cmFuc3BvcnQuYmluZChcImNsb3NlZFwiLCB0aGlzLm9uQ2xvc2VkKTtcblx0ICAgIH07XG5cdCAgICBIYW5kc2hha2UucHJvdG90eXBlLnVuYmluZExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLnRyYW5zcG9ydC51bmJpbmQoXCJtZXNzYWdlXCIsIHRoaXMub25NZXNzYWdlKTtcblx0ICAgICAgICB0aGlzLnRyYW5zcG9ydC51bmJpbmQoXCJjbG9zZWRcIiwgdGhpcy5vbkNsb3NlZCk7XG5cdCAgICB9O1xuXHQgICAgSGFuZHNoYWtlLnByb3RvdHlwZS5maW5pc2ggPSBmdW5jdGlvbiAoYWN0aW9uLCBwYXJhbXMpIHtcblx0ICAgICAgICB0aGlzLmNhbGxiYWNrKENvbGxlY3Rpb25zLmV4dGVuZCh7IHRyYW5zcG9ydDogdGhpcy50cmFuc3BvcnQsIGFjdGlvbjogYWN0aW9uIH0sIHBhcmFtcykpO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBIYW5kc2hha2U7XG5cdH0oKSk7XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gSGFuZHNoYWtlO1xuXG5cbi8qKiovIH0pLFxuLyogNDUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0ZXhwb3J0cy5kZWNvZGVNZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcblx0ICAgIHRyeSB7XG5cdCAgICAgICAgdmFyIHBhcmFtcyA9IEpTT04ucGFyc2UobWVzc2FnZS5kYXRhKTtcblx0ICAgICAgICBpZiAodHlwZW9mIHBhcmFtcy5kYXRhID09PSAnc3RyaW5nJykge1xuXHQgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgICAgcGFyYW1zLmRhdGEgPSBKU09OLnBhcnNlKHBhcmFtcy5kYXRhKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIFN5bnRheEVycm9yKSkge1xuXHQgICAgICAgICAgICAgICAgICAgIHRocm93IGU7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIHBhcmFtcztcblx0ICAgIH1cblx0ICAgIGNhdGNoIChlKSB7XG5cdCAgICAgICAgdGhyb3cgeyB0eXBlOiAnTWVzc2FnZVBhcnNlRXJyb3InLCBlcnJvcjogZSwgZGF0YTogbWVzc2FnZS5kYXRhIH07XG5cdCAgICB9XG5cdH07XG5cdGV4cG9ydHMuZW5jb2RlTWVzc2FnZSA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG5cdCAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobWVzc2FnZSk7XG5cdH07XG5cdGV4cG9ydHMucHJvY2Vzc0hhbmRzaGFrZSA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG5cdCAgICBtZXNzYWdlID0gZXhwb3J0cy5kZWNvZGVNZXNzYWdlKG1lc3NhZ2UpO1xuXHQgICAgaWYgKG1lc3NhZ2UuZXZlbnQgPT09IFwicHVzaGVyOmNvbm5lY3Rpb25fZXN0YWJsaXNoZWRcIikge1xuXHQgICAgICAgIGlmICghbWVzc2FnZS5kYXRhLmFjdGl2aXR5X3RpbWVvdXQpIHtcblx0ICAgICAgICAgICAgdGhyb3cgXCJObyBhY3Rpdml0eSB0aW1lb3V0IHNwZWNpZmllZCBpbiBoYW5kc2hha2VcIjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgYWN0aW9uOiBcImNvbm5lY3RlZFwiLFxuXHQgICAgICAgICAgICBpZDogbWVzc2FnZS5kYXRhLnNvY2tldF9pZCxcblx0ICAgICAgICAgICAgYWN0aXZpdHlUaW1lb3V0OiBtZXNzYWdlLmRhdGEuYWN0aXZpdHlfdGltZW91dCAqIDEwMDBcblx0ICAgICAgICB9O1xuXHQgICAgfVxuXHQgICAgZWxzZSBpZiAobWVzc2FnZS5ldmVudCA9PT0gXCJwdXNoZXI6ZXJyb3JcIikge1xuXHQgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgIGFjdGlvbjogdGhpcy5nZXRDbG9zZUFjdGlvbihtZXNzYWdlLmRhdGEpLFxuXHQgICAgICAgICAgICBlcnJvcjogdGhpcy5nZXRDbG9zZUVycm9yKG1lc3NhZ2UuZGF0YSlcblx0ICAgICAgICB9O1xuXHQgICAgfVxuXHQgICAgZWxzZSB7XG5cdCAgICAgICAgdGhyb3cgXCJJbnZhbGlkIGhhbmRzaGFrZVwiO1xuXHQgICAgfVxuXHR9O1xuXHRleHBvcnRzLmdldENsb3NlQWN0aW9uID0gZnVuY3Rpb24gKGNsb3NlRXZlbnQpIHtcblx0ICAgIGlmIChjbG9zZUV2ZW50LmNvZGUgPCA0MDAwKSB7XG5cdCAgICAgICAgaWYgKGNsb3NlRXZlbnQuY29kZSA+PSAxMDAyICYmIGNsb3NlRXZlbnQuY29kZSA8PSAxMDA0KSB7XG5cdCAgICAgICAgICAgIHJldHVybiBcImJhY2tvZmZcIjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIGVsc2UgaWYgKGNsb3NlRXZlbnQuY29kZSA9PT0gNDAwMCkge1xuXHQgICAgICAgIHJldHVybiBcInNzbF9vbmx5XCI7XG5cdCAgICB9XG5cdCAgICBlbHNlIGlmIChjbG9zZUV2ZW50LmNvZGUgPCA0MTAwKSB7XG5cdCAgICAgICAgcmV0dXJuIFwicmVmdXNlZFwiO1xuXHQgICAgfVxuXHQgICAgZWxzZSBpZiAoY2xvc2VFdmVudC5jb2RlIDwgNDIwMCkge1xuXHQgICAgICAgIHJldHVybiBcImJhY2tvZmZcIjtcblx0ICAgIH1cblx0ICAgIGVsc2UgaWYgKGNsb3NlRXZlbnQuY29kZSA8IDQzMDApIHtcblx0ICAgICAgICByZXR1cm4gXCJyZXRyeVwiO1xuXHQgICAgfVxuXHQgICAgZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIFwicmVmdXNlZFwiO1xuXHQgICAgfVxuXHR9O1xuXHRleHBvcnRzLmdldENsb3NlRXJyb3IgPSBmdW5jdGlvbiAoY2xvc2VFdmVudCkge1xuXHQgICAgaWYgKGNsb3NlRXZlbnQuY29kZSAhPT0gMTAwMCAmJiBjbG9zZUV2ZW50LmNvZGUgIT09IDEwMDEpIHtcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICB0eXBlOiAnUHVzaGVyRXJyb3InLFxuXHQgICAgICAgICAgICBkYXRhOiB7XG5cdCAgICAgICAgICAgICAgICBjb2RlOiBjbG9zZUV2ZW50LmNvZGUsXG5cdCAgICAgICAgICAgICAgICBtZXNzYWdlOiBjbG9zZUV2ZW50LnJlYXNvbiB8fCBjbG9zZUV2ZW50Lm1lc3NhZ2Vcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdCAgICB9XG5cdCAgICBlbHNlIHtcblx0ICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgIH1cblx0fTtcblxuXG4vKioqLyB9KSxcbi8qIDQ2ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcblx0ICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xuXHQgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG5cdCAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG5cdH07XG5cdHZhciBDb2xsZWN0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cdHZhciBkaXNwYXRjaGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTtcblx0dmFyIFByb3RvY29sID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NSk7XG5cdHZhciBsb2dnZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cdHZhciBDb25uZWN0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcblx0ICAgIF9fZXh0ZW5kcyhDb25uZWN0aW9uLCBfc3VwZXIpO1xuXHQgICAgZnVuY3Rpb24gQ29ubmVjdGlvbihpZCwgdHJhbnNwb3J0KSB7XG5cdCAgICAgICAgX3N1cGVyLmNhbGwodGhpcyk7XG5cdCAgICAgICAgdGhpcy5pZCA9IGlkO1xuXHQgICAgICAgIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0O1xuXHQgICAgICAgIHRoaXMuYWN0aXZpdHlUaW1lb3V0ID0gdHJhbnNwb3J0LmFjdGl2aXR5VGltZW91dDtcblx0ICAgICAgICB0aGlzLmJpbmRMaXN0ZW5lcnMoKTtcblx0ICAgIH1cblx0ICAgIENvbm5lY3Rpb24ucHJvdG90eXBlLmhhbmRsZXNBY3Rpdml0eUNoZWNrcyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy50cmFuc3BvcnQuaGFuZGxlc0FjdGl2aXR5Q2hlY2tzKCk7XG5cdCAgICB9O1xuXHQgICAgQ29ubmVjdGlvbi5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNwb3J0LnNlbmQoZGF0YSk7XG5cdCAgICB9O1xuXHQgICAgQ29ubmVjdGlvbi5wcm90b3R5cGUuc2VuZF9ldmVudCA9IGZ1bmN0aW9uIChuYW1lLCBkYXRhLCBjaGFubmVsKSB7XG5cdCAgICAgICAgdmFyIG1lc3NhZ2UgPSB7IGV2ZW50OiBuYW1lLCBkYXRhOiBkYXRhIH07XG5cdCAgICAgICAgaWYgKGNoYW5uZWwpIHtcblx0ICAgICAgICAgICAgbWVzc2FnZS5jaGFubmVsID0gY2hhbm5lbDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgbG9nZ2VyXzFbXCJkZWZhdWx0XCJdLmRlYnVnKCdFdmVudCBzZW50JywgbWVzc2FnZSk7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuc2VuZChQcm90b2NvbC5lbmNvZGVNZXNzYWdlKG1lc3NhZ2UpKTtcblx0ICAgIH07XG5cdCAgICBDb25uZWN0aW9uLnByb3RvdHlwZS5waW5nID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICh0aGlzLnRyYW5zcG9ydC5zdXBwb3J0c1BpbmcoKSkge1xuXHQgICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5waW5nKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICB0aGlzLnNlbmRfZXZlbnQoJ3B1c2hlcjpwaW5nJywge30pO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBDb25uZWN0aW9uLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLnRyYW5zcG9ydC5jbG9zZSgpO1xuXHQgICAgfTtcblx0ICAgIENvbm5lY3Rpb24ucHJvdG90eXBlLmJpbmRMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0ICAgICAgICB2YXIgbGlzdGVuZXJzID0ge1xuXHQgICAgICAgICAgICBtZXNzYWdlOiBmdW5jdGlvbiAobSkge1xuXHQgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2U7XG5cdCAgICAgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBQcm90b2NvbC5kZWNvZGVNZXNzYWdlKG0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpcy5lbWl0KCdlcnJvcicsIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ01lc3NhZ2VQYXJzZUVycm9yJyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGUsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IG0uZGF0YVxuXHQgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgICAgICAgICAgICAgIGxvZ2dlcl8xW1wiZGVmYXVsdFwiXS5kZWJ1ZygnRXZlbnQgcmVjZCcsIG1lc3NhZ2UpO1xuXHQgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobWVzc2FnZS5ldmVudCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwdXNoZXI6ZXJyb3InOlxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZW1pdCgnZXJyb3InLCB7IHR5cGU6ICdQdXNoZXJFcnJvcicsIGRhdGE6IG1lc3NhZ2UuZGF0YSB9KTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwdXNoZXI6cGluZyc6XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5lbWl0KFwicGluZ1wiKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwdXNoZXI6cG9uZyc6XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5lbWl0KFwicG9uZ1wiKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICBfdGhpcy5lbWl0KCdtZXNzYWdlJywgbWVzc2FnZSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIGFjdGl2aXR5OiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5lbWl0KFwiYWN0aXZpdHlcIik7XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgICAgICAgICAgIF90aGlzLmVtaXQoXCJlcnJvclwiLCB7IHR5cGU6IFwiV2ViU29ja2V0RXJyb3JcIiwgZXJyb3I6IGVycm9yIH0pO1xuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICBjbG9zZWQ6IGZ1bmN0aW9uIChjbG9zZUV2ZW50KSB7XG5cdCAgICAgICAgICAgICAgICB1bmJpbmRMaXN0ZW5lcnMoKTtcblx0ICAgICAgICAgICAgICAgIGlmIChjbG9zZUV2ZW50ICYmIGNsb3NlRXZlbnQuY29kZSkge1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzLmhhbmRsZUNsb3NlRXZlbnQoY2xvc2VFdmVudCk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICBfdGhpcy50cmFuc3BvcnQgPSBudWxsO1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuZW1pdChcImNsb3NlZFwiKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdCAgICAgICAgdmFyIHVuYmluZExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgQ29sbGVjdGlvbnMub2JqZWN0QXBwbHkobGlzdGVuZXJzLCBmdW5jdGlvbiAobGlzdGVuZXIsIGV2ZW50KSB7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy50cmFuc3BvcnQudW5iaW5kKGV2ZW50LCBsaXN0ZW5lcik7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgQ29sbGVjdGlvbnMub2JqZWN0QXBwbHkobGlzdGVuZXJzLCBmdW5jdGlvbiAobGlzdGVuZXIsIGV2ZW50KSB7XG5cdCAgICAgICAgICAgIF90aGlzLnRyYW5zcG9ydC5iaW5kKGV2ZW50LCBsaXN0ZW5lcik7XG5cdCAgICAgICAgfSk7XG5cdCAgICB9O1xuXHQgICAgQ29ubmVjdGlvbi5wcm90b3R5cGUuaGFuZGxlQ2xvc2VFdmVudCA9IGZ1bmN0aW9uIChjbG9zZUV2ZW50KSB7XG5cdCAgICAgICAgdmFyIGFjdGlvbiA9IFByb3RvY29sLmdldENsb3NlQWN0aW9uKGNsb3NlRXZlbnQpO1xuXHQgICAgICAgIHZhciBlcnJvciA9IFByb3RvY29sLmdldENsb3NlRXJyb3IoY2xvc2VFdmVudCk7XG5cdCAgICAgICAgaWYgKGVycm9yKSB7XG5cdCAgICAgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnJvcik7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChhY3Rpb24pIHtcblx0ICAgICAgICAgICAgdGhpcy5lbWl0KGFjdGlvbik7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIHJldHVybiBDb25uZWN0aW9uO1xuXHR9KGRpc3BhdGNoZXJfMVtcImRlZmF1bHRcIl0pKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBDb25uZWN0aW9uO1xuXG5cbi8qKiovIH0pLFxuLyogNDcgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIHJ1bnRpbWVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdHZhciBQdXNoZXJBdXRob3JpemVyID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIFB1c2hlckF1dGhvcml6ZXIoY2hhbm5lbCwgb3B0aW9ucykge1xuXHQgICAgICAgIHRoaXMuY2hhbm5lbCA9IGNoYW5uZWw7XG5cdCAgICAgICAgdmFyIGF1dGhUcmFuc3BvcnQgPSBvcHRpb25zLmF1dGhUcmFuc3BvcnQ7XG5cdCAgICAgICAgaWYgKHR5cGVvZiBydW50aW1lXzFbXCJkZWZhdWx0XCJdLmdldEF1dGhvcml6ZXJzKClbYXV0aFRyYW5zcG9ydF0gPT09IFwidW5kZWZpbmVkXCIpIHtcblx0ICAgICAgICAgICAgdGhyb3cgXCInXCIgKyBhdXRoVHJhbnNwb3J0ICsgXCInIGlzIG5vdCBhIHJlY29nbml6ZWQgYXV0aCB0cmFuc3BvcnRcIjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy50eXBlID0gYXV0aFRyYW5zcG9ydDtcblx0ICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuXHQgICAgICAgIHRoaXMuYXV0aE9wdGlvbnMgPSAob3B0aW9ucyB8fCB7fSkuYXV0aCB8fCB7fTtcblx0ICAgIH1cblx0ICAgIFB1c2hlckF1dGhvcml6ZXIucHJvdG90eXBlLmNvbXBvc2VRdWVyeSA9IGZ1bmN0aW9uIChzb2NrZXRJZCkge1xuXHQgICAgICAgIHZhciBxdWVyeSA9ICdzb2NrZXRfaWQ9JyArIGVuY29kZVVSSUNvbXBvbmVudChzb2NrZXRJZCkgK1xuXHQgICAgICAgICAgICAnJmNoYW5uZWxfbmFtZT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuY2hhbm5lbC5uYW1lKTtcblx0ICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMuYXV0aE9wdGlvbnMucGFyYW1zKSB7XG5cdCAgICAgICAgICAgIHF1ZXJ5ICs9IFwiJlwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGkpICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQodGhpcy5hdXRoT3B0aW9ucy5wYXJhbXNbaV0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gcXVlcnk7XG5cdCAgICB9O1xuXHQgICAgUHVzaGVyQXV0aG9yaXplci5wcm90b3R5cGUuYXV0aG9yaXplID0gZnVuY3Rpb24gKHNvY2tldElkLCBjYWxsYmFjaykge1xuXHQgICAgICAgIFB1c2hlckF1dGhvcml6ZXIuYXV0aG9yaXplcnMgPSBQdXNoZXJBdXRob3JpemVyLmF1dGhvcml6ZXJzIHx8IHJ1bnRpbWVfMVtcImRlZmF1bHRcIl0uZ2V0QXV0aG9yaXplcnMoKTtcblx0ICAgICAgICByZXR1cm4gUHVzaGVyQXV0aG9yaXplci5hdXRob3JpemVyc1t0aGlzLnR5cGVdLmNhbGwodGhpcywgcnVudGltZV8xW1wiZGVmYXVsdFwiXSwgc29ja2V0SWQsIGNhbGxiYWNrKTtcblx0ICAgIH07XG5cdCAgICByZXR1cm4gUHVzaGVyQXV0aG9yaXplcjtcblx0fSgpKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBQdXNoZXJBdXRob3JpemVyO1xuXG5cbi8qKiovIH0pLFxuLyogNDggKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIHJ1bnRpbWVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdHZhciBUaW1lbGluZVNlbmRlciA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBUaW1lbGluZVNlbmRlcih0aW1lbGluZSwgb3B0aW9ucykge1xuXHQgICAgICAgIHRoaXMudGltZWxpbmUgPSB0aW1lbGluZTtcblx0ICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHQgICAgfVxuXHQgICAgVGltZWxpbmVTZW5kZXIucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAoZW5jcnlwdGVkLCBjYWxsYmFjaykge1xuXHQgICAgICAgIGlmICh0aGlzLnRpbWVsaW5lLmlzRW1wdHkoKSkge1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMudGltZWxpbmUuc2VuZChydW50aW1lXzFbXCJkZWZhdWx0XCJdLlRpbWVsaW5lVHJhbnNwb3J0LmdldEFnZW50KHRoaXMsIGVuY3J5cHRlZCksIGNhbGxiYWNrKTtcblx0ICAgIH07XG5cdCAgICByZXR1cm4gVGltZWxpbmVTZW5kZXI7XG5cdH0oKSk7XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gVGltZWxpbmVTZW5kZXI7XG5cblxuLyoqKi8gfSksXG4vKiA0OSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XG5cdCAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcblx0ICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuXHQgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuXHR9O1xuXHR2YXIgcHJpdmF0ZV9jaGFubmVsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTtcblx0dmFyIGxvZ2dlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTtcblx0dmFyIG1lbWJlcnNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNTIpO1xuXHR2YXIgUHJlc2VuY2VDaGFubmVsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcblx0ICAgIF9fZXh0ZW5kcyhQcmVzZW5jZUNoYW5uZWwsIF9zdXBlcik7XG5cdCAgICBmdW5jdGlvbiBQcmVzZW5jZUNoYW5uZWwobmFtZSwgcHVzaGVyKSB7XG5cdCAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgbmFtZSwgcHVzaGVyKTtcblx0ICAgICAgICB0aGlzLm1lbWJlcnMgPSBuZXcgbWVtYmVyc18xW1wiZGVmYXVsdFwiXSgpO1xuXHQgICAgfVxuXHQgICAgUHJlc2VuY2VDaGFubmVsLnByb3RvdHlwZS5hdXRob3JpemUgPSBmdW5jdGlvbiAoc29ja2V0SWQsIGNhbGxiYWNrKSB7XG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0ICAgICAgICBfc3VwZXIucHJvdG90eXBlLmF1dGhvcml6ZS5jYWxsKHRoaXMsIHNvY2tldElkLCBmdW5jdGlvbiAoZXJyb3IsIGF1dGhEYXRhKSB7XG5cdCAgICAgICAgICAgIGlmICghZXJyb3IpIHtcblx0ICAgICAgICAgICAgICAgIGlmIChhdXRoRGF0YS5jaGFubmVsX2RhdGEgPT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgICAgICAgICAgICAgIGxvZ2dlcl8xW1wiZGVmYXVsdFwiXS53YXJuKFwiSW52YWxpZCBhdXRoIHJlc3BvbnNlIGZvciBjaGFubmVsICdcIiArXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm5hbWUgK1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBcIicsIGV4cGVjdGVkICdjaGFubmVsX2RhdGEnIGZpZWxkXCIpO1xuXHQgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKFwiSW52YWxpZCBhdXRoIHJlc3BvbnNlXCIpO1xuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIHZhciBjaGFubmVsRGF0YSA9IEpTT04ucGFyc2UoYXV0aERhdGEuY2hhbm5lbF9kYXRhKTtcblx0ICAgICAgICAgICAgICAgIF90aGlzLm1lbWJlcnMuc2V0TXlJRChjaGFubmVsRGF0YS51c2VyX2lkKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBjYWxsYmFjayhlcnJvciwgYXV0aERhdGEpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgfTtcblx0ICAgIFByZXNlbmNlQ2hhbm5lbC5wcm90b3R5cGUuaGFuZGxlRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQsIGRhdGEpIHtcblx0ICAgICAgICBzd2l0Y2ggKGV2ZW50KSB7XG5cdCAgICAgICAgICAgIGNhc2UgXCJwdXNoZXJfaW50ZXJuYWw6c3Vic2NyaXB0aW9uX3N1Y2NlZWRlZFwiOlxuXHQgICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25QZW5kaW5nID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmliZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9uQ2FuY2VsbGVkKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5wdXNoZXIudW5zdWJzY3JpYmUodGhpcy5uYW1lKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMubWVtYmVycy5vblN1YnNjcmlwdGlvbihkYXRhKTtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoXCJwdXNoZXI6c3Vic2NyaXB0aW9uX3N1Y2NlZWRlZFwiLCB0aGlzLm1lbWJlcnMpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIGNhc2UgXCJwdXNoZXJfaW50ZXJuYWw6bWVtYmVyX2FkZGVkXCI6XG5cdCAgICAgICAgICAgICAgICB2YXIgYWRkZWRNZW1iZXIgPSB0aGlzLm1lbWJlcnMuYWRkTWVtYmVyKGRhdGEpO1xuXHQgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdwdXNoZXI6bWVtYmVyX2FkZGVkJywgYWRkZWRNZW1iZXIpO1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIGNhc2UgXCJwdXNoZXJfaW50ZXJuYWw6bWVtYmVyX3JlbW92ZWRcIjpcblx0ICAgICAgICAgICAgICAgIHZhciByZW1vdmVkTWVtYmVyID0gdGhpcy5tZW1iZXJzLnJlbW92ZU1lbWJlcihkYXRhKTtcblx0ICAgICAgICAgICAgICAgIGlmIChyZW1vdmVkTWVtYmVyKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdwdXNoZXI6bWVtYmVyX3JlbW92ZWQnLCByZW1vdmVkTWVtYmVyKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICBkZWZhdWx0OlxuXHQgICAgICAgICAgICAgICAgcHJpdmF0ZV9jaGFubmVsXzFbXCJkZWZhdWx0XCJdLnByb3RvdHlwZS5oYW5kbGVFdmVudC5jYWxsKHRoaXMsIGV2ZW50LCBkYXRhKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgUHJlc2VuY2VDaGFubmVsLnByb3RvdHlwZS5kaXNjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRoaXMubWVtYmVycy5yZXNldCgpO1xuXHQgICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzY29ubmVjdC5jYWxsKHRoaXMpO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBQcmVzZW5jZUNoYW5uZWw7XG5cdH0ocHJpdmF0ZV9jaGFubmVsXzFbXCJkZWZhdWx0XCJdKSk7XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gUHJlc2VuY2VDaGFubmVsO1xuXG5cbi8qKiovIH0pLFxuLyogNTAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xuXHQgICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07XG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cblx0ICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcblx0fTtcblx0dmFyIGZhY3RvcnlfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNDIpO1xuXHR2YXIgY2hhbm5lbF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7XG5cdHZhciBQcml2YXRlQ2hhbm5lbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG5cdCAgICBfX2V4dGVuZHMoUHJpdmF0ZUNoYW5uZWwsIF9zdXBlcik7XG5cdCAgICBmdW5jdGlvbiBQcml2YXRlQ2hhbm5lbCgpIHtcblx0ICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0ICAgIH1cblx0ICAgIFByaXZhdGVDaGFubmVsLnByb3RvdHlwZS5hdXRob3JpemUgPSBmdW5jdGlvbiAoc29ja2V0SWQsIGNhbGxiYWNrKSB7XG5cdCAgICAgICAgdmFyIGF1dGhvcml6ZXIgPSBmYWN0b3J5XzFbXCJkZWZhdWx0XCJdLmNyZWF0ZUF1dGhvcml6ZXIodGhpcywgdGhpcy5wdXNoZXIuY29uZmlnKTtcblx0ICAgICAgICByZXR1cm4gYXV0aG9yaXplci5hdXRob3JpemUoc29ja2V0SWQsIGNhbGxiYWNrKTtcblx0ICAgIH07XG5cdCAgICByZXR1cm4gUHJpdmF0ZUNoYW5uZWw7XG5cdH0oY2hhbm5lbF8xW1wiZGVmYXVsdFwiXSkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IFByaXZhdGVDaGFubmVsO1xuXG5cbi8qKiovIH0pLFxuLyogNTEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xuXHQgICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07XG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cblx0ICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcblx0fTtcblx0dmFyIGRpc3BhdGNoZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpO1xuXHR2YXIgRXJyb3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCk7XG5cdHZhciBsb2dnZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cdHZhciBDaGFubmVsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcblx0ICAgIF9fZXh0ZW5kcyhDaGFubmVsLCBfc3VwZXIpO1xuXHQgICAgZnVuY3Rpb24gQ2hhbm5lbChuYW1lLCBwdXNoZXIpIHtcblx0ICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBmdW5jdGlvbiAoZXZlbnQsIGRhdGEpIHtcblx0ICAgICAgICAgICAgbG9nZ2VyXzFbXCJkZWZhdWx0XCJdLmRlYnVnKCdObyBjYWxsYmFja3Mgb24gJyArIG5hbWUgKyAnIGZvciAnICsgZXZlbnQpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG5cdCAgICAgICAgdGhpcy5wdXNoZXIgPSBwdXNoZXI7XG5cdCAgICAgICAgdGhpcy5zdWJzY3JpYmVkID0gZmFsc2U7XG5cdCAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25QZW5kaW5nID0gZmFsc2U7XG5cdCAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25DYW5jZWxsZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0ICAgIENoYW5uZWwucHJvdG90eXBlLmF1dGhvcml6ZSA9IGZ1bmN0aW9uIChzb2NrZXRJZCwgY2FsbGJhY2spIHtcblx0ICAgICAgICByZXR1cm4gY2FsbGJhY2soZmFsc2UsIHt9KTtcblx0ICAgIH07XG5cdCAgICBDaGFubmVsLnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24gKGV2ZW50LCBkYXRhKSB7XG5cdCAgICAgICAgaWYgKGV2ZW50LmluZGV4T2YoXCJjbGllbnQtXCIpICE9PSAwKSB7XG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcnMuQmFkRXZlbnROYW1lKFwiRXZlbnQgJ1wiICsgZXZlbnQgKyBcIicgZG9lcyBub3Qgc3RhcnQgd2l0aCAnY2xpZW50LSdcIik7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiB0aGlzLnB1c2hlci5zZW5kX2V2ZW50KGV2ZW50LCBkYXRhLCB0aGlzLm5hbWUpO1xuXHQgICAgfTtcblx0ICAgIENoYW5uZWwucHJvdG90eXBlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5zdWJzY3JpYmVkID0gZmFsc2U7XG5cdCAgICB9O1xuXHQgICAgQ2hhbm5lbC5wcm90b3R5cGUuaGFuZGxlRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQsIGRhdGEpIHtcblx0ICAgICAgICBpZiAoZXZlbnQuaW5kZXhPZihcInB1c2hlcl9pbnRlcm5hbDpcIikgPT09IDApIHtcblx0ICAgICAgICAgICAgaWYgKGV2ZW50ID09PSBcInB1c2hlcl9pbnRlcm5hbDpzdWJzY3JpcHRpb25fc3VjY2VlZGVkXCIpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uUGVuZGluZyA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVkID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgIGlmICh0aGlzLnN1YnNjcmlwdGlvbkNhbmNlbGxlZCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMucHVzaGVyLnVuc3Vic2NyaWJlKHRoaXMubmFtZSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoXCJwdXNoZXI6c3Vic2NyaXB0aW9uX3N1Y2NlZWRlZFwiLCBkYXRhKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgdGhpcy5lbWl0KGV2ZW50LCBkYXRhKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgQ2hhbm5lbC5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdCAgICAgICAgaWYgKHRoaXMuc3Vic2NyaWJlZCkge1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uUGVuZGluZyA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25DYW5jZWxsZWQgPSBmYWxzZTtcblx0ICAgICAgICB0aGlzLmF1dGhvcml6ZSh0aGlzLnB1c2hlci5jb25uZWN0aW9uLnNvY2tldF9pZCwgZnVuY3Rpb24gKGVycm9yLCBkYXRhKSB7XG5cdCAgICAgICAgICAgIGlmIChlcnJvcikge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuaGFuZGxlRXZlbnQoJ3B1c2hlcjpzdWJzY3JpcHRpb25fZXJyb3InLCBkYXRhKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIF90aGlzLnB1c2hlci5zZW5kX2V2ZW50KCdwdXNoZXI6c3Vic2NyaWJlJywge1xuXHQgICAgICAgICAgICAgICAgICAgIGF1dGg6IGRhdGEuYXV0aCxcblx0ICAgICAgICAgICAgICAgICAgICBjaGFubmVsX2RhdGE6IGRhdGEuY2hhbm5lbF9kYXRhLFxuXHQgICAgICAgICAgICAgICAgICAgIGNoYW5uZWw6IF90aGlzLm5hbWVcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICB9O1xuXHQgICAgQ2hhbm5lbC5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5zdWJzY3JpYmVkID0gZmFsc2U7XG5cdCAgICAgICAgdGhpcy5wdXNoZXIuc2VuZF9ldmVudCgncHVzaGVyOnVuc3Vic2NyaWJlJywge1xuXHQgICAgICAgICAgICBjaGFubmVsOiB0aGlzLm5hbWVcblx0ICAgICAgICB9KTtcblx0ICAgIH07XG5cdCAgICBDaGFubmVsLnByb3RvdHlwZS5jYW5jZWxTdWJzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25DYW5jZWxsZWQgPSB0cnVlO1xuXHQgICAgfTtcblx0ICAgIENoYW5uZWwucHJvdG90eXBlLnJlaW5zdGF0ZVN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbkNhbmNlbGxlZCA9IGZhbHNlO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBDaGFubmVsO1xuXHR9KGRpc3BhdGNoZXJfMVtcImRlZmF1bHRcIl0pKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBDaGFubmVsO1xuXG5cbi8qKiovIH0pLFxuLyogNTIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIENvbGxlY3Rpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0dmFyIE1lbWJlcnMgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gTWVtYmVycygpIHtcblx0ICAgICAgICB0aGlzLnJlc2V0KCk7XG5cdCAgICB9XG5cdCAgICBNZW1iZXJzLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaWQpIHtcblx0ICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMubWVtYmVycywgaWQpKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgICAgICBpZDogaWQsXG5cdCAgICAgICAgICAgICAgICBpbmZvOiB0aGlzLm1lbWJlcnNbaWRdXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgTWVtYmVycy5wcm90b3R5cGUuZWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdCAgICAgICAgQ29sbGVjdGlvbnMub2JqZWN0QXBwbHkodGhpcy5tZW1iZXJzLCBmdW5jdGlvbiAobWVtYmVyLCBpZCkge1xuXHQgICAgICAgICAgICBjYWxsYmFjayhfdGhpcy5nZXQoaWQpKTtcblx0ICAgICAgICB9KTtcblx0ICAgIH07XG5cdCAgICBNZW1iZXJzLnByb3RvdHlwZS5zZXRNeUlEID0gZnVuY3Rpb24gKGlkKSB7XG5cdCAgICAgICAgdGhpcy5teUlEID0gaWQ7XG5cdCAgICB9O1xuXHQgICAgTWVtYmVycy5wcm90b3R5cGUub25TdWJzY3JpcHRpb24gPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uRGF0YSkge1xuXHQgICAgICAgIHRoaXMubWVtYmVycyA9IHN1YnNjcmlwdGlvbkRhdGEucHJlc2VuY2UuaGFzaDtcblx0ICAgICAgICB0aGlzLmNvdW50ID0gc3Vic2NyaXB0aW9uRGF0YS5wcmVzZW5jZS5jb3VudDtcblx0ICAgICAgICB0aGlzLm1lID0gdGhpcy5nZXQodGhpcy5teUlEKTtcblx0ICAgIH07XG5cdCAgICBNZW1iZXJzLnByb3RvdHlwZS5hZGRNZW1iZXIgPSBmdW5jdGlvbiAobWVtYmVyRGF0YSkge1xuXHQgICAgICAgIGlmICh0aGlzLmdldChtZW1iZXJEYXRhLnVzZXJfaWQpID09PSBudWxsKSB7XG5cdCAgICAgICAgICAgIHRoaXMuY291bnQrKztcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5tZW1iZXJzW21lbWJlckRhdGEudXNlcl9pZF0gPSBtZW1iZXJEYXRhLnVzZXJfaW5mbztcblx0ICAgICAgICByZXR1cm4gdGhpcy5nZXQobWVtYmVyRGF0YS51c2VyX2lkKTtcblx0ICAgIH07XG5cdCAgICBNZW1iZXJzLnByb3RvdHlwZS5yZW1vdmVNZW1iZXIgPSBmdW5jdGlvbiAobWVtYmVyRGF0YSkge1xuXHQgICAgICAgIHZhciBtZW1iZXIgPSB0aGlzLmdldChtZW1iZXJEYXRhLnVzZXJfaWQpO1xuXHQgICAgICAgIGlmIChtZW1iZXIpIHtcblx0ICAgICAgICAgICAgZGVsZXRlIHRoaXMubWVtYmVyc1ttZW1iZXJEYXRhLnVzZXJfaWRdO1xuXHQgICAgICAgICAgICB0aGlzLmNvdW50LS07XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBtZW1iZXI7XG5cdCAgICB9O1xuXHQgICAgTWVtYmVycy5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5tZW1iZXJzID0ge307XG5cdCAgICAgICAgdGhpcy5jb3VudCA9IDA7XG5cdCAgICAgICAgdGhpcy5teUlEID0gbnVsbDtcblx0ICAgICAgICB0aGlzLm1lID0gbnVsbDtcblx0ICAgIH07XG5cdCAgICByZXR1cm4gTWVtYmVycztcblx0fSgpKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBNZW1iZXJzO1xuXG5cbi8qKiovIH0pLFxuLyogNTMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xuXHQgICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07XG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cblx0ICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcblx0fTtcblx0dmFyIGRpc3BhdGNoZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpO1xuXHR2YXIgdGltZXJzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKTtcblx0dmFyIGxvZ2dlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTtcblx0dmFyIENvbGxlY3Rpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0dmFyIHJ1bnRpbWVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdHZhciBDb25uZWN0aW9uTWFuYWdlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG5cdCAgICBfX2V4dGVuZHMoQ29ubmVjdGlvbk1hbmFnZXIsIF9zdXBlcik7XG5cdCAgICBmdW5jdGlvbiBDb25uZWN0aW9uTWFuYWdlcihrZXksIG9wdGlvbnMpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIF9zdXBlci5jYWxsKHRoaXMpO1xuXHQgICAgICAgIHRoaXMua2V5ID0ga2V5O1xuXHQgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICAgICAgdGhpcy5zdGF0ZSA9IFwiaW5pdGlhbGl6ZWRcIjtcblx0ICAgICAgICB0aGlzLmNvbm5lY3Rpb24gPSBudWxsO1xuXHQgICAgICAgIHRoaXMuZW5jcnlwdGVkID0gISFvcHRpb25zLmVuY3J5cHRlZDtcblx0ICAgICAgICB0aGlzLnRpbWVsaW5lID0gdGhpcy5vcHRpb25zLnRpbWVsaW5lO1xuXHQgICAgICAgIHRoaXMuY29ubmVjdGlvbkNhbGxiYWNrcyA9IHRoaXMuYnVpbGRDb25uZWN0aW9uQ2FsbGJhY2tzKCk7XG5cdCAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrcyA9IHRoaXMuYnVpbGRFcnJvckNhbGxiYWNrcygpO1xuXHQgICAgICAgIHRoaXMuaGFuZHNoYWtlQ2FsbGJhY2tzID0gdGhpcy5idWlsZEhhbmRzaGFrZUNhbGxiYWNrcyh0aGlzLmVycm9yQ2FsbGJhY2tzKTtcblx0ICAgICAgICB2YXIgTmV0d29yayA9IHJ1bnRpbWVfMVtcImRlZmF1bHRcIl0uZ2V0TmV0d29yaygpO1xuXHQgICAgICAgIE5ldHdvcmsuYmluZChcIm9ubGluZVwiLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIF90aGlzLnRpbWVsaW5lLmluZm8oeyBuZXRpbmZvOiBcIm9ubGluZVwiIH0pO1xuXHQgICAgICAgICAgICBpZiAoX3RoaXMuc3RhdGUgPT09IFwiY29ubmVjdGluZ1wiIHx8IF90aGlzLnN0YXRlID09PSBcInVuYXZhaWxhYmxlXCIpIHtcblx0ICAgICAgICAgICAgICAgIF90aGlzLnJldHJ5SW4oMCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0ICAgICAgICBOZXR3b3JrLmJpbmQoXCJvZmZsaW5lXCIsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgX3RoaXMudGltZWxpbmUuaW5mbyh7IG5ldGluZm86IFwib2ZmbGluZVwiIH0pO1xuXHQgICAgICAgICAgICBpZiAoX3RoaXMuY29ubmVjdGlvbikge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuc2VuZEFjdGl2aXR5Q2hlY2soKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHRoaXMudXBkYXRlU3RyYXRlZ3koKTtcblx0ICAgIH1cblx0ICAgIENvbm5lY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICh0aGlzLmNvbm5lY3Rpb24gfHwgdGhpcy5ydW5uZXIpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAoIXRoaXMuc3RyYXRlZ3kuaXNTdXBwb3J0ZWQoKSkge1xuXHQgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKFwiZmFpbGVkXCIpO1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMudXBkYXRlU3RhdGUoXCJjb25uZWN0aW5nXCIpO1xuXHQgICAgICAgIHRoaXMuc3RhcnRDb25uZWN0aW5nKCk7XG5cdCAgICAgICAgdGhpcy5zZXRVbmF2YWlsYWJsZVRpbWVyKCk7XG5cdCAgICB9O1xuXHQgICAgO1xuXHQgICAgQ29ubmVjdGlvbk1hbmFnZXIucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHQgICAgICAgIGlmICh0aGlzLmNvbm5lY3Rpb24pIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdGlvbi5zZW5kKGRhdGEpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICA7XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuc2VuZF9ldmVudCA9IGZ1bmN0aW9uIChuYW1lLCBkYXRhLCBjaGFubmVsKSB7XG5cdCAgICAgICAgaWYgKHRoaXMuY29ubmVjdGlvbikge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uLnNlbmRfZXZlbnQobmFtZSwgZGF0YSwgY2hhbm5lbCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIDtcblx0ICAgIENvbm5lY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5kaXNjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRoaXMuZGlzY29ubmVjdEludGVybmFsbHkoKTtcblx0ICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKFwiZGlzY29ubmVjdGVkXCIpO1xuXHQgICAgfTtcblx0ICAgIDtcblx0ICAgIENvbm5lY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5pc0VuY3J5cHRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5lbmNyeXB0ZWQ7XG5cdCAgICB9O1xuXHQgICAgO1xuXHQgICAgQ29ubmVjdGlvbk1hbmFnZXIucHJvdG90eXBlLnN0YXJ0Q29ubmVjdGluZyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChlcnJvciwgaGFuZHNoYWtlKSB7XG5cdCAgICAgICAgICAgIGlmIChlcnJvcikge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMucnVubmVyID0gX3RoaXMuc3RyYXRlZ3kuY29ubmVjdCgwLCBjYWxsYmFjayk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoaGFuZHNoYWtlLmFjdGlvbiA9PT0gXCJlcnJvclwiKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXMuZW1pdChcImVycm9yXCIsIHsgdHlwZTogXCJIYW5kc2hha2VFcnJvclwiLCBlcnJvcjogaGFuZHNoYWtlLmVycm9yIH0pO1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzLnRpbWVsaW5lLmVycm9yKHsgaGFuZHNoYWtlRXJyb3I6IGhhbmRzaGFrZS5lcnJvciB9KTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzLmFib3J0Q29ubmVjdGluZygpO1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzLmhhbmRzaGFrZUNhbGxiYWNrc1toYW5kc2hha2UuYWN0aW9uXShoYW5kc2hha2UpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB0aGlzLnJ1bm5lciA9IHRoaXMuc3RyYXRlZ3kuY29ubmVjdCgwLCBjYWxsYmFjayk7XG5cdCAgICB9O1xuXHQgICAgO1xuXHQgICAgQ29ubmVjdGlvbk1hbmFnZXIucHJvdG90eXBlLmFib3J0Q29ubmVjdGluZyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAodGhpcy5ydW5uZXIpIHtcblx0ICAgICAgICAgICAgdGhpcy5ydW5uZXIuYWJvcnQoKTtcblx0ICAgICAgICAgICAgdGhpcy5ydW5uZXIgPSBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICA7XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuZGlzY29ubmVjdEludGVybmFsbHkgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5hYm9ydENvbm5lY3RpbmcoKTtcblx0ICAgICAgICB0aGlzLmNsZWFyUmV0cnlUaW1lcigpO1xuXHQgICAgICAgIHRoaXMuY2xlYXJVbmF2YWlsYWJsZVRpbWVyKCk7XG5cdCAgICAgICAgaWYgKHRoaXMuY29ubmVjdGlvbikge1xuXHQgICAgICAgICAgICB2YXIgY29ubmVjdGlvbiA9IHRoaXMuYWJhbmRvbkNvbm5lY3Rpb24oKTtcblx0ICAgICAgICAgICAgY29ubmVjdGlvbi5jbG9zZSgpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICA7XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUudXBkYXRlU3RyYXRlZ3kgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5zdHJhdGVneSA9IHRoaXMub3B0aW9ucy5nZXRTdHJhdGVneSh7XG5cdCAgICAgICAgICAgIGtleTogdGhpcy5rZXksXG5cdCAgICAgICAgICAgIHRpbWVsaW5lOiB0aGlzLnRpbWVsaW5lLFxuXHQgICAgICAgICAgICBlbmNyeXB0ZWQ6IHRoaXMuZW5jcnlwdGVkXG5cdCAgICAgICAgfSk7XG5cdCAgICB9O1xuXHQgICAgO1xuXHQgICAgQ29ubmVjdGlvbk1hbmFnZXIucHJvdG90eXBlLnJldHJ5SW4gPSBmdW5jdGlvbiAoZGVsYXkpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIHRoaXMudGltZWxpbmUuaW5mbyh7IGFjdGlvbjogXCJyZXRyeVwiLCBkZWxheTogZGVsYXkgfSk7XG5cdCAgICAgICAgaWYgKGRlbGF5ID4gMCkge1xuXHQgICAgICAgICAgICB0aGlzLmVtaXQoXCJjb25uZWN0aW5nX2luXCIsIE1hdGgucm91bmQoZGVsYXkgLyAxMDAwKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMucmV0cnlUaW1lciA9IG5ldyB0aW1lcnNfMS5PbmVPZmZUaW1lcihkZWxheSB8fCAwLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIF90aGlzLmRpc2Nvbm5lY3RJbnRlcm5hbGx5KCk7XG5cdCAgICAgICAgICAgIF90aGlzLmNvbm5lY3QoKTtcblx0ICAgICAgICB9KTtcblx0ICAgIH07XG5cdCAgICA7XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuY2xlYXJSZXRyeVRpbWVyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICh0aGlzLnJldHJ5VGltZXIpIHtcblx0ICAgICAgICAgICAgdGhpcy5yZXRyeVRpbWVyLmVuc3VyZUFib3J0ZWQoKTtcblx0ICAgICAgICAgICAgdGhpcy5yZXRyeVRpbWVyID0gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgO1xuXHQgICAgQ29ubmVjdGlvbk1hbmFnZXIucHJvdG90eXBlLnNldFVuYXZhaWxhYmxlVGltZXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0ICAgICAgICB0aGlzLnVuYXZhaWxhYmxlVGltZXIgPSBuZXcgdGltZXJzXzEuT25lT2ZmVGltZXIodGhpcy5vcHRpb25zLnVuYXZhaWxhYmxlVGltZW91dCwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICBfdGhpcy51cGRhdGVTdGF0ZShcInVuYXZhaWxhYmxlXCIpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgfTtcblx0ICAgIDtcblx0ICAgIENvbm5lY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5jbGVhclVuYXZhaWxhYmxlVGltZXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKHRoaXMudW5hdmFpbGFibGVUaW1lcikge1xuXHQgICAgICAgICAgICB0aGlzLnVuYXZhaWxhYmxlVGltZXIuZW5zdXJlQWJvcnRlZCgpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICA7XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuc2VuZEFjdGl2aXR5Q2hlY2sgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0ICAgICAgICB0aGlzLnN0b3BBY3Rpdml0eUNoZWNrKCk7XG5cdCAgICAgICAgdGhpcy5jb25uZWN0aW9uLnBpbmcoKTtcblx0ICAgICAgICB0aGlzLmFjdGl2aXR5VGltZXIgPSBuZXcgdGltZXJzXzEuT25lT2ZmVGltZXIodGhpcy5vcHRpb25zLnBvbmdUaW1lb3V0LCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIF90aGlzLnRpbWVsaW5lLmVycm9yKHsgcG9uZ190aW1lZF9vdXQ6IF90aGlzLm9wdGlvbnMucG9uZ1RpbWVvdXQgfSk7XG5cdCAgICAgICAgICAgIF90aGlzLnJldHJ5SW4oMCk7XG5cdCAgICAgICAgfSk7XG5cdCAgICB9O1xuXHQgICAgO1xuXHQgICAgQ29ubmVjdGlvbk1hbmFnZXIucHJvdG90eXBlLnJlc2V0QWN0aXZpdHlDaGVjayA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIHRoaXMuc3RvcEFjdGl2aXR5Q2hlY2soKTtcblx0ICAgICAgICBpZiAoIXRoaXMuY29ubmVjdGlvbi5oYW5kbGVzQWN0aXZpdHlDaGVja3MoKSkge1xuXHQgICAgICAgICAgICB0aGlzLmFjdGl2aXR5VGltZXIgPSBuZXcgdGltZXJzXzEuT25lT2ZmVGltZXIodGhpcy5hY3Rpdml0eVRpbWVvdXQsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIF90aGlzLnNlbmRBY3Rpdml0eUNoZWNrKCk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICA7XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuc3RvcEFjdGl2aXR5Q2hlY2sgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKHRoaXMuYWN0aXZpdHlUaW1lcikge1xuXHQgICAgICAgICAgICB0aGlzLmFjdGl2aXR5VGltZXIuZW5zdXJlQWJvcnRlZCgpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICA7XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuYnVpbGRDb25uZWN0aW9uQ2FsbGJhY2tzID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdCAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgbWVzc2FnZTogZnVuY3Rpb24gKG1lc3NhZ2UpIHtcblx0ICAgICAgICAgICAgICAgIF90aGlzLnJlc2V0QWN0aXZpdHlDaGVjaygpO1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuZW1pdCgnbWVzc2FnZScsIG1lc3NhZ2UpO1xuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICBwaW5nOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5zZW5kX2V2ZW50KCdwdXNoZXI6cG9uZycsIHt9KTtcblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgYWN0aXZpdHk6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIF90aGlzLnJlc2V0QWN0aXZpdHlDaGVjaygpO1xuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5lbWl0KFwiZXJyb3JcIiwgeyB0eXBlOiBcIldlYlNvY2tldEVycm9yXCIsIGVycm9yOiBlcnJvciB9KTtcblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgY2xvc2VkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5hYmFuZG9uQ29ubmVjdGlvbigpO1xuXHQgICAgICAgICAgICAgICAgaWYgKF90aGlzLnNob3VsZFJldHJ5KCkpIHtcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZXRyeUluKDEwMDApO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfTtcblx0ICAgIH07XG5cdCAgICA7XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuYnVpbGRIYW5kc2hha2VDYWxsYmFja3MgPSBmdW5jdGlvbiAoZXJyb3JDYWxsYmFja3MpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIHJldHVybiBDb2xsZWN0aW9ucy5leHRlbmQoe30sIGVycm9yQ2FsbGJhY2tzLCB7XG5cdCAgICAgICAgICAgIGNvbm5lY3RlZDogZnVuY3Rpb24gKGhhbmRzaGFrZSkge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuYWN0aXZpdHlUaW1lb3V0ID0gTWF0aC5taW4oX3RoaXMub3B0aW9ucy5hY3Rpdml0eVRpbWVvdXQsIGhhbmRzaGFrZS5hY3Rpdml0eVRpbWVvdXQsIGhhbmRzaGFrZS5jb25uZWN0aW9uLmFjdGl2aXR5VGltZW91dCB8fCBJbmZpbml0eSk7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5jbGVhclVuYXZhaWxhYmxlVGltZXIoKTtcblx0ICAgICAgICAgICAgICAgIF90aGlzLnNldENvbm5lY3Rpb24oaGFuZHNoYWtlLmNvbm5lY3Rpb24pO1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuc29ja2V0X2lkID0gX3RoaXMuY29ubmVjdGlvbi5pZDtcblx0ICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZVN0YXRlKFwiY29ubmVjdGVkXCIsIHsgc29ja2V0X2lkOiBfdGhpcy5zb2NrZXRfaWQgfSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0ICAgIH07XG5cdCAgICA7XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuYnVpbGRFcnJvckNhbGxiYWNrcyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIHZhciB3aXRoRXJyb3JFbWl0dGVkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAocmVzdWx0KSB7XG5cdCAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXMuZW1pdChcImVycm9yXCIsIHsgdHlwZTogXCJXZWJTb2NrZXRFcnJvclwiLCBlcnJvcjogcmVzdWx0LmVycm9yIH0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgY2FsbGJhY2socmVzdWx0KTtcblx0ICAgICAgICAgICAgfTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgIHNzbF9vbmx5OiB3aXRoRXJyb3JFbWl0dGVkKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIF90aGlzLmVuY3J5cHRlZCA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVTdHJhdGVneSgpO1xuXHQgICAgICAgICAgICAgICAgX3RoaXMucmV0cnlJbigwKTtcblx0ICAgICAgICAgICAgfSksXG5cdCAgICAgICAgICAgIHJlZnVzZWQ6IHdpdGhFcnJvckVtaXR0ZWQoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuZGlzY29ubmVjdCgpO1xuXHQgICAgICAgICAgICB9KSxcblx0ICAgICAgICAgICAgYmFja29mZjogd2l0aEVycm9yRW1pdHRlZChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5yZXRyeUluKDEwMDApO1xuXHQgICAgICAgICAgICB9KSxcblx0ICAgICAgICAgICAgcmV0cnk6IHdpdGhFcnJvckVtaXR0ZWQoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgX3RoaXMucmV0cnlJbigwKTtcblx0ICAgICAgICAgICAgfSlcblx0ICAgICAgICB9O1xuXHQgICAgfTtcblx0ICAgIDtcblx0ICAgIENvbm5lY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5zZXRDb25uZWN0aW9uID0gZnVuY3Rpb24gKGNvbm5lY3Rpb24pIHtcblx0ICAgICAgICB0aGlzLmNvbm5lY3Rpb24gPSBjb25uZWN0aW9uO1xuXHQgICAgICAgIGZvciAodmFyIGV2ZW50IGluIHRoaXMuY29ubmVjdGlvbkNhbGxiYWNrcykge1xuXHQgICAgICAgICAgICB0aGlzLmNvbm5lY3Rpb24uYmluZChldmVudCwgdGhpcy5jb25uZWN0aW9uQ2FsbGJhY2tzW2V2ZW50XSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMucmVzZXRBY3Rpdml0eUNoZWNrKCk7XG5cdCAgICB9O1xuXHQgICAgO1xuXHQgICAgQ29ubmVjdGlvbk1hbmFnZXIucHJvdG90eXBlLmFiYW5kb25Db25uZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICghdGhpcy5jb25uZWN0aW9uKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5zdG9wQWN0aXZpdHlDaGVjaygpO1xuXHQgICAgICAgIGZvciAodmFyIGV2ZW50IGluIHRoaXMuY29ubmVjdGlvbkNhbGxiYWNrcykge1xuXHQgICAgICAgICAgICB0aGlzLmNvbm5lY3Rpb24udW5iaW5kKGV2ZW50LCB0aGlzLmNvbm5lY3Rpb25DYWxsYmFja3NbZXZlbnRdKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSB0aGlzLmNvbm5lY3Rpb247XG5cdCAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gbnVsbDtcblx0ICAgICAgICByZXR1cm4gY29ubmVjdGlvbjtcblx0ICAgIH07XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUudXBkYXRlU3RhdGUgPSBmdW5jdGlvbiAobmV3U3RhdGUsIGRhdGEpIHtcblx0ICAgICAgICB2YXIgcHJldmlvdXNTdGF0ZSA9IHRoaXMuc3RhdGU7XG5cdCAgICAgICAgdGhpcy5zdGF0ZSA9IG5ld1N0YXRlO1xuXHQgICAgICAgIGlmIChwcmV2aW91c1N0YXRlICE9PSBuZXdTdGF0ZSkge1xuXHQgICAgICAgICAgICB2YXIgbmV3U3RhdGVEZXNjcmlwdGlvbiA9IG5ld1N0YXRlO1xuXHQgICAgICAgICAgICBpZiAobmV3U3RhdGVEZXNjcmlwdGlvbiA9PT0gXCJjb25uZWN0ZWRcIikge1xuXHQgICAgICAgICAgICAgICAgbmV3U3RhdGVEZXNjcmlwdGlvbiArPSBcIiB3aXRoIG5ldyBzb2NrZXQgSUQgXCIgKyBkYXRhLnNvY2tldF9pZDtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBsb2dnZXJfMVtcImRlZmF1bHRcIl0uZGVidWcoJ1N0YXRlIGNoYW5nZWQnLCBwcmV2aW91c1N0YXRlICsgJyAtPiAnICsgbmV3U3RhdGVEZXNjcmlwdGlvbik7XG5cdCAgICAgICAgICAgIHRoaXMudGltZWxpbmUuaW5mbyh7IHN0YXRlOiBuZXdTdGF0ZSwgcGFyYW1zOiBkYXRhIH0pO1xuXHQgICAgICAgICAgICB0aGlzLmVtaXQoJ3N0YXRlX2NoYW5nZScsIHsgcHJldmlvdXM6IHByZXZpb3VzU3RhdGUsIGN1cnJlbnQ6IG5ld1N0YXRlIH0pO1xuXHQgICAgICAgICAgICB0aGlzLmVtaXQobmV3U3RhdGUsIGRhdGEpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBDb25uZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuc2hvdWxkUmV0cnkgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGUgPT09IFwiY29ubmVjdGluZ1wiIHx8IHRoaXMuc3RhdGUgPT09IFwiY29ubmVjdGVkXCI7XG5cdCAgICB9O1xuXHQgICAgcmV0dXJuIENvbm5lY3Rpb25NYW5hZ2VyO1xuXHR9KGRpc3BhdGNoZXJfMVtcImRlZmF1bHRcIl0pKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBDb25uZWN0aW9uTWFuYWdlcjtcblxuXG4vKioqLyB9KSxcbi8qIDU0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBDb2xsZWN0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cdHZhciBmYWN0b3J5XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKTtcblx0dmFyIENoYW5uZWxzID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIENoYW5uZWxzKCkge1xuXHQgICAgICAgIHRoaXMuY2hhbm5lbHMgPSB7fTtcblx0ICAgIH1cblx0ICAgIENoYW5uZWxzLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAobmFtZSwgcHVzaGVyKSB7XG5cdCAgICAgICAgaWYgKCF0aGlzLmNoYW5uZWxzW25hbWVdKSB7XG5cdCAgICAgICAgICAgIHRoaXMuY2hhbm5lbHNbbmFtZV0gPSBjcmVhdGVDaGFubmVsKG5hbWUsIHB1c2hlcik7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiB0aGlzLmNoYW5uZWxzW25hbWVdO1xuXHQgICAgfTtcblx0ICAgIENoYW5uZWxzLnByb3RvdHlwZS5hbGwgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLnZhbHVlcyh0aGlzLmNoYW5uZWxzKTtcblx0ICAgIH07XG5cdCAgICBDaGFubmVscy5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uIChuYW1lKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuY2hhbm5lbHNbbmFtZV07XG5cdCAgICB9O1xuXHQgICAgQ2hhbm5lbHMucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG5cdCAgICAgICAgdmFyIGNoYW5uZWwgPSB0aGlzLmNoYW5uZWxzW25hbWVdO1xuXHQgICAgICAgIGRlbGV0ZSB0aGlzLmNoYW5uZWxzW25hbWVdO1xuXHQgICAgICAgIHJldHVybiBjaGFubmVsO1xuXHQgICAgfTtcblx0ICAgIENoYW5uZWxzLnByb3RvdHlwZS5kaXNjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIENvbGxlY3Rpb25zLm9iamVjdEFwcGx5KHRoaXMuY2hhbm5lbHMsIGZ1bmN0aW9uIChjaGFubmVsKSB7XG5cdCAgICAgICAgICAgIGNoYW5uZWwuZGlzY29ubmVjdCgpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBDaGFubmVscztcblx0fSgpKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBDaGFubmVscztcblx0ZnVuY3Rpb24gY3JlYXRlQ2hhbm5lbChuYW1lLCBwdXNoZXIpIHtcblx0ICAgIGlmIChuYW1lLmluZGV4T2YoJ3ByaXZhdGUtJykgPT09IDApIHtcblx0ICAgICAgICByZXR1cm4gZmFjdG9yeV8xW1wiZGVmYXVsdFwiXS5jcmVhdGVQcml2YXRlQ2hhbm5lbChuYW1lLCBwdXNoZXIpO1xuXHQgICAgfVxuXHQgICAgZWxzZSBpZiAobmFtZS5pbmRleE9mKCdwcmVzZW5jZS0nKSA9PT0gMCkge1xuXHQgICAgICAgIHJldHVybiBmYWN0b3J5XzFbXCJkZWZhdWx0XCJdLmNyZWF0ZVByZXNlbmNlQ2hhbm5lbChuYW1lLCBwdXNoZXIpO1xuXHQgICAgfVxuXHQgICAgZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIGZhY3RvcnlfMVtcImRlZmF1bHRcIl0uY3JlYXRlQ2hhbm5lbChuYW1lLCBwdXNoZXIpO1xuXHQgICAgfVxuXHR9XG5cblxuLyoqKi8gfSksXG4vKiA1NSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgZmFjdG9yeV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Mik7XG5cdHZhciB1dGlsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTtcblx0dmFyIEVycm9ycyA9IF9fd2VicGFja19yZXF1aXJlX18oMzApO1xuXHR2YXIgQ29sbGVjdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXHR2YXIgVHJhbnNwb3J0U3RyYXRlZ3kgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gVHJhbnNwb3J0U3RyYXRlZ3kobmFtZSwgcHJpb3JpdHksIHRyYW5zcG9ydCwgb3B0aW9ucykge1xuXHQgICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG5cdCAgICAgICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5O1xuXHQgICAgICAgIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0O1xuXHQgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICB9XG5cdCAgICBUcmFuc3BvcnRTdHJhdGVneS5wcm90b3R5cGUuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNwb3J0LmlzU3VwcG9ydGVkKHtcblx0ICAgICAgICAgICAgZW5jcnlwdGVkOiB0aGlzLm9wdGlvbnMuZW5jcnlwdGVkXG5cdCAgICAgICAgfSk7XG5cdCAgICB9O1xuXHQgICAgVHJhbnNwb3J0U3RyYXRlZ3kucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAobWluUHJpb3JpdHksIGNhbGxiYWNrKSB7XG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdXBwb3J0ZWQoKSkge1xuXHQgICAgICAgICAgICByZXR1cm4gZmFpbEF0dGVtcHQobmV3IEVycm9ycy5VbnN1cHBvcnRlZFN0cmF0ZWd5KCksIGNhbGxiYWNrKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSBpZiAodGhpcy5wcmlvcml0eSA8IG1pblByaW9yaXR5KSB7XG5cdCAgICAgICAgICAgIHJldHVybiBmYWlsQXR0ZW1wdChuZXcgRXJyb3JzLlRyYW5zcG9ydFByaW9yaXR5VG9vTG93KCksIGNhbGxiYWNrKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyIGNvbm5lY3RlZCA9IGZhbHNlO1xuXHQgICAgICAgIHZhciB0cmFuc3BvcnQgPSB0aGlzLnRyYW5zcG9ydC5jcmVhdGVDb25uZWN0aW9uKHRoaXMubmFtZSwgdGhpcy5wcmlvcml0eSwgdGhpcy5vcHRpb25zLmtleSwgdGhpcy5vcHRpb25zKTtcblx0ICAgICAgICB2YXIgaGFuZHNoYWtlID0gbnVsbDtcblx0ICAgICAgICB2YXIgb25Jbml0aWFsaXplZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgdHJhbnNwb3J0LnVuYmluZChcImluaXRpYWxpemVkXCIsIG9uSW5pdGlhbGl6ZWQpO1xuXHQgICAgICAgICAgICB0cmFuc3BvcnQuY29ubmVjdCgpO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgdmFyIG9uT3BlbiA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgaGFuZHNoYWtlID0gZmFjdG9yeV8xW1wiZGVmYXVsdFwiXS5jcmVhdGVIYW5kc2hha2UodHJhbnNwb3J0LCBmdW5jdGlvbiAocmVzdWx0KSB7XG5cdCAgICAgICAgICAgICAgICBjb25uZWN0ZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgdW5iaW5kTGlzdGVuZXJzKCk7XG5cdCAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHQpO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgICAgIHVuYmluZExpc3RlbmVycygpO1xuXHQgICAgICAgICAgICBjYWxsYmFjayhlcnJvcik7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB2YXIgb25DbG9zZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIHVuYmluZExpc3RlbmVycygpO1xuXHQgICAgICAgICAgICB2YXIgc2VyaWFsaXplZFRyYW5zcG9ydDtcblx0ICAgICAgICAgICAgc2VyaWFsaXplZFRyYW5zcG9ydCA9IENvbGxlY3Rpb25zLnNhZmVKU09OU3RyaW5naWZ5KHRyYW5zcG9ydCk7XG5cdCAgICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcnMuVHJhbnNwb3J0Q2xvc2VkKHNlcmlhbGl6ZWRUcmFuc3BvcnQpKTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHZhciB1bmJpbmRMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIHRyYW5zcG9ydC51bmJpbmQoXCJpbml0aWFsaXplZFwiLCBvbkluaXRpYWxpemVkKTtcblx0ICAgICAgICAgICAgdHJhbnNwb3J0LnVuYmluZChcIm9wZW5cIiwgb25PcGVuKTtcblx0ICAgICAgICAgICAgdHJhbnNwb3J0LnVuYmluZChcImVycm9yXCIsIG9uRXJyb3IpO1xuXHQgICAgICAgICAgICB0cmFuc3BvcnQudW5iaW5kKFwiY2xvc2VkXCIsIG9uQ2xvc2VkKTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHRyYW5zcG9ydC5iaW5kKFwiaW5pdGlhbGl6ZWRcIiwgb25Jbml0aWFsaXplZCk7XG5cdCAgICAgICAgdHJhbnNwb3J0LmJpbmQoXCJvcGVuXCIsIG9uT3Blbik7XG5cdCAgICAgICAgdHJhbnNwb3J0LmJpbmQoXCJlcnJvclwiLCBvbkVycm9yKTtcblx0ICAgICAgICB0cmFuc3BvcnQuYmluZChcImNsb3NlZFwiLCBvbkNsb3NlZCk7XG5cdCAgICAgICAgdHJhbnNwb3J0LmluaXRpYWxpemUoKTtcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICBhYm9ydDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3RlZCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIHVuYmluZExpc3RlbmVycygpO1xuXHQgICAgICAgICAgICAgICAgaWYgKGhhbmRzaGFrZSkge1xuXHQgICAgICAgICAgICAgICAgICAgIGhhbmRzaGFrZS5jbG9zZSgpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdHJhbnNwb3J0LmNsb3NlKCk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIGZvcmNlTWluUHJpb3JpdHk6IGZ1bmN0aW9uIChwKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGVkKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgaWYgKF90aGlzLnByaW9yaXR5IDwgcCkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kc2hha2UpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaGFuZHNoYWtlLmNsb3NlKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQuY2xvc2UoKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9O1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBUcmFuc3BvcnRTdHJhdGVneTtcblx0fSgpKTtcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBUcmFuc3BvcnRTdHJhdGVneTtcblx0ZnVuY3Rpb24gZmFpbEF0dGVtcHQoZXJyb3IsIGNhbGxiYWNrKSB7XG5cdCAgICB1dGlsXzFbXCJkZWZhdWx0XCJdLmRlZmVyKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBjYWxsYmFjayhlcnJvcik7XG5cdCAgICB9KTtcblx0ICAgIHJldHVybiB7XG5cdCAgICAgICAgYWJvcnQ6IGZ1bmN0aW9uICgpIHsgfSxcblx0ICAgICAgICBmb3JjZU1pblByaW9yaXR5OiBmdW5jdGlvbiAoKSB7IH1cblx0ICAgIH07XG5cdH1cblxuXG4vKioqLyB9KSxcbi8qIDU2ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBDb2xsZWN0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cdHZhciB1dGlsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTtcblx0dmFyIHRpbWVyc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMik7XG5cdHZhciBTZXF1ZW50aWFsU3RyYXRlZ3kgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gU2VxdWVudGlhbFN0cmF0ZWd5KHN0cmF0ZWdpZXMsIG9wdGlvbnMpIHtcblx0ICAgICAgICB0aGlzLnN0cmF0ZWdpZXMgPSBzdHJhdGVnaWVzO1xuXHQgICAgICAgIHRoaXMubG9vcCA9IEJvb2xlYW4ob3B0aW9ucy5sb29wKTtcblx0ICAgICAgICB0aGlzLmZhaWxGYXN0ID0gQm9vbGVhbihvcHRpb25zLmZhaWxGYXN0KTtcblx0ICAgICAgICB0aGlzLnRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQ7XG5cdCAgICAgICAgdGhpcy50aW1lb3V0TGltaXQgPSBvcHRpb25zLnRpbWVvdXRMaW1pdDtcblx0ICAgIH1cblx0ICAgIFNlcXVlbnRpYWxTdHJhdGVneS5wcm90b3R5cGUuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLmFueSh0aGlzLnN0cmF0ZWdpZXMsIHV0aWxfMVtcImRlZmF1bHRcIl0ubWV0aG9kKFwiaXNTdXBwb3J0ZWRcIikpO1xuXHQgICAgfTtcblx0ICAgIFNlcXVlbnRpYWxTdHJhdGVneS5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIChtaW5Qcmlvcml0eSwgY2FsbGJhY2spIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIHZhciBzdHJhdGVnaWVzID0gdGhpcy5zdHJhdGVnaWVzO1xuXHQgICAgICAgIHZhciBjdXJyZW50ID0gMDtcblx0ICAgICAgICB2YXIgdGltZW91dCA9IHRoaXMudGltZW91dDtcblx0ICAgICAgICB2YXIgcnVubmVyID0gbnVsbDtcblx0ICAgICAgICB2YXIgdHJ5TmV4dFN0cmF0ZWd5ID0gZnVuY3Rpb24gKGVycm9yLCBoYW5kc2hha2UpIHtcblx0ICAgICAgICAgICAgaWYgKGhhbmRzaGFrZSkge1xuXHQgICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgaGFuZHNoYWtlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50ICsgMTtcblx0ICAgICAgICAgICAgICAgIGlmIChfdGhpcy5sb29wKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQgJSBzdHJhdGVnaWVzLmxlbmd0aDtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIGlmIChjdXJyZW50IDwgc3RyYXRlZ2llcy5sZW5ndGgpIHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAodGltZW91dCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0ID0gdGltZW91dCAqIDI7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy50aW1lb3V0TGltaXQpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBNYXRoLm1pbih0aW1lb3V0LCBfdGhpcy50aW1lb3V0TGltaXQpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgIHJ1bm5lciA9IF90aGlzLnRyeVN0cmF0ZWd5KHN0cmF0ZWdpZXNbY3VycmVudF0sIG1pblByaW9yaXR5LCB7IHRpbWVvdXQ6IHRpbWVvdXQsIGZhaWxGYXN0OiBfdGhpcy5mYWlsRmFzdCB9LCB0cnlOZXh0U3RyYXRlZ3kpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sodHJ1ZSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9O1xuXHQgICAgICAgIHJ1bm5lciA9IHRoaXMudHJ5U3RyYXRlZ3koc3RyYXRlZ2llc1tjdXJyZW50XSwgbWluUHJpb3JpdHksIHsgdGltZW91dDogdGltZW91dCwgZmFpbEZhc3Q6IHRoaXMuZmFpbEZhc3QgfSwgdHJ5TmV4dFN0cmF0ZWd5KTtcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICBhYm9ydDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgcnVubmVyLmFib3J0KCk7XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIGZvcmNlTWluUHJpb3JpdHk6IGZ1bmN0aW9uIChwKSB7XG5cdCAgICAgICAgICAgICAgICBtaW5Qcmlvcml0eSA9IHA7XG5cdCAgICAgICAgICAgICAgICBpZiAocnVubmVyKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcnVubmVyLmZvcmNlTWluUHJpb3JpdHkocCk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9O1xuXHQgICAgfTtcblx0ICAgIFNlcXVlbnRpYWxTdHJhdGVneS5wcm90b3R5cGUudHJ5U3RyYXRlZ3kgPSBmdW5jdGlvbiAoc3RyYXRlZ3ksIG1pblByaW9yaXR5LCBvcHRpb25zLCBjYWxsYmFjaykge1xuXHQgICAgICAgIHZhciB0aW1lciA9IG51bGw7XG5cdCAgICAgICAgdmFyIHJ1bm5lciA9IG51bGw7XG5cdCAgICAgICAgaWYgKG9wdGlvbnMudGltZW91dCA+IDApIHtcblx0ICAgICAgICAgICAgdGltZXIgPSBuZXcgdGltZXJzXzEuT25lT2ZmVGltZXIob3B0aW9ucy50aW1lb3V0LCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBydW5uZXIuYWJvcnQoKTtcblx0ICAgICAgICAgICAgICAgIGNhbGxiYWNrKHRydWUpO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcnVubmVyID0gc3RyYXRlZ3kuY29ubmVjdChtaW5Qcmlvcml0eSwgZnVuY3Rpb24gKGVycm9yLCBoYW5kc2hha2UpIHtcblx0ICAgICAgICAgICAgaWYgKGVycm9yICYmIHRpbWVyICYmIHRpbWVyLmlzUnVubmluZygpICYmICFvcHRpb25zLmZhaWxGYXN0KSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgaWYgKHRpbWVyKSB7XG5cdCAgICAgICAgICAgICAgICB0aW1lci5lbnN1cmVBYm9ydGVkKCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIGhhbmRzaGFrZSk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgYWJvcnQ6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIGlmICh0aW1lcikge1xuXHQgICAgICAgICAgICAgICAgICAgIHRpbWVyLmVuc3VyZUFib3J0ZWQoKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIHJ1bm5lci5hYm9ydCgpO1xuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICBmb3JjZU1pblByaW9yaXR5OiBmdW5jdGlvbiAocCkge1xuXHQgICAgICAgICAgICAgICAgcnVubmVyLmZvcmNlTWluUHJpb3JpdHkocCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9O1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBTZXF1ZW50aWFsU3RyYXRlZ3k7XG5cdH0oKSk7XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gU2VxdWVudGlhbFN0cmF0ZWd5O1xuXG5cbi8qKiovIH0pLFxuLyogNTcgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIENvbGxlY3Rpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXHR2YXIgQmVzdENvbm5lY3RlZEV2ZXJTdHJhdGVneSA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBCZXN0Q29ubmVjdGVkRXZlclN0cmF0ZWd5KHN0cmF0ZWdpZXMpIHtcblx0ICAgICAgICB0aGlzLnN0cmF0ZWdpZXMgPSBzdHJhdGVnaWVzO1xuXHQgICAgfVxuXHQgICAgQmVzdENvbm5lY3RlZEV2ZXJTdHJhdGVneS5wcm90b3R5cGUuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLmFueSh0aGlzLnN0cmF0ZWdpZXMsIHV0aWxfMVtcImRlZmF1bHRcIl0ubWV0aG9kKFwiaXNTdXBwb3J0ZWRcIikpO1xuXHQgICAgfTtcblx0ICAgIEJlc3RDb25uZWN0ZWRFdmVyU3RyYXRlZ3kucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAobWluUHJpb3JpdHksIGNhbGxiYWNrKSB7XG5cdCAgICAgICAgcmV0dXJuIGNvbm5lY3QodGhpcy5zdHJhdGVnaWVzLCBtaW5Qcmlvcml0eSwgZnVuY3Rpb24gKGksIHJ1bm5lcnMpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlcnJvciwgaGFuZHNoYWtlKSB7XG5cdCAgICAgICAgICAgICAgICBydW5uZXJzW2ldLmVycm9yID0gZXJyb3I7XG5cdCAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoYWxsUnVubmVyc0ZhaWxlZChydW5uZXJzKSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayh0cnVlKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgQ29sbGVjdGlvbnMuYXBwbHkocnVubmVycywgZnVuY3Rpb24gKHJ1bm5lcikge1xuXHQgICAgICAgICAgICAgICAgICAgIHJ1bm5lci5mb3JjZU1pblByaW9yaXR5KGhhbmRzaGFrZS50cmFuc3BvcnQucHJpb3JpdHkpO1xuXHQgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCBoYW5kc2hha2UpO1xuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgIH0pO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBCZXN0Q29ubmVjdGVkRXZlclN0cmF0ZWd5O1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IEJlc3RDb25uZWN0ZWRFdmVyU3RyYXRlZ3k7XG5cdGZ1bmN0aW9uIGNvbm5lY3Qoc3RyYXRlZ2llcywgbWluUHJpb3JpdHksIGNhbGxiYWNrQnVpbGRlcikge1xuXHQgICAgdmFyIHJ1bm5lcnMgPSBDb2xsZWN0aW9ucy5tYXAoc3RyYXRlZ2llcywgZnVuY3Rpb24gKHN0cmF0ZWd5LCBpLCBfLCBycykge1xuXHQgICAgICAgIHJldHVybiBzdHJhdGVneS5jb25uZWN0KG1pblByaW9yaXR5LCBjYWxsYmFja0J1aWxkZXIoaSwgcnMpKTtcblx0ICAgIH0pO1xuXHQgICAgcmV0dXJuIHtcblx0ICAgICAgICBhYm9ydDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICBDb2xsZWN0aW9ucy5hcHBseShydW5uZXJzLCBhYm9ydFJ1bm5lcik7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBmb3JjZU1pblByaW9yaXR5OiBmdW5jdGlvbiAocCkge1xuXHQgICAgICAgICAgICBDb2xsZWN0aW9ucy5hcHBseShydW5uZXJzLCBmdW5jdGlvbiAocnVubmVyKSB7XG5cdCAgICAgICAgICAgICAgICBydW5uZXIuZm9yY2VNaW5Qcmlvcml0eShwKTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0fVxuXHRmdW5jdGlvbiBhbGxSdW5uZXJzRmFpbGVkKHJ1bm5lcnMpIHtcblx0ICAgIHJldHVybiBDb2xsZWN0aW9ucy5hbGwocnVubmVycywgZnVuY3Rpb24gKHJ1bm5lcikge1xuXHQgICAgICAgIHJldHVybiBCb29sZWFuKHJ1bm5lci5lcnJvcik7XG5cdCAgICB9KTtcblx0fVxuXHRmdW5jdGlvbiBhYm9ydFJ1bm5lcihydW5uZXIpIHtcblx0ICAgIGlmICghcnVubmVyLmVycm9yICYmICFydW5uZXIuYWJvcnRlZCkge1xuXHQgICAgICAgIHJ1bm5lci5hYm9ydCgpO1xuXHQgICAgICAgIHJ1bm5lci5hYm9ydGVkID0gdHJ1ZTtcblx0ICAgIH1cblx0fVxuXG5cbi8qKiovIH0pLFxuLyogNTggKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXHR2YXIgcnVudGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIHNlcXVlbnRpYWxfc3RyYXRlZ3lfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpO1xuXHR2YXIgQ29sbGVjdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXHR2YXIgQ2FjaGVkU3RyYXRlZ3kgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gQ2FjaGVkU3RyYXRlZ3koc3RyYXRlZ3ksIHRyYW5zcG9ydHMsIG9wdGlvbnMpIHtcblx0ICAgICAgICB0aGlzLnN0cmF0ZWd5ID0gc3RyYXRlZ3k7XG5cdCAgICAgICAgdGhpcy50cmFuc3BvcnRzID0gdHJhbnNwb3J0cztcblx0ICAgICAgICB0aGlzLnR0bCA9IG9wdGlvbnMudHRsIHx8IDE4MDAgKiAxMDAwO1xuXHQgICAgICAgIHRoaXMuZW5jcnlwdGVkID0gb3B0aW9ucy5lbmNyeXB0ZWQ7XG5cdCAgICAgICAgdGhpcy50aW1lbGluZSA9IG9wdGlvbnMudGltZWxpbmU7XG5cdCAgICB9XG5cdCAgICBDYWNoZWRTdHJhdGVneS5wcm90b3R5cGUuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuc3RyYXRlZ3kuaXNTdXBwb3J0ZWQoKTtcblx0ICAgIH07XG5cdCAgICBDYWNoZWRTdHJhdGVneS5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIChtaW5Qcmlvcml0eSwgY2FsbGJhY2spIHtcblx0ICAgICAgICB2YXIgZW5jcnlwdGVkID0gdGhpcy5lbmNyeXB0ZWQ7XG5cdCAgICAgICAgdmFyIGluZm8gPSBmZXRjaFRyYW5zcG9ydENhY2hlKGVuY3J5cHRlZCk7XG5cdCAgICAgICAgdmFyIHN0cmF0ZWdpZXMgPSBbdGhpcy5zdHJhdGVneV07XG5cdCAgICAgICAgaWYgKGluZm8gJiYgaW5mby50aW1lc3RhbXAgKyB0aGlzLnR0bCA+PSB1dGlsXzFbXCJkZWZhdWx0XCJdLm5vdygpKSB7XG5cdCAgICAgICAgICAgIHZhciB0cmFuc3BvcnQgPSB0aGlzLnRyYW5zcG9ydHNbaW5mby50cmFuc3BvcnRdO1xuXHQgICAgICAgICAgICBpZiAodHJhbnNwb3J0KSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnRpbWVsaW5lLmluZm8oe1xuXHQgICAgICAgICAgICAgICAgICAgIGNhY2hlZDogdHJ1ZSxcblx0ICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQ6IGluZm8udHJhbnNwb3J0LFxuXHQgICAgICAgICAgICAgICAgICAgIGxhdGVuY3k6IGluZm8ubGF0ZW5jeVxuXHQgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICBzdHJhdGVnaWVzLnB1c2gobmV3IHNlcXVlbnRpYWxfc3RyYXRlZ3lfMVtcImRlZmF1bHRcIl0oW3RyYW5zcG9ydF0sIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiBpbmZvLmxhdGVuY3kgKiAyICsgMTAwMCxcblx0ICAgICAgICAgICAgICAgICAgICBmYWlsRmFzdDogdHJ1ZVxuXHQgICAgICAgICAgICAgICAgfSkpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHZhciBzdGFydFRpbWVzdGFtcCA9IHV0aWxfMVtcImRlZmF1bHRcIl0ubm93KCk7XG5cdCAgICAgICAgdmFyIHJ1bm5lciA9IHN0cmF0ZWdpZXMucG9wKCkuY29ubmVjdChtaW5Qcmlvcml0eSwgZnVuY3Rpb24gY2IoZXJyb3IsIGhhbmRzaGFrZSkge1xuXHQgICAgICAgICAgICBpZiAoZXJyb3IpIHtcblx0ICAgICAgICAgICAgICAgIGZsdXNoVHJhbnNwb3J0Q2FjaGUoZW5jcnlwdGVkKTtcblx0ICAgICAgICAgICAgICAgIGlmIChzdHJhdGVnaWVzLmxlbmd0aCA+IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWVzdGFtcCA9IHV0aWxfMVtcImRlZmF1bHRcIl0ubm93KCk7XG5cdCAgICAgICAgICAgICAgICAgICAgcnVubmVyID0gc3RyYXRlZ2llcy5wb3AoKS5jb25uZWN0KG1pblByaW9yaXR5LCBjYik7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvcik7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgICAgICBzdG9yZVRyYW5zcG9ydENhY2hlKGVuY3J5cHRlZCwgaGFuZHNoYWtlLnRyYW5zcG9ydC5uYW1lLCB1dGlsXzFbXCJkZWZhdWx0XCJdLm5vdygpIC0gc3RhcnRUaW1lc3RhbXApO1xuXHQgICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgaGFuZHNoYWtlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgIGFib3J0OiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBydW5uZXIuYWJvcnQoKTtcblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgZm9yY2VNaW5Qcmlvcml0eTogZnVuY3Rpb24gKHApIHtcblx0ICAgICAgICAgICAgICAgIG1pblByaW9yaXR5ID0gcDtcblx0ICAgICAgICAgICAgICAgIGlmIChydW5uZXIpIHtcblx0ICAgICAgICAgICAgICAgICAgICBydW5uZXIuZm9yY2VNaW5Qcmlvcml0eShwKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdCAgICB9O1xuXHQgICAgcmV0dXJuIENhY2hlZFN0cmF0ZWd5O1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IENhY2hlZFN0cmF0ZWd5O1xuXHRmdW5jdGlvbiBnZXRUcmFuc3BvcnRDYWNoZUtleShlbmNyeXB0ZWQpIHtcblx0ICAgIHJldHVybiBcInB1c2hlclRyYW5zcG9ydFwiICsgKGVuY3J5cHRlZCA/IFwiRW5jcnlwdGVkXCIgOiBcIlVuZW5jcnlwdGVkXCIpO1xuXHR9XG5cdGZ1bmN0aW9uIGZldGNoVHJhbnNwb3J0Q2FjaGUoZW5jcnlwdGVkKSB7XG5cdCAgICB2YXIgc3RvcmFnZSA9IHJ1bnRpbWVfMVtcImRlZmF1bHRcIl0uZ2V0TG9jYWxTdG9yYWdlKCk7XG5cdCAgICBpZiAoc3RvcmFnZSkge1xuXHQgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgIHZhciBzZXJpYWxpemVkQ2FjaGUgPSBzdG9yYWdlW2dldFRyYW5zcG9ydENhY2hlS2V5KGVuY3J5cHRlZCldO1xuXHQgICAgICAgICAgICBpZiAoc2VyaWFsaXplZENhY2hlKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShzZXJpYWxpemVkQ2FjaGUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGNhdGNoIChlKSB7XG5cdCAgICAgICAgICAgIGZsdXNoVHJhbnNwb3J0Q2FjaGUoZW5jcnlwdGVkKTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gbnVsbDtcblx0fVxuXHRmdW5jdGlvbiBzdG9yZVRyYW5zcG9ydENhY2hlKGVuY3J5cHRlZCwgdHJhbnNwb3J0LCBsYXRlbmN5KSB7XG5cdCAgICB2YXIgc3RvcmFnZSA9IHJ1bnRpbWVfMVtcImRlZmF1bHRcIl0uZ2V0TG9jYWxTdG9yYWdlKCk7XG5cdCAgICBpZiAoc3RvcmFnZSkge1xuXHQgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgIHN0b3JhZ2VbZ2V0VHJhbnNwb3J0Q2FjaGVLZXkoZW5jcnlwdGVkKV0gPSBDb2xsZWN0aW9ucy5zYWZlSlNPTlN0cmluZ2lmeSh7XG5cdCAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IHV0aWxfMVtcImRlZmF1bHRcIl0ubm93KCksXG5cdCAgICAgICAgICAgICAgICB0cmFuc3BvcnQ6IHRyYW5zcG9ydCxcblx0ICAgICAgICAgICAgICAgIGxhdGVuY3k6IGxhdGVuY3lcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGNhdGNoIChlKSB7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHR9XG5cdGZ1bmN0aW9uIGZsdXNoVHJhbnNwb3J0Q2FjaGUoZW5jcnlwdGVkKSB7XG5cdCAgICB2YXIgc3RvcmFnZSA9IHJ1bnRpbWVfMVtcImRlZmF1bHRcIl0uZ2V0TG9jYWxTdG9yYWdlKCk7XG5cdCAgICBpZiAoc3RvcmFnZSkge1xuXHQgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgIGRlbGV0ZSBzdG9yYWdlW2dldFRyYW5zcG9ydENhY2hlS2V5KGVuY3J5cHRlZCldO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBjYXRjaCAoZSkge1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0fVxuXG5cbi8qKiovIH0pLFxuLyogNTkgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIHRpbWVyc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMik7XG5cdHZhciBEZWxheWVkU3RyYXRlZ3kgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gRGVsYXllZFN0cmF0ZWd5KHN0cmF0ZWd5LCBfYSkge1xuXHQgICAgICAgIHZhciBudW1iZXIgPSBfYS5kZWxheTtcblx0ICAgICAgICB0aGlzLnN0cmF0ZWd5ID0gc3RyYXRlZ3k7XG5cdCAgICAgICAgdGhpcy5vcHRpb25zID0geyBkZWxheTogbnVtYmVyIH07XG5cdCAgICB9XG5cdCAgICBEZWxheWVkU3RyYXRlZ3kucHJvdG90eXBlLmlzU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLnN0cmF0ZWd5LmlzU3VwcG9ydGVkKCk7XG5cdCAgICB9O1xuXHQgICAgRGVsYXllZFN0cmF0ZWd5LnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gKG1pblByaW9yaXR5LCBjYWxsYmFjaykge1xuXHQgICAgICAgIHZhciBzdHJhdGVneSA9IHRoaXMuc3RyYXRlZ3k7XG5cdCAgICAgICAgdmFyIHJ1bm5lcjtcblx0ICAgICAgICB2YXIgdGltZXIgPSBuZXcgdGltZXJzXzEuT25lT2ZmVGltZXIodGhpcy5vcHRpb25zLmRlbGF5LCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIHJ1bm5lciA9IHN0cmF0ZWd5LmNvbm5lY3QobWluUHJpb3JpdHksIGNhbGxiYWNrKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICBhYm9ydDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgdGltZXIuZW5zdXJlQWJvcnRlZCgpO1xuXHQgICAgICAgICAgICAgICAgaWYgKHJ1bm5lcikge1xuXHQgICAgICAgICAgICAgICAgICAgIHJ1bm5lci5hYm9ydCgpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICBmb3JjZU1pblByaW9yaXR5OiBmdW5jdGlvbiAocCkge1xuXHQgICAgICAgICAgICAgICAgbWluUHJpb3JpdHkgPSBwO1xuXHQgICAgICAgICAgICAgICAgaWYgKHJ1bm5lcikge1xuXHQgICAgICAgICAgICAgICAgICAgIHJ1bm5lci5mb3JjZU1pblByaW9yaXR5KHApO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfTtcblx0ICAgIH07XG5cdCAgICByZXR1cm4gRGVsYXllZFN0cmF0ZWd5O1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IERlbGF5ZWRTdHJhdGVneTtcblxuXG4vKioqLyB9KSxcbi8qIDYwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBJZlN0cmF0ZWd5ID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIElmU3RyYXRlZ3kodGVzdCwgdHJ1ZUJyYW5jaCwgZmFsc2VCcmFuY2gpIHtcblx0ICAgICAgICB0aGlzLnRlc3QgPSB0ZXN0O1xuXHQgICAgICAgIHRoaXMudHJ1ZUJyYW5jaCA9IHRydWVCcmFuY2g7XG5cdCAgICAgICAgdGhpcy5mYWxzZUJyYW5jaCA9IGZhbHNlQnJhbmNoO1xuXHQgICAgfVxuXHQgICAgSWZTdHJhdGVneS5wcm90b3R5cGUuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGJyYW5jaCA9IHRoaXMudGVzdCgpID8gdGhpcy50cnVlQnJhbmNoIDogdGhpcy5mYWxzZUJyYW5jaDtcblx0ICAgICAgICByZXR1cm4gYnJhbmNoLmlzU3VwcG9ydGVkKCk7XG5cdCAgICB9O1xuXHQgICAgSWZTdHJhdGVneS5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIChtaW5Qcmlvcml0eSwgY2FsbGJhY2spIHtcblx0ICAgICAgICB2YXIgYnJhbmNoID0gdGhpcy50ZXN0KCkgPyB0aGlzLnRydWVCcmFuY2ggOiB0aGlzLmZhbHNlQnJhbmNoO1xuXHQgICAgICAgIHJldHVybiBicmFuY2guY29ubmVjdChtaW5Qcmlvcml0eSwgY2FsbGJhY2spO1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBJZlN0cmF0ZWd5O1xuXHR9KCkpO1xuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IElmU3RyYXRlZ3k7XG5cblxuLyoqKi8gfSksXG4vKiA2MSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgRmlyc3RDb25uZWN0ZWRTdHJhdGVneSA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBGaXJzdENvbm5lY3RlZFN0cmF0ZWd5KHN0cmF0ZWd5KSB7XG5cdCAgICAgICAgdGhpcy5zdHJhdGVneSA9IHN0cmF0ZWd5O1xuXHQgICAgfVxuXHQgICAgRmlyc3RDb25uZWN0ZWRTdHJhdGVneS5wcm90b3R5cGUuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuc3RyYXRlZ3kuaXNTdXBwb3J0ZWQoKTtcblx0ICAgIH07XG5cdCAgICBGaXJzdENvbm5lY3RlZFN0cmF0ZWd5LnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gKG1pblByaW9yaXR5LCBjYWxsYmFjaykge1xuXHQgICAgICAgIHZhciBydW5uZXIgPSB0aGlzLnN0cmF0ZWd5LmNvbm5lY3QobWluUHJpb3JpdHksIGZ1bmN0aW9uIChlcnJvciwgaGFuZHNoYWtlKSB7XG5cdCAgICAgICAgICAgIGlmIChoYW5kc2hha2UpIHtcblx0ICAgICAgICAgICAgICAgIHJ1bm5lci5hYm9ydCgpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCBoYW5kc2hha2UpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHJldHVybiBydW5uZXI7XG5cdCAgICB9O1xuXHQgICAgcmV0dXJuIEZpcnN0Q29ubmVjdGVkU3RyYXRlZ3k7XG5cdH0oKSk7XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gRmlyc3RDb25uZWN0ZWRTdHJhdGVneTtcblxuXG4vKioqLyB9KSxcbi8qIDYyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciBkZWZhdWx0c18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblx0ZXhwb3J0cy5nZXRHbG9iYWxDb25maWcgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICAgIHdzSG9zdDogZGVmYXVsdHNfMVtcImRlZmF1bHRcIl0uaG9zdCxcblx0ICAgICAgICB3c1BvcnQ6IGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLndzX3BvcnQsXG5cdCAgICAgICAgd3NzUG9ydDogZGVmYXVsdHNfMVtcImRlZmF1bHRcIl0ud3NzX3BvcnQsXG5cdCAgICAgICAgaHR0cEhvc3Q6IGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLnNvY2tqc19ob3N0LFxuXHQgICAgICAgIGh0dHBQb3J0OiBkZWZhdWx0c18xW1wiZGVmYXVsdFwiXS5zb2NranNfaHR0cF9wb3J0LFxuXHQgICAgICAgIGh0dHBzUG9ydDogZGVmYXVsdHNfMVtcImRlZmF1bHRcIl0uc29ja2pzX2h0dHBzX3BvcnQsXG5cdCAgICAgICAgaHR0cFBhdGg6IGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLnNvY2tqc19wYXRoLFxuXHQgICAgICAgIHN0YXRzSG9zdDogZGVmYXVsdHNfMVtcImRlZmF1bHRcIl0uc3RhdHNfaG9zdCxcblx0ICAgICAgICBhdXRoRW5kcG9pbnQ6IGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLmNoYW5uZWxfYXV0aF9lbmRwb2ludCxcblx0ICAgICAgICBhdXRoVHJhbnNwb3J0OiBkZWZhdWx0c18xW1wiZGVmYXVsdFwiXS5jaGFubmVsX2F1dGhfdHJhbnNwb3J0LFxuXHQgICAgICAgIGFjdGl2aXR5X3RpbWVvdXQ6IGRlZmF1bHRzXzFbXCJkZWZhdWx0XCJdLmFjdGl2aXR5X3RpbWVvdXQsXG5cdCAgICAgICAgcG9uZ190aW1lb3V0OiBkZWZhdWx0c18xW1wiZGVmYXVsdFwiXS5wb25nX3RpbWVvdXQsXG5cdCAgICAgICAgdW5hdmFpbGFibGVfdGltZW91dDogZGVmYXVsdHNfMVtcImRlZmF1bHRcIl0udW5hdmFpbGFibGVfdGltZW91dFxuXHQgICAgfTtcblx0fTtcblx0ZXhwb3J0cy5nZXRDbHVzdGVyQ29uZmlnID0gZnVuY3Rpb24gKGNsdXN0ZXJOYW1lKSB7XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICAgIHdzSG9zdDogXCJ3cy1cIiArIGNsdXN0ZXJOYW1lICsgXCIucHVzaGVyLmNvbVwiLFxuXHQgICAgICAgIGh0dHBIb3N0OiBcInNvY2tqcy1cIiArIGNsdXN0ZXJOYW1lICsgXCIucHVzaGVyLmNvbVwiXG5cdCAgICB9O1xuXHR9O1xuXG5cbi8qKiovIH0pXG4vKioqKioqLyBdKVxufSk7XG47XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3B1c2hlci1qcy9kaXN0L3dlYi9wdXNoZXIuanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 3 */
/***/ function(module, exports, __webpack_require__) {

eval("\r\n/**\r\n * First we will load all of this project's JavaScript dependencies which\r\n * include Vue and Vue Resource. This gives a great starting point for\r\n * building robust, powerful web applications using Vue and Laravel.\r\n */\r\n\r\n__webpack_require__(0);\r\n\r\n/**\r\n * Next, we will create a fresh Vue application instance and attach it to\r\n * the body of the page. From here, you may begin adding components to\r\n * the application, or feel free to tweak this setup for your needs.\r\n */\r\n\r\n//Vue.component('example', require('./components/Example.vue'));\r\n\r\n//const app = new Vue({\r\n//    el: 'body'\r\n//});\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2FwcC5qcz84YjY3Il0sInNvdXJjZXNDb250ZW50IjpbIlxyXG4vKipcclxuICogRmlyc3Qgd2Ugd2lsbCBsb2FkIGFsbCBvZiB0aGlzIHByb2plY3QncyBKYXZhU2NyaXB0IGRlcGVuZGVuY2llcyB3aGljaFxyXG4gKiBpbmNsdWRlIFZ1ZSBhbmQgVnVlIFJlc291cmNlLiBUaGlzIGdpdmVzIGEgZ3JlYXQgc3RhcnRpbmcgcG9pbnQgZm9yXHJcbiAqIGJ1aWxkaW5nIHJvYnVzdCwgcG93ZXJmdWwgd2ViIGFwcGxpY2F0aW9ucyB1c2luZyBWdWUgYW5kIExhcmF2ZWwuXHJcbiAqL1xyXG5cclxucmVxdWlyZSgnLi9ib290c3RyYXAnKTtcclxuXHJcbi8qKlxyXG4gKiBOZXh0LCB3ZSB3aWxsIGNyZWF0ZSBhIGZyZXNoIFZ1ZSBhcHBsaWNhdGlvbiBpbnN0YW5jZSBhbmQgYXR0YWNoIGl0IHRvXHJcbiAqIHRoZSBib2R5IG9mIHRoZSBwYWdlLiBGcm9tIGhlcmUsIHlvdSBtYXkgYmVnaW4gYWRkaW5nIGNvbXBvbmVudHMgdG9cclxuICogdGhlIGFwcGxpY2F0aW9uLCBvciBmZWVsIGZyZWUgdG8gdHdlYWsgdGhpcyBzZXR1cCBmb3IgeW91ciBuZWVkcy5cclxuICovXHJcblxyXG4vL1Z1ZS5jb21wb25lbnQoJ2V4YW1wbGUnLCByZXF1aXJlKCcuL2NvbXBvbmVudHMvRXhhbXBsZS52dWUnKSk7XHJcblxyXG4vL2NvbnN0IGFwcCA9IG5ldyBWdWUoe1xyXG4vLyAgICBlbDogJ2JvZHknXHJcbi8vfSk7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2FwcC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFPQTtBQUNBOzs7Ozs7Ozs7Ozs7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ }
/******/ ]);